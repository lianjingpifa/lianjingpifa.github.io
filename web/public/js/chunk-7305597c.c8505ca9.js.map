{"version":3,"sources":["webpack:///./src/views/specialMng/index.vue","webpack:///./src/views/specialMng/index.vue?a845","webpack:///./src/views/specialMng/index.vue?c4f7"],"names":["class","_createBlock","_component_viLayoutUpDown","up","_withCtx","_createVNode","_component_viSearchForm","$data","searchData","$event","onSearch","$options","reSearch","extral","_component_Button","type","onClick","_cache","deleteData","$props","curRow","userId","_component_FormItem","label","prop","_component_viInput","userName","goodId","goodName","_createElementVNode","_hoisted_1","_component_viInputNumber","step","onOnEnter","changeStep","down","_component_viTablePage","ref","columns","getData","addSelect","addIndex","onOnSelectionChange","selected","special","row","index","changeIndex","_createElementBlock","_toDisplayString","specialPrice","toFixed","_hoisted_2","_hoisted_3","min","changeData","operate","_hoisted_4","name","props","Object","default","data","computed","this","title","key","align","slot","width","methods","_this$$refs$table","$refs","table","changePage","param","getPricesByPage","length","$Message","info","map","item","list","returnCode","savePrice","success","err","error","message","$Modal","confirm","content","onOk","async","deletePrice","activated","__exports__","render"],"mappings":"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","file":"public/js/chunk-7305597c.c8505ca9.js","sourcesContent":["<!--\r\n * @Author: zzx\r\n * @Date: 2022-06-11 20:35:10\r\n * @LastEditors: zzx\r\n * @LastEditTime: 2023-11-30 20:08:16\r\n-->\r\n<template>\r\n  <viLayoutUpDown>\r\n    <template #up>\r\n      <viSearchForm v-model=\"searchData\" @search=\"reSearch\">\r\n        <FormItem label=\"客户名称:\" prop=\"userName\" v-if=\"!curRow.userId\">\r\n          <viInput v-model=\"searchData.userName\"></viInput>\r\n        </FormItem>\r\n        <FormItem label=\"商品名称:\" prop=\"goodName\" v-if=\"!curRow.goodId\">\r\n          <viInput v-model=\"searchData.goodName\"></viInput>\r\n        </FormItem>\r\n        <div class=\"mb-10\">\r\n          勾选数据批量调整：\r\n          <viInputNumber v-model=\"step\" :step=\"0.5\" @on-enter=\"changeStep\" class=\"step-input\"></viInputNumber>\r\n          <Button type=\"primary\" @click=\"changeStep\" class=\"ml-10\">确认</Button>\r\n        </div>\r\n        <template #extral>\r\n          <Button type=\"error\" @click=\"deleteData()\" class=\"ml-10\">批量删除</Button>\r\n        </template>\r\n      </viSearchForm>\r\n    </template>\r\n    <template #down>\r\n      <viTablePage\r\n        ref=\"table\"\r\n        :columns=\"columns\"\r\n        :getData=\"getData\"\r\n        addSelect\r\n        addIndex\r\n        @on-selection-change=\"selected = $event\"\r\n      >\r\n        <template #special=\"{ row, index }\">\r\n          <span class=\"vi-link-pointer\" @click=\"changeIndex = index\" v-if=\"changeIndex != index\">\r\n            ￥ {{ row.specialPrice && row.specialPrice.toFixed(2) }}\r\n          </span>\r\n          <div class=\"flex-cc\" v-else>\r\n            ￥ <viInputNumber v-model=\"row.specialPrice\" :min=\"0\" :step=\"0.5\"></viInputNumber>\r\n            <Button @click=\"changeIndex = -1\" class=\"ml-10\">取消</Button>\r\n            <Button type=\"primary\" @click=\"changeData([row])\" class=\"ml-10\">确认</Button>\r\n          </div>\r\n        </template>\r\n        <template #operate=\"{ row }\">\r\n          <a @click=\"deleteData([row])\" class=\"vi-red-pointer\">删除</a>\r\n        </template>\r\n      </viTablePage>\r\n    </template>\r\n  </viLayoutUpDown>\r\n</template>\r\n\r\n<script>\r\nimport { getPricesByPage, deletePrice, savePrice } from \"@/axios\";\r\n\r\nexport default {\r\n  name: \"specialMng\",\r\n  props: {\r\n    curRow: {\r\n      type: Object,\r\n      default() {\r\n        return {};\r\n      },\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      searchData: {},\r\n      selected: [],\r\n      changeIndex: -1,\r\n      step: 0,\r\n    };\r\n  },\r\n  computed: {\r\n    columns() {\r\n      return [\r\n        ...(this.curRow.userId ? [] : [{ title: \"客户名称\", key: \"userName\", align: \"center\" }]),\r\n        ...(this.curRow.goodId ? [] : [{ title: \"商品名称\", key: \"goodName\", align: \"center\" }]),\r\n        { title: \"特价（点击修改）\", slot: \"special\", align: \"center\", width: 300 },\r\n        { title: \"操作\", slot: \"operate\", align: \"center\", width: 150 },\r\n      ];\r\n    },\r\n  },\r\n  methods: {\r\n    reSearch() {\r\n      this.$refs.table?.changePage(1);\r\n    },\r\n    getData(param) {\r\n      this.selected = [];\r\n      this.changeIndex = -1;\r\n      return getPricesByPage({\r\n        ...param,\r\n        ...this.searchData,\r\n        ...this.curRow,\r\n      });\r\n    },\r\n    changeStep() {\r\n      if (!this.selected.length) {\r\n        return this.$Message.info(\"至少勾选一条数据\");\r\n      }\r\n      this.changeData(this.selected.map((item) => {\r\n        item.specialPrice += this.step;\r\n        return item;\r\n      }));\r\n    },\r\n    async changeData(list) {\r\n      try {\r\n        const { returnCode, data } = await savePrice({ list }) || {};\r\n        if (returnCode === 0 && data) {\r\n          this.$Message.success(\"保存成功\");\r\n          this.$refs.table.changePage(1);\r\n        }\r\n      } catch (err) {\r\n        this.$Message.error(`保存失败：${err.message || err}`);\r\n      }\r\n    },\r\n    deleteData(selected = this.selected) {\r\n      if (!selected.length) return this.$Message.info(\"至少选中一项\");\r\n      this.$Modal.confirm({\r\n        title: \"删除特价\",\r\n        content: \"是否确认删除所选特价？\",\r\n        onOk: async () => {\r\n          try {\r\n            const { returnCode, data } = await deletePrice({\r\n              list: selected.map((item) => {\r\n                return {\r\n                  userId: item.userId,\r\n                  goodId: item.goodId,\r\n                };\r\n              })\r\n            }) || {};\r\n            if (returnCode === 0 && data) {\r\n              this.$Message.success(\"删除成功\");\r\n              this.$refs.table.changePage(1);\r\n            }\r\n          } catch (err) {\r\n            this.$Message.error(`删除失败：${err.message || err}`);\r\n          }\r\n        },\r\n      });\r\n    },\r\n  },\r\n  activated() {\r\n    this.reSearch();\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.step-input {\r\n  width: 80px !important;\r\n}\r\n</style>\r\n","import { render } from \"./index.vue?vue&type=template&id=3b16998c&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=3b16998c&lang=less&scoped=true\"\n\nimport exportComponent from \"E:\\\\goodCashier\\\\web\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-3b16998c\"]])\n\nexport default __exports__","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=3b16998c&lang=less&scoped=true\""],"sourceRoot":""}