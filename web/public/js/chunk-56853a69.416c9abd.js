(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-56853a69"],{"7e0a":function(e,t,a){"use strict";a.r(t);var o=a("7a23");const c=["onClick"],r=["onClick"],l=["onClick"];function s(e,t,a,s,d,i){const n=Object(o["resolveComponent"])("viInput"),u=Object(o["resolveComponent"])("FormItem"),m=Object(o["resolveComponent"])("Option"),h=Object(o["resolveComponent"])("Select"),p=Object(o["resolveComponent"])("DatePicker"),b=Object(o["resolveComponent"])("Button"),O=Object(o["resolveComponent"])("viSearchForm"),j=Object(o["resolveComponent"])("viTablePage"),w=Object(o["resolveComponent"])("viPrintContent"),D=Object(o["resolveComponent"])("Modal"),C=Object(o["resolveComponent"])("viLayoutUpDown");return Object(o["openBlock"])(),Object(o["createBlock"])(C,null,{up:Object(o["withCtx"])(()=>[Object(o["createVNode"])(O,{modelValue:d.searchData,"onUpdate:modelValue":t[5]||(t[5]=e=>d.searchData=e),onSearch:i.reSearch},{extral:Object(o["withCtx"])(()=>[Object(o["createVNode"])(b,{type:"error",onClick:t[4]||(t[4]=e=>i.deleteData())},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("批量删除")]),_:1})]),default:Object(o["withCtx"])(()=>[a.curRow.userId?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createBlock"])(u,{key:0,label:"客户名称:",prop:"userName"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(n,{modelValue:d.searchData.userName,"onUpdate:modelValue":t[0]||(t[0]=e=>d.searchData.userName=e),class:"vi-width"},null,8,["modelValue"])]),_:1})),Object(o["createVNode"])(u,{label:"订单状态:",prop:"status"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(h,{modelValue:d.searchData.status,"onUpdate:modelValue":t[1]||(t[1]=e=>d.searchData.status=e),clearable:"",class:"vi-width"},{default:Object(o["withCtx"])(()=>[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(d.statusMap,(e,t)=>(Object(o["openBlock"])(),Object(o["createBlock"])(m,{value:e,key:t},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(o["createVNode"])(u,{label:"修改时间:",prop:"updateTime"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(p,{modelValue:d.searchData.updateTime,"onUpdate:modelValue":t[2]||(t[2]=e=>d.searchData.updateTime=e),type:"daterange",options:d.options,placeholder:"请选择",class:"vi-width"},null,8,["modelValue","options"])]),_:1}),Object(o["createVNode"])(u,{label:"创建时间:",prop:"createTime"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(p,{modelValue:d.searchData.createTime,"onUpdate:modelValue":t[3]||(t[3]=e=>d.searchData.createTime=e),type:"daterange",options:d.options,placeholder:"请选择",class:"vi-width"},null,8,["modelValue","options"])]),_:1})]),_:1},8,["modelValue","onSearch"])]),down:Object(o["withCtx"])(()=>[Object(o["createVNode"])(j,{ref:"table",columns:i.columns,getData:i.getData,addSelect:"",addIndex:"",onOnSelectionChange:t[6]||(t[6]=e=>d.selected=e)},{operate:Object(o["withCtx"])(({row:e})=>[Object(o["createElementVNode"])("a",{onClick:t=>i.changeOrder(e)},"修改",8,c),Object(o["createElementVNode"])("a",{onClick:t=>i.deleteData([e]),class:"ml-10 vi-red-pointer"},"删除",8,r),Object(o["createElementVNode"])("a",{onClick:t=>i.copyOrder(e),class:"ml-10 vi-green-pointer"},"一键复制",8,l)]),_:1},8,["columns","getData"]),Object(o["createVNode"])(D,{title:"订单详情",modelValue:d.showDetail,"onUpdate:modelValue":t[11]||(t[11]=e=>d.showDetail=e),width:880,"class-name":"vertical-center-modal"},{footer:Object(o["withCtx"])(()=>[Object(o["createVNode"])(b,{onClick:t[7]||(t[7]=e=>d.showDetail=!1)},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("取消")]),_:1}),Object(o["createVNode"])(b,{type:"primary",onClick:t[8]||(t[8]=e=>i.changeOrder(d.detailData))},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("去修改")]),_:1}),Object(o["createVNode"])(b,{type:"primary",onClick:t[9]||(t[9]=e=>i.copyOrder(d.detailData))},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("一键复制")]),_:1}),Object(o["createVNode"])(b,{type:"error",onClick:t[10]||(t[10]=e=>i.deleteData([d.detailData]))},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("删除")]),_:1})]),default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(w,{list:d.detailData.list,total:d.detailData.total,class:"order-detail"},null,8,["list","total"])]),_:1},8,["modelValue"])]),_:1})}var d=a("8738"),i=(a("14d9"),a("eeb9")),n=a("2af9"),u={name:"orderMng",components:{DatePicker:d["a"],viPrintContent:n["j"]},props:{curRow:{type:Object,default(){return{}}}},data(){return{searchData:{},statusMap:{1:"草稿",2:"已打印"},selected:[],options:{shortcuts:[{text:"今天",value:()=>[new Date,new Date]},{text:"近2天",value:()=>[(new Date).subtract(1),new Date]},{text:"近3天",value:()=>[(new Date).subtract(2),new Date]},{text:"近一周",value:()=>[(new Date).subtract(7),new Date]}]},showDetail:!1,detailData:{}}},computed:{columns(){return[{title:"订单编号",minWidth:130,render:(e,{row:t})=>e("span",{class:"vi-link-pointer",onClick:()=>{this.detailData={...t,list:JSON.parse(t.detail||"[]"),total:t.total.toFixed(2)},this.showDetail=!0}},t.orderId)},...this.curRow.userId?[]:[{title:"客户名称",key:"userName",minWidth:150}],{title:"订单状态",width:80,render:(e,{row:t})=>e("span",this.statusMap[t.status]||"-")},{title:"总金额",minWidth:90,render:(e,{row:t})=>e("span","￥"+t.total.toFixed(2))},{title:"修改时间",key:"updateTime",minWidth:90},{title:"创建时间",key:"createTime",minWidth:90},{title:"操作",slot:"operate",minWidth:100}]}},methods:{reSearch(){var e;null===(e=this.$refs.table)||void 0===e||e.changePage(1)},getData(e){this.selected=[];const{updateTime:t=[],createTime:a=[],...o}=this.searchData;return Object(i["r"])({...e,...o,updateTimeStart:t[0]&&new Date(t[0]).startOf("day").format("YYYY-MM-DD HH:mm:ss"),updateTimeEnd:t[1]&&new Date(t[1]).endOf("day").format("YYYY-MM-DD HH:mm:ss"),createTimeStart:a[0]&&new Date(a[0]).startOf("day").format("YYYY-MM-DD HH:mm:ss"),createTimeEnd:a[1]&&new Date(a[1]).endOf("day").format("YYYY-MM-DD HH:mm:ss"),...this.curRow})},changeOrder(e){this.showDetail=!1,this.$emit("close"),this.$router.push({name:"cashierMng",state:{params:{type:"change",userId:e.userId,goodList:e.detail,orderId:e.orderId}}})},copyOrder(e){this.showDetail=!1,this.$emit("close"),this.$router.push({name:"cashierMng",state:{params:{type:"copy",goodList:e.detail}}})},deleteData(e=this.selected){if(!e.length)return this.$Message.info("至少选中一项");this.$Modal.confirm({title:"删除订单",content:"是否确认删除所选订单？",onOk:async()=>{try{const{returnCode:t,data:a}=await Object(i["f"])({orderIds:e.map(e=>e.orderId).join()})||{};0===t&&a&&(this.$Message.success("删除成功"),this.$refs.table.changePage(1),this.$EventBus.$emit("saveOrder"))}catch(t){this.$Message.error("删除失败："+(t.message||t))}}})}},activated(){this.reSearch()}},m=(a("dbb1"),a("6b0d")),h=a.n(m);const p=h()(u,[["render",s],["__scopeId","data-v-18e9edc8"]]);t["default"]=p},d275:function(e,t,a){},dbb1:function(e,t,a){"use strict";a("d275")}}]);