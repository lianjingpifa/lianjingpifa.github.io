(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7bb25c54"],{"267e":function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return c})),a.d(t,"b",(function(){return l}));const o={1:"草稿",2:"已打印",3:"已作废"},c={1:"未注册",2:"待审核",3:"已验证"},l={1:"超管",2:"店长",3:"店员",9:"客户",99:"游客"}},"7e0a":function(e,t,a){"use strict";a.r(t);var o=a("8738"),c=(a("14d9"),a("7a23")),l=a("eeb9"),r=a("2af9"),n=a("267e"),d=a("6605");const u=["onClick"],i=["onClick"],s=["onClick"];var b={__name:"index",props:{curRow:{type:Object,default(){return{}}}},emits:["close"],setup(e,{emit:t}){const a=e,b=Object(d["d"])(),m=Object(c["inject"])("$Modal",()=>{}),O={shortcuts:[{text:"今天",value:()=>[new Date,new Date]},{text:"近2天",value:()=>[(new Date).subtract(1),new Date]},{text:"近3天",value:()=>[(new Date).subtract(2),new Date]},{text:"近一周",value:()=>[(new Date).subtract(7),new Date]}]},j=Object(c["ref"])();function p(){var e;null===(e=j.value)||void 0===e||e.changePage(1)}const v=Object(c["ref"])({}),f=Object(c["ref"])([]),w=Object(c["ref"])(!1),h=Object(c["ref"])({}),V=Object(c["computed"])(()=>[{title:"订单编号",minWidth:130,render:(e,{row:t})=>e("span",{class:"vi-link-pointer",onClick:()=>{h.value={...t,list:JSON.parse(t.detail||"[]"),total:t.total.toFixed(2)},w.value=!0}},t.orderId)},...a.curRow.userId?[]:[{title:"客户名称",key:"userName",minWidth:100}],{title:"订单状态",width:80,render:(e,{row:t})=>e("span",n["a"][t.status]||"-")},{title:"总金额",minWidth:90,render:(e,{row:t})=>e("span","￥"+t.total.toFixed(2))},{title:"修改时间",key:"updateTime",minWidth:90},{title:"创建时间",key:"createTime",minWidth:90},{title:"操作",slot:"operate",minWidth:100}]);function C(e){f.value=[];const{updateTime:t=[],createTime:o=[],...c}=v.value;return Object(l["t"])({...e,...c,updateTimeStart:t[0]&&new Date(t[0]).startOf("day").format("YYYY-MM-DD HH:mm:ss"),updateTimeEnd:t[1]&&new Date(t[1]).endOf("day").format("YYYY-MM-DD HH:mm:ss"),createTimeStart:o[0]&&new Date(o[0]).startOf("day").format("YYYY-MM-DD HH:mm:ss"),createTimeEnd:o[1]&&new Date(o[1]).endOf("day").format("YYYY-MM-DD HH:mm:ss"),userId:a.curRow.userId})}function x(e){w.value=!1,t("close"),b.push({name:"cashierMng",state:{params:{type:"change",userId:e.userId,goodList:e.detail,orderId:e.orderId}}})}function k(e){w.value=!1,t("close"),b.push({name:"cashierMng",state:{params:{type:"copy",goodList:e.detail}}})}function N(e=f.value){if(!e.length)return Message.info("至少选中一项");m.confirm({title:"删除订单",content:"是否确认删除所选订单？",onOk:async()=>{try{const{returnCode:t,data:a}=await Object(l["g"])({orderIds:e.map(e=>e.orderId).join()})||{};0===t&&a&&(Message.success("删除成功"),p(),window.$EventBus.$emit("saveOrder"))}catch(t){Message.error("删除失败："+(t.message||t))}}})}return Object(c["onActivated"])(()=>{p()}),(t,a)=>{const l=Object(c["resolveComponent"])("viInput"),d=Object(c["resolveComponent"])("FormItem"),b=Object(c["resolveComponent"])("Option"),m=Object(c["resolveComponent"])("viSelect"),y=Object(c["resolveComponent"])("Button"),D=Object(c["resolveComponent"])("viSearchForm"),g=Object(c["resolveComponent"])("viTablePage"),T=Object(c["resolveComponent"])("viModal"),_=Object(c["resolveComponent"])("viLayoutUpDown");return Object(c["openBlock"])(),Object(c["createBlock"])(_,null,{up:Object(c["withCtx"])(()=>[Object(c["createVNode"])(D,{modelValue:v.value,"onUpdate:modelValue":a[5]||(a[5]=e=>v.value=e),onSearch:p},{extral:Object(c["withCtx"])(()=>[Object(c["createVNode"])(y,{type:"error",onClick:a[4]||(a[4]=e=>N())},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])("批量删除")]),_:1})]),default:Object(c["withCtx"])(()=>[e.curRow.userId?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createBlock"])(d,{key:0,label:"客户名称:",prop:"userName"},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(l,{modelValue:v.value.userName,"onUpdate:modelValue":a[0]||(a[0]=e=>v.value.userName=e),class:"vi-width"},null,8,["modelValue"])]),_:1})),Object(c["createVNode"])(d,{label:"订单状态:",prop:"status"},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(m,{modelValue:v.value.status,"onUpdate:modelValue":a[1]||(a[1]=e=>v.value.status=e),class:"vi-width"},{default:Object(c["withCtx"])(()=>[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(Object(c["unref"])(n["a"]),(e,t)=>(Object(c["openBlock"])(),Object(c["createBlock"])(b,{key:t,value:t},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])(Object(c["toDisplayString"])(e),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(c["createVNode"])(d,{label:"修改时间:",prop:"updateTime"},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(Object(c["unref"])(o["a"]),{modelValue:v.value.updateTime,"onUpdate:modelValue":a[2]||(a[2]=e=>v.value.updateTime=e),type:"daterange",options:O,placeholder:"请选择",class:"vi-width"},null,8,["modelValue"])]),_:1}),Object(c["createVNode"])(d,{label:"创建时间:",prop:"createTime"},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(Object(c["unref"])(o["a"]),{modelValue:v.value.createTime,"onUpdate:modelValue":a[3]||(a[3]=e=>v.value.createTime=e),type:"daterange",options:O,placeholder:"请选择",class:"vi-width"},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),down:Object(c["withCtx"])(()=>[Object(c["createVNode"])(g,{ref_key:"tableRef",ref:j,columns:V.value,getData:C,addSelect:"",addIndex:"",onOnSelectionChange:a[6]||(a[6]=e=>f.value=e)},{operate:Object(c["withCtx"])(({row:e})=>[Object(c["createElementVNode"])("a",{onClick:t=>x(e)},"修改",8,u),Object(c["createElementVNode"])("a",{onClick:t=>N([e]),class:"vi-red-pointer"},"删除",8,i),Object(c["createElementVNode"])("a",{onClick:t=>k(e),class:"vi-green-pointer"},"一键复制",8,s)]),_:1},8,["columns"]),Object(c["createVNode"])(T,{modelValue:w.value,"onUpdate:modelValue":a[11]||(a[11]=e=>w.value=e),title:"订单详情",width:880},{footer:Object(c["withCtx"])(()=>[Object(c["createVNode"])(y,{onClick:a[7]||(a[7]=e=>w.value=!1)},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])("取消")]),_:1}),Object(c["createVNode"])(y,{type:"primary",onClick:a[8]||(a[8]=e=>x(h.value))},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])("去修改")]),_:1}),Object(c["createVNode"])(y,{type:"primary",onClick:a[9]||(a[9]=e=>k(h.value))},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])("一键复制")]),_:1}),Object(c["createVNode"])(y,{type:"error",onClick:a[10]||(a[10]=e=>N([h.value]))},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])("删除")]),_:1})]),default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(Object(c["unref"])(r["l"]),{list:h.value.list,total:h.value.total,class:"order-detail"},null,8,["list","total"])]),_:1},8,["modelValue"])]),_:1})}}},m=(a("ddef"),a("6b0d")),O=a.n(m);const j=O()(b,[["__scopeId","data-v-f2287566"]]);t["default"]=j},a225:function(e,t,a){},ddef:function(e,t,a){"use strict";a("a225")}}]);