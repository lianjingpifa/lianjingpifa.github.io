(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0a3998cb"],{2410:function(t,e,i){(function(e){var i=function(){"use strict";function t(t,e){return null!=e&&t instanceof e}var i,r,n;try{i=Map}catch(u){i=function(){}}try{r=Set}catch(u){r=function(){}}try{n=Promise}catch(u){n=function(){}}function o(a,s,l,c,u){"object"===typeof s&&(l=s.depth,c=s.prototype,u=s.includeNonEnumerable,s=s.circular);var d=[],p=[],f="undefined"!=typeof e;function g(a,l){if(null===a)return null;if(0===l)return a;var _,m;if("object"!=typeof a)return a;if(t(a,i))_=new i;else if(t(a,r))_=new r;else if(t(a,n))_=new n((function(t,e){a.then((function(e){t(g(e,l-1))}),(function(t){e(g(t,l-1))}))}));else if(o.__isArray(a))_=[];else if(o.__isRegExp(a))_=new RegExp(a.source,h(a)),a.lastIndex&&(_.lastIndex=a.lastIndex);else if(o.__isDate(a))_=new Date(a.getTime());else{if(f&&e.isBuffer(a))return _=e.allocUnsafe?e.allocUnsafe(a.length):new e(a.length),a.copy(_),_;t(a,Error)?_=Object.create(a):"undefined"==typeof c?(m=Object.getPrototypeOf(a),_=Object.create(m)):(_=Object.create(c),m=c)}if(s){var y=d.indexOf(a);if(-1!=y)return p[y];d.push(a),p.push(_)}for(var v in t(a,i)&&a.forEach((function(t,e){var i=g(e,l-1),r=g(t,l-1);_.set(i,r)})),t(a,r)&&a.forEach((function(t){var e=g(t,l-1);_.add(e)})),a){var O;m&&(O=Object.getOwnPropertyDescriptor(m,v)),O&&null==O.set||(_[v]=g(a[v],l-1))}if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(a);for(v=0;v<b.length;v++){var x=b[v],j=Object.getOwnPropertyDescriptor(a,x);(!j||j.enumerable||u)&&(_[x]=g(a[x],l-1),j.enumerable||Object.defineProperty(_,x,{enumerable:!1}))}}if(u){var E=Object.getOwnPropertyNames(a);for(v=0;v<E.length;v++){var w=E[v];j=Object.getOwnPropertyDescriptor(a,w);j&&j.enumerable||(_[w]=g(a[w],l-1),Object.defineProperty(_,w,{enumerable:!1}))}}return _}return"undefined"==typeof s&&(s=!0),"undefined"==typeof l&&(l=1/0),g(a,l)}function a(t){return Object.prototype.toString.call(t)}function s(t){return"object"===typeof t&&"[object Date]"===a(t)}function l(t){return"object"===typeof t&&"[object Array]"===a(t)}function c(t){return"object"===typeof t&&"[object RegExp]"===a(t)}function h(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}return o.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},o.__objToStr=a,o.__isDate=s,o.__isArray=l,o.__isRegExp=c,o.__getRegExpFlags=h,o}();t.exports&&(t.exports=i)}).call(this,i("b639").Buffer)},"267e":function(t,e,i){"use strict";i.d(e,"a",(function(){return r})),i.d(e,"c",(function(){return n})),i.d(e,"b",(function(){return o}));const r={1:"草稿",2:"已打印",3:"已作废"},n={1:"未注册",2:"待审核",3:"已验证"},o={1:"超管",2:"店长",3:"店员",9:"客户",99:"游客"}},"29f6":function(t,e,i){"use strict";e["a"]={POINT:"point",LINE:"line"}},"31fd":function(t,e,i){"use strict";var r=i("7a23");const n=t=>(Object(r["pushScopeId"])("data-v-9dc3384c"),t=t(),Object(r["popScopeId"])(),t),o={ref:"userPopup"},a={class:"popup"},s={class:"popup-header"},l={class:"title"},c={class:"popup-content"},h={class:"mb-10"},u=n(()=>Object(r["createElementVNode"])("div",{class:"mt-10"},null,-1)),d=n(()=>Object(r["createElementVNode"])("div",{class:"mt-10"},null,-1)),p={ref:"clusterPopup"},f={class:"popup"},g={class:"popup-header"},_=n(()=>Object(r["createElementVNode"])("span",{class:"title"},"聚合点位",-1)),m={class:"popup-content"},y=["onClick"],v={ref:"emptyPopup"},O={class:"popup"},b={class:"popup-content tc"};function x(t,e,i,n,x,j){const E=Object(r["resolveComponent"])("Button"),w=Object(r["resolveComponent"])("Option"),C=Object(r["resolveComponent"])("viSelect"),S=Object(r["resolveComponent"])("viMap");return Object(r["openBlock"])(),Object(r["createBlock"])(S,{onOnMount:j.onMount,class:"h100"},{default:Object(r["withCtx"])(()=>[x.isMobile?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createBlock"])(E,{key:0,type:"success",onClick:e[0]||(e[0]=e=>t.$emit("close")),class:"list-mode"},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])("列表模式")]),_:1})),Object(r["createVNode"])(C,{modelValue:x.curUserId,"onUpdate:modelValue":e[1]||(e[1]=t=>x.curUserId=t),ref:"user",class:"select-user"},{default:Object(r["withCtx"])(()=>[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(x.allUsers,t=>(Object(r["openBlock"])(),Object(r["createBlock"])(w,{key:t.userId,value:t.userId},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])(Object(r["toDisplayString"])(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),Object(r["createElementVNode"])("div",o,[Object(r["createElementVNode"])("div",a,[Object(r["createElementVNode"])("div",s,[Object(r["createElementVNode"])("span",l,Object(r["toDisplayString"])(x.curUser.name),1),Object(r["createElementVNode"])("span",{class:"close",onClick:e[2]||(e[2]=t=>x.userOverlay.setPosition(void 0))}," X ")]),Object(r["createElementVNode"])("div",c,[Object(r["createElementVNode"])("p",null,"电话："+Object(r["toDisplayString"])(x.curUser.phone||"-"),1),Object(r["createElementVNode"])("p",h,"备注："+Object(r["toDisplayString"])(x.curUser.remarks||"-"),1),Object(r["createVNode"])(E,{type:"primary",onClick:e[3]||(e[3]=e=>t.$emit("changeUser",x.curUser)),size:"small"},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])("修改")]),_:1}),Object(r["createVNode"])(E,{type:"error",onClick:e[4]||(e[4]=e=>t.$emit("deleteUser",x.curUser)),size:"small"},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])("删除")]),_:1}),u,Object(r["createVNode"])(E,{type:"success",onClick:e[5]||(e[5]=e=>t.$emit("openSpecialMng",x.curUser)),size:"small"},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])("特价")]),_:1}),Object(r["createVNode"])(E,{type:"primary",onClick:e[6]||(e[6]=e=>t.$emit("openHistoryOrder",x.curUser)),size:"small"},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])("历史订单")]),_:1}),d,Object(r["createVNode"])(E,{type:"primary",onClick:j.toMapNavigation,size:"small"},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])("导航")]),_:1},8,["onClick"]),Object(r["createVNode"])(E,{onClick:j.verifyLonlat,size:"small"},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])("校准")]),_:1},8,["onClick"])])])],512),Object(r["createElementVNode"])("div",p,[Object(r["createElementVNode"])("div",f,[Object(r["createElementVNode"])("div",g,[_,Object(r["createElementVNode"])("span",{class:"close",onClick:e[7]||(e[7]=t=>x.clusterOverlay.setPosition(void 0))}," X ")]),Object(r["createElementVNode"])("div",m,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(x.userList,(t,e)=>(Object(r["openBlock"])(),Object(r["createElementBlock"])("p",{key:e,onClick:e=>j.showUserDetail(t),class:"pointer"},Object(r["toDisplayString"])(e+1)+"、"+Object(r["toDisplayString"])(t.name),9,y))),128))])])],512),Object(r["createElementVNode"])("div",v,[Object(r["createElementVNode"])("div",O,[Object(r["createElementVNode"])("div",b,[x.showVerify?(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:1},[Object(r["createVNode"])(E,{onClick:j.closeEmptyOverlay,size:"small"},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])("取消")]),_:1},8,["onClick"]),Object(r["createVNode"])(E,{type:"success",onClick:j.confirmVerify,size:"small"},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])("确认")]),_:1},8,["onClick"])],64)):(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:0},[Object(r["createVNode"])(E,{type:"success",onClick:e[8]||(e[8]=e=>t.$emit("changeUser",x.curUser)),size:"small"},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])(Object(r["toDisplayString"])(x.curUserId?"定位":"新增"),1)]),_:1}),Object(r["createVNode"])(E,{type:"primary",onClick:j.toMapNavigation,size:"small"},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])("导航")]),_:1},8,["onClick"])],64)),Object(r["createElementVNode"])("span",{onClick:e[9]||(e[9]=(...t)=>j.closeEmptyOverlay&&j.closeEmptyOverlay(...t)),class:"ml-10 pointer"}," X ")])])],512)]),_:1},8,["onOnMount"])}var j=i("3e6b"),E=i("5831"),w=i("01d4"),C=i("4cdf"),S=i("f623"),I=i("f403"),T=i("a568"),R=i("92fa"),k=i("0af5"),A=i("1300"),D=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),M=function(t){function e(e){var i=t.call(this,{attributions:e.attributions,wrapX:e.wrapX})||this;return i.resolution=void 0,i.distance=void 0!==e.distance?e.distance:20,i.features=[],i.geometryFunction=e.geometryFunction||function(t){var e=t.getGeometry();return Object(R["a"])(e.getType()==S["a"].POINT,10),e},i.boundRefresh_=i.refresh.bind(i),i.setSource(e.source||null),i}return D(e,t),e.prototype.clear=function(e){this.features.length=0,t.prototype.clear.call(this,e)},e.prototype.getDistance=function(){return this.distance},e.prototype.getSource=function(){return this.source},e.prototype.loadFeatures=function(t,e,i){this.source.loadFeatures(t,e,i),e!==this.resolution&&(this.clear(),this.resolution=e,this.cluster(),this.addFeatures(this.features))},e.prototype.setDistance=function(t){this.distance=t,this.refresh()},e.prototype.setSource=function(t){this.source&&this.source.removeEventListener(w["a"].CHANGE,this.boundRefresh_),this.source=t,t&&t.addEventListener(w["a"].CHANGE,this.boundRefresh_),this.refresh()},e.prototype.refresh=function(){this.clear(),this.cluster(),this.addFeatures(this.features)},e.prototype.cluster=function(){if(void 0!==this.resolution&&this.source)for(var t=Object(k["j"])(),e=this.distance*this.resolution,i=this.source.getFeatures(),r={},n=0,o=i.length;n<o;n++){var a=i[n];if(!(Object(A["c"])(a)in r)){var s=this.geometryFunction(a);if(s){var l=s.getCoordinates();Object(k["m"])(l,t),Object(k["c"])(t,e,t);var c=this.source.getFeaturesInExtent(t);c=c.filter((function(t){var e=Object(A["c"])(t);return!(e in r)&&(r[e]=!0,!0)})),this.features.push(this.createCluster(c))}}}},e.prototype.createCluster=function(t){for(var e=[0,0],i=t.length-1;i>=0;--i){var r=this.geometryFunction(t[i]);r?Object(T["a"])(e,r.getCoordinates()):t.splice(i,1)}Object(T["e"])(e,1/t.length);var n=new C["a"](new I["a"](e));return n.set("features",t),n},e}(E["a"]),F=M,N=i("e269"),L=i("592d"),P={BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right",CENTER_LEFT:"center-left",CENTER_CENTER:"center-center",CENTER_RIGHT:"center-right",TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right"},V=i("cd7e"),B=i("1e8d"),G=i("0999"),U=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Y={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"},W=function(t){function e(e){var i=t.call(this)||this;i.options=e,i.id=e.id,i.insertFirst=void 0===e.insertFirst||e.insertFirst,i.stopEvent=void 0===e.stopEvent||e.stopEvent,i.element=document.createElement("div"),i.element.className=void 0!==e.className?e.className:"ol-overlay-container "+V["d"],i.element.style.position="absolute",i.element.style.pointerEvents="auto";var r=e.autoPan;return r&&"object"!==typeof r&&(r={animation:e.autoPanAnimation,margin:e.autoPanMargin}),i.autoPan=r||!1,i.rendered={transform_:"",visible:!0},i.mapPostrenderListenerKey=null,i.addEventListener(Object(N["b"])(Y.ELEMENT),i.handleElementChanged),i.addEventListener(Object(N["b"])(Y.MAP),i.handleMapChanged),i.addEventListener(Object(N["b"])(Y.OFFSET),i.handleOffsetChanged),i.addEventListener(Object(N["b"])(Y.POSITION),i.handlePositionChanged),i.addEventListener(Object(N["b"])(Y.POSITIONING),i.handlePositioningChanged),void 0!==e.element&&i.setElement(e.element),i.setOffset(void 0!==e.offset?e.offset:[0,0]),i.setPositioning(void 0!==e.positioning?e.positioning:P.TOP_LEFT),void 0!==e.position&&i.setPosition(e.position),i}return U(e,t),e.prototype.getElement=function(){return this.get(Y.ELEMENT)},e.prototype.getId=function(){return this.id},e.prototype.getMap=function(){return this.get(Y.MAP)},e.prototype.getOffset=function(){return this.get(Y.OFFSET)},e.prototype.getPosition=function(){return this.get(Y.POSITION)},e.prototype.getPositioning=function(){return this.get(Y.POSITIONING)},e.prototype.handleElementChanged=function(){Object(G["d"])(this.element);var t=this.getElement();t&&this.element.appendChild(t)},e.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&(Object(G["e"])(this.element),Object(B["c"])(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var t=this.getMap();if(t){this.mapPostrenderListenerKey=Object(B["a"])(t,L["a"].POSTRENDER,this.render,this),this.updatePixelPosition();var e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element),this.performAutoPan()}},e.prototype.render=function(){this.updatePixelPosition()},e.prototype.handleOffsetChanged=function(){this.updatePixelPosition()},e.prototype.handlePositionChanged=function(){this.updatePixelPosition(),this.performAutoPan()},e.prototype.handlePositioningChanged=function(){this.updatePixelPosition()},e.prototype.setElement=function(t){this.set(Y.ELEMENT,t)},e.prototype.setMap=function(t){this.set(Y.MAP,t)},e.prototype.setOffset=function(t){this.set(Y.OFFSET,t)},e.prototype.setPosition=function(t){this.set(Y.POSITION,t)},e.prototype.performAutoPan=function(){this.autoPan&&this.panIntoView(this.autoPan)},e.prototype.panIntoView=function(t){var e=this.getMap();if(e&&e.getTargetElement()&&this.get(Y.POSITION)){var i=this.getRect(e.getTargetElement(),e.getSize()),r=this.getElement(),n=this.getRect(r,[Object(G["c"])(r),Object(G["b"])(r)]),o=t||{},a=void 0===o.margin?20:o.margin;if(!Object(k["g"])(i,n)){var s=n[0]-i[0],l=i[2]-n[2],c=n[1]-i[1],h=i[3]-n[3],u=[0,0];if(s<0?u[0]=s-a:l<0&&(u[0]=Math.abs(l)+a),c<0?u[1]=c-a:h<0&&(u[1]=Math.abs(h)+a),0!==u[0]||0!==u[1]){var d=e.getView().getCenterInternal(),p=e.getPixelFromCoordinateInternal(d),f=[p[0]+u[0],p[1]+u[1]],g=o.animation||{};e.getView().animateInternal({center:e.getCoordinateFromPixelInternal(f),duration:g.duration,easing:g.easing})}}}},e.prototype.getRect=function(t,e){var i=t.getBoundingClientRect(),r=i.left+window.pageXOffset,n=i.top+window.pageYOffset;return[r,n,r+e[0],n+e[1]]},e.prototype.setPositioning=function(t){this.set(Y.POSITIONING,t)},e.prototype.setVisible=function(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)},e.prototype.updatePixelPosition=function(){var t=this.getMap(),e=this.getPosition();if(t&&t.isRendered()&&e){var i=t.getPixelFromCoordinate(e),r=t.getSize();this.updateRenderedPosition(i,r)}else this.setVisible(!1)},e.prototype.updateRenderedPosition=function(t,e){var i=this.element.style,r=this.getOffset(),n=this.getPositioning();this.setVisible(!0);var o=Math.round(t[0]+r[0])+"px",a=Math.round(t[1]+r[1])+"px",s="0%",l="0%";n==P.BOTTOM_RIGHT||n==P.CENTER_RIGHT||n==P.TOP_RIGHT?s="-100%":n!=P.BOTTOM_CENTER&&n!=P.CENTER_CENTER&&n!=P.TOP_CENTER||(s="-50%"),n==P.BOTTOM_LEFT||n==P.BOTTOM_CENTER||n==P.BOTTOM_RIGHT?l="-100%":n!=P.CENTER_LEFT&&n!=P.CENTER_CENTER&&n!=P.CENTER_RIGHT||(l="-50%");var c="translate("+s+", "+l+") translate("+o+", "+a+")";this.rendered.transform_!=c&&(this.rendered.transform_=c,i.transform=c,i.msTransform=c)},e.prototype.getOptions=function(){return this.options},e}(N["a"]),X=W,z=i("6c77"),H=i("6cbf"),K=i("ce2c"),J=i("8682"),Z=i("83a6"),$=i("8295"),q=i("d051"),Q=i("e300"),tt=i("e47c"),et=i.n(tt),it=i("eeb9"),rt=i("2af9"),nt=i("ed08"),ot={name:"allUsersMap",components:{viMap:rt["h"]},data(){return{isMobile:window.isMobile,allUsers:[],map:null,layer:null,verifyLayer:null,verifyTranslate:null,userOverlay:null,clusterOverlay:null,emptyOverlay:null,curUser:{},userList:[],showVerify:!1,curUserId:""}},watch:{curUserId(t){const e=this.allUsers.find(e=>e.userId===t);if(this.userOverlay.setPosition(void 0),e&&e.longitude&&e.latitude){this.curUser=e;const t=[e.longitude,e.latitude];this.map.getView().animate({center:t}),this.userOverlay.setPosition(t)}else e?(this.curUser=e,this.$Message.info("该用户未设置定位<br>点击地图进行定位")):this.curUser={longitude:this.curUser.longitude,latitude:this.curUser.latitude}}},methods:{verifyLonlat(){this.layer&&(this.layer.getSource().getSource().clear(),this.map.removeLayer(this.layer),this.layer=null),this.userOverlay.setPosition(void 0);const t=new C["a"]({geometry:new I["a"]([this.curUser.longitude,this.curUser.latitude])}),e=new E["a"]({features:[t]});this.verifyLayer=new j["a"]({source:e,style:new z["b"]({image:new H["a"]({src:et.a,anchor:[.5,1]})})}),this.map.addLayer(this.verifyLayer);const i=new Q["a"]([t]);this.verifyTranslate=new q["a"]({features:i}),this.map.addInteraction(this.verifyTranslate),this.verifyTranslate.on("translatestart",()=>{this.showVerify=!0,this.emptyOverlay.setPosition(void 0)}),this.verifyTranslate.on("translateend",t=>{const e=t.features.array_[0].getGeometry().flatCoordinates;this.emptyOverlay.setPosition(e),this.curUser={...this.curUser,longitude:+e[0].toFixed(6),latitude:+e[1].toFixed(6)}})},closeEmptyOverlay(){this.emptyOverlay.setPosition(void 0),this.verifyLayer&&(this.map.removeLayer(this.verifyLayer),this.verifyLayer=null,this.map.removeInteraction(this.verifyTranslate),this.verifyTranslate=null),this.showVerify&&(this.showVerify=!1,this.drawCluster())},async confirmVerify(){try{const{data:t}=await Object(it["K"])(this.curUser)||{};t&&(this.$Message.success("校准成功"),this.closeEmptyOverlay(),this.getUsersList())}catch(t){this.$Message.error("校准失败："+(t.message||t))}},toMapNavigation(){const t=Object(nt["e"])(this.curUser);if(!t)return this.$Message.error("未找到定位");window.open(t,"_self")},showUserDetail(t){this.curUser={...t},this.clusterOverlay.setPosition(void 0),this.userOverlay.setPosition([t.longitude,t.latitude])},drawCluster(){if(!this.map)return;this.layer&&(this.layer.getSource().getSource().clear(),this.map.removeLayer(this.layer),this.layer=null);const t=this.allUsers.filter(t=>t.longitude&&t.latitude).map(t=>new C["a"]({geometry:new I["a"]([t.longitude,t.latitude]),data:t})),e=new F({distance:20,source:new E["a"]({features:t})});this.layer=new j["a"]({source:e,style:t=>this.setClusterStyle(t)}),this.map.addLayer(this.layer)},setClusterStyle(t){const e=t.get("features").length;return 1==e?new z["b"]({image:new H["a"]({src:et.a,anchor:[.5,1]})}):new z["b"]({image:new K["a"]({radius:16,stroke:new J["a"]({color:"#fff",width:1}),fill:new Z["a"]({color:"#6086FF"})}),text:new $["a"]({text:e.toString(),font:"12px sans-serif",fill:new Z["a"]({color:"#FFFFFF"})}),zIndex:e})},mapClickHandle(t){const e=this.map.forEachFeatureAtPixel(t.pixel,t=>t.get("features")),i=e&&e.length||0,r=this.userOverlay.getPosition()||this.clusterOverlay.getPosition()||this.emptyOverlay.getPosition();if(this.userOverlay.setPosition(void 0),this.clusterOverlay.setPosition(void 0),this.emptyOverlay.setPosition(void 0),i)1===i?(this.curUser=e[0].get("data"),this.userOverlay.setPosition(t.coordinate)):(this.userList=e.map(t=>t.get("data")),this.clusterOverlay.setPosition(t.coordinate));else{if(r)return;this.curUser={...this.curUserId?this.curUser:{},longitude:+t.coordinate[0].toFixed(6),latitude:+t.coordinate[1].toFixed(6)},this.emptyOverlay.setPosition(t.coordinate)}},onMount(t){this.map=t,this.userOverlay=new X({element:this.$refs.userPopup,positioning:"top-left",offset:[15,-20],autoPan:!0}),this.map.addOverlay(this.userOverlay),this.clusterOverlay=new X({element:this.$refs.clusterPopup,positioning:"top-left",offset:[10,-20],autoPan:!0}),this.map.addOverlay(this.clusterOverlay),this.emptyOverlay=new X({element:this.$refs.emptyPopup,positioning:"top-left",offset:[10,-20],autoPan:!0}),this.map.addOverlay(this.emptyOverlay),this.map.on("singleclick",this.mapClickHandle),this.drawCluster()},async getUsersList(){this.userOverlay&&this.userOverlay.setPosition(void 0),this.emptyOverlay&&this.emptyOverlay.setPosition(void 0);try{const{returnCode:t,data:e}=await Object(it["o"])()||{};0===t&&(this.allUsers=e||[],this.drawCluster())}catch(t){this.$Message.error("获取客户列表失败："+(t.message||t))}}},created(){this.getUsersList()},beforeUnmount(){this.map.un("singleclick",this.mapClickHandle)}},at=(i("c11a"),i("6b0d")),st=i.n(at);const lt=st()(ot,[["render",x],["__scopeId","data-v-9dc3384c"]]);e["a"]=lt},"3e6b":function(t,e,i){"use strict";var r=i("1af9"),n=i("38f3"),o=i("6c77"),a=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),s={RENDER_ORDER:"renderOrder"},l=function(t){function e(e){var i=this,r=e||{},o=Object(n["a"])({},r);return delete o.style,delete o.renderBuffer,delete o.updateWhileAnimating,delete o.updateWhileInteracting,i=t.call(this,o)||this,i.declutter_=void 0!==r.declutter&&r.declutter,i.renderBuffer_=void 0!==r.renderBuffer?r.renderBuffer:100,i.style_=null,i.styleFunction_=void 0,i.setStyle(r.style),i.updateWhileAnimating_=void 0!==r.updateWhileAnimating&&r.updateWhileAnimating,i.updateWhileInteracting_=void 0!==r.updateWhileInteracting&&r.updateWhileInteracting,i}return a(e,t),e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.getFeatures=function(e){return t.prototype.getFeatures.call(this,e)},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(s.RENDER_ORDER)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.setRenderOrder=function(t){this.set(s.RENDER_ORDER,t)},e.prototype.setStyle=function(t){this.style_=void 0!==t?t:o["a"],this.styleFunction_=null===t?void 0:Object(o["c"])(this.style_),this.changed()},e}(r["a"]),c=l,h={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},u=[h.FILL],d=[h.STROKE],p=[h.BEGIN_PATH],f=[h.CLOSE_PATH],g=h,_=i("f623"),m=i("045d"),y=i("f78c"),v=i("e98d"),O=i("0af5"),b=i("ddea"),x=i("9f5e"),j=i("bb6c"),E=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),w=function(t){function e(e,i,r,n){var o=t.call(this)||this;return o.tolerance=e,o.maxExtent=i,o.pixelRatio=n,o.maxLineWidth=0,o.resolution=r,o.beginGeometryInstruction1_=null,o.beginGeometryInstruction2_=null,o.bufferedMaxExtent_=null,o.instructions=[],o.coordinates=[],o.tmpCoordinate_=[],o.hitDetectionInstructions=[],o.state={},o}return E(e,t),e.prototype.applyPixelRatio=function(t){var e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))},e.prototype.appendFlatCoordinates=function(t,e,i,r,n,o){var a=this.coordinates.length,s=this.getBufferedMaxExtent();o&&(e+=r);var l,c,h,u=t[e],d=t[e+1],p=this.tmpCoordinate_,f=!0;for(l=e+r;l<i;l+=r)p[0]=t[l],p[1]=t[l+1],h=Object(O["i"])(s,p),h!==c?(f&&(this.coordinates[a++]=u,this.coordinates[a++]=d),this.coordinates[a++]=p[0],this.coordinates[a++]=p[1],f=!1):h===m["a"].INTERSECTING?(this.coordinates[a++]=p[0],this.coordinates[a++]=p[1],f=!1):f=!0,u=p[0],d=p[1],c=h;return(n&&f||l===e+r)&&(this.coordinates[a++]=u,this.coordinates[a++]=d),a},e.prototype.drawCustomCoordinates_=function(t,e,i,r,n){for(var o=0,a=i.length;o<a;++o){var s=i[o],l=this.appendFlatCoordinates(t,e,s,r,!1,!1);n.push(l),e=s}return e},e.prototype.drawCustom=function(t,e,i){this.beginGeometry(t,e);var r,n,o,a,s,l=t.getType(),c=t.getStride(),h=this.coordinates.length;if(l==_["a"].MULTI_POLYGON){r=t.getOrientedFlatCoordinates(),a=[];var u=t.getEndss();s=0;for(var d=0,p=u.length;d<p;++d){var f=[];s=this.drawCustomCoordinates_(r,s,u[d],c,f),a.push(f)}this.instructions.push([g.CUSTOM,h,a,t,i,j["c"]])}else l==_["a"].POLYGON||l==_["a"].MULTI_LINE_STRING?(o=[],r=l==_["a"].POLYGON?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),s=this.drawCustomCoordinates_(r,0,t.getEnds(),c,o),this.instructions.push([g.CUSTOM,h,o,t,i,j["b"]])):l==_["a"].LINE_STRING||l==_["a"].MULTI_POINT?(r=t.getFlatCoordinates(),n=this.appendFlatCoordinates(r,0,r.length,c,!1,!1),this.instructions.push([g.CUSTOM,h,n,t,i,j["a"]])):l==_["a"].POINT&&(r=t.getFlatCoordinates(),this.coordinates.push(r[0],r[1]),n=this.coordinates.length,this.instructions.push([g.CUSTOM,h,n,t,i]));this.endGeometry(e)},e.prototype.beginGeometry=function(t,e){var i=t.getExtent();this.beginGeometryInstruction1_=[g.BEGIN_GEOMETRY,e,0,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[g.BEGIN_GEOMETRY,e,0,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},e.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}},e.prototype.reverseHitDetectionInstructions=function(){var t,e=this.hitDetectionInstructions;e.reverse();var i,r,n=e.length,o=-1;for(t=0;t<n;++t)i=e[t],r=i[0],r==g.END_GEOMETRY?o=t:r==g.BEGIN_GEOMETRY&&(i[2]=t,Object(x["g"])(this.hitDetectionInstructions,o,t),o=-1)},e.prototype.setFillStrokeStyle=function(t,e){var i=this.state;if(t){var r=t.getColor();i.fillStyle=Object(v["a"])(r||b["c"])}else i.fillStyle=void 0;if(e){var n=e.getColor();i.strokeStyle=Object(v["a"])(n||b["l"]);var o=e.getLineCap();i.lineCap=void 0!==o?o:b["e"];var a=e.getLineDash();i.lineDash=a?a.slice():b["f"];var s=e.getLineDashOffset();i.lineDashOffset=s||b["g"];var l=e.getLineJoin();i.lineJoin=void 0!==l?l:b["h"];var c=e.getWidth();i.lineWidth=void 0!==c?c:b["i"];var h=e.getMiterLimit();i.miterLimit=void 0!==h?h:b["j"],i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0},e.prototype.createFill=function(t){var e=t.fillStyle,i=[g.SET_FILL_STYLE,e];return"string"!==typeof e&&i.push(!0),i},e.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},e.prototype.createStroke=function(t){return[g.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},e.prototype.updateFillStyle=function(t,e){var i=t.fillStyle;"string"===typeof i&&t.currentFillStyle==i||(void 0!==i&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)},e.prototype.updateStrokeStyle=function(t,e){var i=t.strokeStyle,r=t.lineCap,n=t.lineDash,o=t.lineDashOffset,a=t.lineJoin,s=t.lineWidth,l=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=r||n!=t.currentLineDash&&!Object(x["a"])(t.currentLineDash,n)||t.currentLineDashOffset!=o||t.currentLineJoin!=a||t.currentLineWidth!=s||t.currentMiterLimit!=l)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=r,t.currentLineDash=n,t.currentLineDashOffset=o,t.currentLineJoin=a,t.currentLineWidth=s,t.currentMiterLimit=l)},e.prototype.endGeometry=function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var e=[g.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)},e.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Object(O["d"])(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;Object(O["c"])(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},e}(y["a"]),C=w,S=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),I=function(t){function e(e,i,r,n){var o=t.call(this,e,i,r,n)||this;return o.declutterGroups_=null,o.hitDetectionImage_=null,o.image_=null,o.imagePixelRatio_=void 0,o.anchorX_=void 0,o.anchorY_=void 0,o.height_=void 0,o.opacity_=void 0,o.originX_=void 0,o.originY_=void 0,o.rotateWithView_=void 0,o.rotation_=void 0,o.scale_=void 0,o.width_=void 0,o}return S(e,t),e.prototype.drawCoordinates_=function(t,e,i,r){return this.appendFlatCoordinates(t,e,i,r,!1,!1)},e.prototype.drawPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var i=t.getFlatCoordinates(),r=t.getStride(),n=this.coordinates.length,o=this.drawCoordinates_(i,0,i.length,r);this.instructions.push([g.DRAW_IMAGE,n,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,this.declutterGroups_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_)]),this.hitDetectionInstructions.push([g.DRAW_IMAGE,n,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(e)}},e.prototype.drawMultiPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var i=t.getFlatCoordinates(),r=t.getStride(),n=this.coordinates.length,o=this.drawCoordinates_(i,0,i.length,r);this.instructions.push([g.DRAW_IMAGE,n,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,this.declutterGroups_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_)]),this.hitDetectionInstructions.push([g.DRAW_IMAGE,n,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(e)}},e.prototype.finish=function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,t.prototype.finish.call(this)},e.prototype.setImageStyle=function(t,e){var i=t.getAnchor(),r=t.getSize(),n=t.getHitDetectionImage(),o=t.getImage(this.pixelRatio),a=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.declutterGroups_=e,this.hitDetectionImage_=n,this.image_=o,this.height_=r[1],this.opacity_=t.getOpacity(),this.originX_=a[0],this.originY_=a[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=r[0]},e}(C),T=I,R=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),k=function(t){function e(e,i,r,n){return t.call(this,e,i,r,n)||this}return R(e,t),e.prototype.drawFlatCoordinates_=function(t,e,i,r){var n=this.coordinates.length,o=this.appendFlatCoordinates(t,e,i,r,!1,!1),a=[g.MOVE_TO_LINE_TO,n,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i},e.prototype.drawLineString=function(t,e){var i=this.state,r=i.strokeStyle,n=i.lineWidth;if(void 0!==r&&void 0!==n){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([g.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],p);var o=t.getFlatCoordinates(),a=t.getStride();this.drawFlatCoordinates_(o,0,o.length,a),this.hitDetectionInstructions.push(d),this.endGeometry(e)}},e.prototype.drawMultiLineString=function(t,e){var i=this.state,r=i.strokeStyle,n=i.lineWidth;if(void 0!==r&&void 0!==n){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([g.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],p);for(var o=t.getEnds(),a=t.getFlatCoordinates(),s=t.getStride(),l=0,c=0,h=o.length;c<h;++c)l=this.drawFlatCoordinates_(a,l,o[c],s);this.hitDetectionInstructions.push(d),this.endGeometry(e)}},e.prototype.finish=function(){var e=this.state;return void 0!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&this.instructions.push(d),this.reverseHitDetectionInstructions(),this.state=null,t.prototype.finish.call(this)},e.prototype.applyStroke=function(e){void 0!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(d),e.lastStroke=this.coordinates.length),e.lastStroke=0,t.prototype.applyStroke.call(this,e),this.instructions.push(p)},e}(C),A=k,D=i("1c48"),M=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),F=function(t){function e(e,i,r,n){return t.call(this,e,i,r,n)||this}return M(e,t),e.prototype.drawFlatCoordinatess_=function(t,e,i,r){var n=this.state,o=void 0!==n.fillStyle,a=void 0!==n.strokeStyle,s=i.length;this.instructions.push(p),this.hitDetectionInstructions.push(p);for(var l=0;l<s;++l){var c=i[l],h=this.coordinates.length,_=this.appendFlatCoordinates(t,e,c,r,!0,!a),m=[g.MOVE_TO_LINE_TO,h,_];this.instructions.push(m),this.hitDetectionInstructions.push(m),a&&(this.instructions.push(f),this.hitDetectionInstructions.push(f)),e=c}return o&&(this.instructions.push(u),this.hitDetectionInstructions.push(u)),a&&(this.instructions.push(d),this.hitDetectionInstructions.push(d)),e},e.prototype.drawCircle=function(t,e){var i=this.state,r=i.fillStyle,n=i.strokeStyle;if(void 0!==r||void 0!==n){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([g.SET_FILL_STYLE,b["c"]]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([g.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var o=t.getFlatCoordinates(),a=t.getStride(),s=this.coordinates.length;this.appendFlatCoordinates(o,0,o.length,a,!1,!1);var l=[g.CIRCLE,s];this.instructions.push(p,l),this.hitDetectionInstructions.push(p,l),void 0!==i.fillStyle&&(this.instructions.push(u),this.hitDetectionInstructions.push(u)),void 0!==i.strokeStyle&&(this.instructions.push(d),this.hitDetectionInstructions.push(d)),this.endGeometry(e)}},e.prototype.drawPolygon=function(t,e){var i=this.state,r=i.fillStyle,n=i.strokeStyle;if(void 0!==r||void 0!==n){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([g.SET_FILL_STYLE,b["c"]]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([g.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var o=t.getEnds(),a=t.getOrientedFlatCoordinates(),s=t.getStride();this.drawFlatCoordinatess_(a,0,o,s),this.endGeometry(e)}},e.prototype.drawMultiPolygon=function(t,e){var i=this.state,r=i.fillStyle,n=i.strokeStyle;if(void 0!==r||void 0!==n){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([g.SET_FILL_STYLE,b["c"]]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([g.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);for(var o=t.getEndss(),a=t.getOrientedFlatCoordinates(),s=t.getStride(),l=0,c=0,h=o.length;c<h;++c)l=this.drawFlatCoordinatess_(a,l,o[c],s);this.endGeometry(e)}},e.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var e=this.tolerance;if(0!==e)for(var i=this.coordinates,r=0,n=i.length;r<n;++r)i[r]=Object(D["c"])(i[r],e);return t.prototype.finish.call(this)},e.prototype.setFillStrokeStyles_=function(){var t=this.state,e=t.fillStyle;void 0!==e&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)},e}(C),N=F,L=i("29f6"),P=i("1300");function V(t,e,i,r,n){var o,a,s,l,c,h,u,d,p,f,g=i,_=i,m=0,y=0,v=i;for(a=i;a<r;a+=n){var O=e[a],b=e[a+1];void 0!==c&&(p=O-c,f=b-h,l=Math.sqrt(p*p+f*f),void 0!==u&&(y+=s,o=Math.acos((u*p+d*f)/(s*l)),o>t&&(y>m&&(m=y,g=v,_=a),y=0,v=a-n)),s=l,u=p,d=f),c=O,h=b}return y+=l,y>m?[v,a]:[g,_]}var B=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),G={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},U=function(t){function e(e,i,r,n){var o=t.call(this,e,i,r,n)||this;return o.declutterGroups_,o.labels_=null,o.text_="",o.textOffsetX_=0,o.textOffsetY_=0,o.textRotateWithView_=void 0,o.textRotation_=0,o.textFillState_=null,o.fillStates={},o.textStrokeState_=null,o.strokeStates={},o.textState_={},o.textStates={},o.textKey_="",o.fillKey_="",o.strokeKey_="",o}return B(e,t),e.prototype.finish=function(){var e=t.prototype.finish.call(this);return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e},e.prototype.drawText=function(t,e){var i=this.textFillState_,r=this.textStrokeState_,n=this.textState_;if(""!==this.text_&&n&&(i||r)){var o,a,s=this.coordinates.length,l=t.getType(),c=null,h=2,u=t.getStride();if(n.placement===L["a"].LINE){if(!Object(O["F"])(this.getBufferedMaxExtent(),t.getExtent()))return;var d=void 0;if(c=t.getFlatCoordinates(),l==_["a"].LINE_STRING)d=[c.length];else if(l==_["a"].MULTI_LINE_STRING)d=t.getEnds();else if(l==_["a"].POLYGON)d=t.getEnds().slice(0,1);else if(l==_["a"].MULTI_POLYGON){var p=t.getEndss();for(d=[],o=0,a=p.length;o<a;++o)d.push(p[o][0])}this.beginGeometry(t,e);for(var f=n.textAlign,m=0,y=void 0,v=0,x=d.length;v<x;++v){if(void 0==f){var j=V(n.maxAngle,c,m,d[v],u);m=j[0],y=j[1]}else y=d[v];for(o=m;o<y;o+=u)this.coordinates.push(c[o],c[o+1]);h=this.coordinates.length,m=d[v];var E=this.declutterGroups_?0===v?this.declutterGroups_[0]:[].concat(this.declutterGroups_[0]):null;this.drawChars_(s,h,E),s=h}this.endGeometry(e)}else{var w=null;switch(n.overflow||(w=[]),l){case _["a"].POINT:case _["a"].MULTI_POINT:c=t.getFlatCoordinates(),h=c.length;break;case _["a"].LINE_STRING:c=t.getFlatMidpoint();break;case _["a"].CIRCLE:c=t.getCenter();break;case _["a"].MULTI_LINE_STRING:c=t.getFlatMidpoints(),u=2,h=c.length;break;case _["a"].POLYGON:c=t.getFlatInteriorPoint(),n.overflow||w.push(c[2]/this.resolution),u=3;break;case _["a"].MULTI_POLYGON:var C=t.getFlatInteriorPoints();for(c=[],o=0,a=C.length;o<a;o+=3)n.overflow||w.push(C[o+2]/this.resolution),c.push(C[o],C[o+1]);if(u=2,h=c.length,0==h)return;break;default:}h=this.appendFlatCoordinates(c,0,h,u,!1,!1),this.saveTextStates_(),(n.backgroundFill||n.backgroundStroke)&&(this.setFillStrokeStyle(n.backgroundFill,n.backgroundStroke),n.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),n.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);var S=n.padding;if(S!=b["k"]&&(n.scale[0]<0||n.scale[1]<0)){var I=n.padding[0],T=n.padding[1],R=n.padding[2],k=n.padding[3];n.scale[0]<0&&(T=-T,k=-k),n.scale[1]<0&&(I=-I,R=-R),S=[I,T,R,k]}var A=this.pixelRatio;this.instructions.push([g.DRAW_IMAGE,s,h,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,S==b["k"]?b["k"]:S.map((function(t){return t*A})),!!n.backgroundFill,!!n.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,w]);var D=1/A;this.hitDetectionInstructions.push([g.DRAW_IMAGE,s,h,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[D,D],NaN,S,!!n.backgroundFill,!!n.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,w]),this.endGeometry(e)}}},e.prototype.saveTextStates_=function(){var t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,r=this.strokeKey_;t&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var n=this.textKey_;n in this.textStates||(this.textStates[n]={font:e.font,textAlign:e.textAlign||b["m"],textBaseline:e.textBaseline||b["n"],scale:e.scale});var o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))},e.prototype.drawChars_=function(t,e,i){var r=this.textStrokeState_,n=this.textState_,o=this.strokeKey_,a=this.textKey_,s=this.fillKey_;this.saveTextStates_();var l=this.pixelRatio,c=G[n.textBaseline],h=this.textOffsetY_*l,u=this.text_,d=r?r.lineWidth*Math.abs(n.scale[0])/2:0;this.instructions.push([g.DRAW_CHARS,t,e,c,i,n.overflow,s,n.maxAngle,l,h,o,d*l,u,a,1]),this.hitDetectionInstructions.push([g.DRAW_CHARS,t,e,c,i,n.overflow,s,n.maxAngle,1,h,o,d,u,a,1/l])},e.prototype.setTextStyle=function(t,e){var i,r,n;if(t){this.declutterGroups_=e;var o=t.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=Object(v["a"])(o.getColor()||b["c"])):(r=null,this.textFillState_=r);var a=t.getStroke();if(a){n=this.textStrokeState_,n||(n={},this.textStrokeState_=n);var s=a.getLineDash(),l=a.getLineDashOffset(),c=a.getWidth(),h=a.getMiterLimit();n.lineCap=a.getLineCap()||b["e"],n.lineDash=s?s.slice():b["f"],n.lineDashOffset=void 0===l?b["g"]:l,n.lineJoin=a.getLineJoin()||b["h"],n.lineWidth=void 0===c?b["i"]:c,n.miterLimit=void 0===h?b["j"]:h,n.strokeStyle=Object(v["a"])(a.getColor()||b["l"])}else n=null,this.textStrokeState_=n;i=this.textState_;var u=t.getFont()||b["d"];Object(b["s"])(u);var d=t.getScaleArray();i.overflow=t.getOverflow(),i.font=u,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.textBaseline=t.getTextBaseline()||b["n"],i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||b["k"],i.scale=void 0===d?[1,1]:d;var p=t.getOffsetX(),f=t.getOffsetY(),g=t.getRotateWithView(),_=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===p?0:p,this.textOffsetY_=void 0===f?0:f,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0===_?0:_,this.strokeKey_=n?("string"==typeof n.strokeStyle?n.strokeStyle:Object(P["c"])(n.strokeStyle))+n.lineCap+n.lineDashOffset+"|"+n.lineWidth+n.lineJoin+n.miterLimit+"["+n.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.textBaseline||"?"),this.fillKey_=r?"string"==typeof r.fillStyle?r.fillStyle:"|"+Object(P["c"])(r.fillStyle):""}else this.text_=""},e}(C),Y=U,W={Circle:N,Default:C,Image:T,LineString:A,Polygon:N,Text:Y},X=function(){function t(t,e,i,r,n){this.declutter_=n,this.declutterGroups_=null,this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}return t.prototype.addDeclutter=function(t){var e=null;return this.declutter_&&(t?(e=this.declutterGroups_,e[0][0]++):(e=[[1]],this.declutterGroups_=e)),e},t.prototype.finish=function(){var t={};for(var e in this.buildersByZIndex_){t[e]=t[e]||{};var i=this.buildersByZIndex_[e];for(var r in i){var n=i[r].finish();t[e][r]=n}}return t},t.prototype.getBuilder=function(t,e){var i=void 0!==t?t.toString():"0",r=this.buildersByZIndex_[i];void 0===r&&(r={},this.buildersByZIndex_[i]=r);var n=r[e];if(void 0===n){var o=W[e];n=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[e]=n}return n},t}(),z=X,H=i("137e"),K=i("3749"),J=i("b55e"),Z=i.n(J),$=i("617d"),q=i("a896"),Q=i("7fc9"),tt=i("bef8");function et(t,e,i,r,n,o,a,s,l,c,h,u){var d,p=[];if(u){var f=Object(tt["a"])(t,e,i,r,u,[t[e],t[e+1]]);d=f[0]>f[f.length-r]}else d=t[e]>t[i-r];var g=n.length,_=t[e],m=t[e+1];e+=r;for(var y,v,O=t[e],b=t[e+1],x=0,j=Math.sqrt(Math.pow(O-_,2)+Math.pow(b-m,2)),E=!1,w=0;w<g;++w){y=d?g-w-1:w;var C=n[y],S=s*l(c,C,h),I=o+S/2;while(e<i-r&&x+j<I)_=O,m=b,e+=r,O=t[e],b=t[e+1],x+=j,j=Math.sqrt(Math.pow(O-_,2)+Math.pow(b-m,2));var T=I-x,R=Math.atan2(b-m,O-_);if(d&&(R+=R>0?-Math.PI:Math.PI),void 0!==v){var k=R-v;if(E=E||0!==k,k+=k>Math.PI?-2*Math.PI:k<-Math.PI?2*Math.PI:0,Math.abs(k)>a)return null}v=R;var A=T/j,D=Object(Q["c"])(_,O,A),M=Object(Q["c"])(m,b,A);p[y]=[D,M,S/2,R,C],o+=S}return E?p:[[p[0][0],p[0][1],p[0][2],p[0][3],n]]}function it(t,e,i,r){for(var n=t[e],o=t[e+1],a=0,s=e+r;s<i;s+=r){var l=t[s],c=t[s+1];a+=Math.sqrt((l-n)*(l-n)+(c-o)*(c-o)),n=l,o=c}return a}var rt=Object(O["j"])(),nt=Object(q["c"])(),ot=[],at=[],st=[],lt=[],ct=function(){function t(t,e,i,r,n){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignFill_,this.declutterItems=[],this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderBuffer_=n,this.renderedTransform_=Object(q["c"])(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={}}return t.prototype.createLabel=function(t,e,i,r){var n=t+e+i+r;if(this.labels_[n])return this.labels_[n];var o=r?this.strokeStates[r]:null,a=i?this.fillStates[i]:null,s=this.textStates[e],l=this.pixelRatio,c=[s.scale[0]*l,s.scale[1]*l],h=G[s.textAlign||b["m"]],u=r&&o.lineWidth?o.lineWidth:0,d=t.split("\n"),p=d.length,f=[],g=Object(b["r"])(s.font,d,f),_=Object(b["q"])(s.font),m=_*p,y=g+u,v=[],O=(y+2)*c[0],x=(m+u)*c[1],j={width:O<0?Math.floor(O):Math.ceil(O),height:x<0?Math.floor(x):Math.ceil(x),contextInstructions:v};if(1==c[0]&&1==c[1]||v.push("scale",c),v.push("font",s.font),r){v.push("strokeStyle",o.strokeStyle),v.push("lineWidth",u),v.push("lineCap",o.lineCap),v.push("lineJoin",o.lineJoin),v.push("miterLimit",o.miterLimit);var E=$["g"]?OffscreenCanvasRenderingContext2D:CanvasRenderingContext2D;E.prototype.setLineDash&&(v.push("setLineDash",[o.lineDash]),v.push("lineDashOffset",o.lineDashOffset))}i&&v.push("fillStyle",a.fillStyle),v.push("textBaseline","middle"),v.push("textAlign","center");var w,C=.5-h,S=h*y+C*u;if(r)for(w=0;w<p;++w)v.push("strokeText",[d[w],S+C*f[w],.5*(u+_)+w*_]);if(i)for(w=0;w<p;++w)v.push("fillText",[d[w],S+C*f[w],.5*(u+_)+w*_]);return this.labels_[n]=j,j},t.prototype.replayTextBackground_=function(t,e,i,r,n,o,a,s){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,r),t.lineTo.apply(t,n),t.lineTo.apply(t,e),o&&(this.alignFill_=o[2],s&&(t.fillStyle=o[1]),this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())},t.prototype.replayImageOrLabel_=function(t,e,i,r,n,o,a,s,l,c,h,u,d,p,f,g,_,m,y){var v=m||y;o*=p[0],a*=p[1],i-=o,r-=a;var x=g+h>n.width?n.width-h:g,j=l+u>n.height?n.height-u:l,E=_[3]+x*p[0]+_[1],w=_[0]+j*p[1]+_[2],C=i-_[3],S=r-_[0];(v||0!==d)&&(ot[0]=C,lt[0]=C,ot[1]=S,at[1]=S,at[0]=C+E,st[0]=at[0],st[1]=S+w,lt[1]=st[1]);var I=null;if(0!==d){var T=i+o,R=r+a;I=Object(q["b"])(nt,T,R,1,1,d,-T,-R),Object(q["a"])(nt,ot),Object(q["a"])(nt,at),Object(q["a"])(nt,st),Object(q["a"])(nt,lt),Object(O["k"])(Math.min(ot[0],at[0],st[0],lt[0]),Math.min(ot[1],at[1],st[1],lt[1]),Math.max(ot[0],at[0],st[0],lt[0]),Math.max(ot[1],at[1],st[1],lt[1]),rt)}else Object(O["k"])(C,S,C+E,S+w,rt);var k=0,A=0;if(s){var D=this.renderBuffer_;D[0]=Math.max(D[0],Object(O["E"])(rt)),k=D[0],D[1]=Math.max(D[1],Object(O["A"])(rt)),A=D[1]}var M=t.canvas,F=y?y[2]*p[0]/2:0,N=rt[0]-F<=(M.width+k)/e&&rt[2]+F>=-k/e&&rt[1]-F<=(M.height+A)/e&&rt[3]+F>=-A/e;if(f&&(i=Math.round(i),r=Math.round(r)),s){if(!N&&1==s[0])return!1;var L=N?[t,I?I.slice(0):null,c,n,h,u,x,j,i,r,p,rt.slice()]:null;L&&(v&&L.push(m,y,ot.slice(0),at.slice(0),st.slice(0),lt.slice(0)),s.push(L))}else N&&(v&&this.replayTextBackground_(t,ot,at,st,lt,m,y,!1),Object(b["o"])(t,I,c,n,h,u,x,j,i,r,p));return!0},t.prototype.fill_=function(t){if(this.alignFill_){var e=Object(q["a"])(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;t.save(),t.translate(e[0]%i,e[1]%i),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()},t.prototype.setStrokeStyle_=function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.setLineDash&&(t.lineDashOffset=e[7],t.setLineDash(e[6]))},t.prototype.renderDeclutter=function(t,e,i,r){for(var n=[],o=1,a=t.length;o<a;++o){var s=t[o],l=s[11];n.push({minX:l[0],minY:l[1],maxX:l[2],maxY:l[3],value:e})}r||(r=new Z.a(9));var c=!1;for(o=0,a=n.length;o<a;++o)if(r.collides(n[o])){c=!0;break}if(!c){r.load(n);for(var h=1,u=t.length;h<u;++h){s=t[h];var d=s[0],p=d.globalAlpha;p!==i&&(d.globalAlpha=i),s.length>12&&this.replayTextBackground_(s[0],s[14],s[15],s[16],s[17],s[12],s[13],!0),b["o"].apply(void 0,s),p!==i&&(d.globalAlpha=p)}}return t.length=1,r},t.prototype.drawLabelWithPointPlacement_=function(t,e,i,r){var n=this.textStates[e],o=this.createLabel(t,e,r,i),a=this.strokeStates[i],s=this.pixelRatio,l=G[n.textAlign||b["m"]],c=G[n.textBaseline||b["n"]],h=a&&a.lineWidth?a.lineWidth:0,u=o.width/s-2*n.scale[0],d=l*u+2*(.5-l)*h,p=c*o.height/s+2*(.5-c)*h;return{label:o,anchorX:d,anchorY:p}},t.prototype.execute_=function(t,e,i,r,n,o,a){var s;this.declutterItems.length=0,this.pixelCoordinates_&&Object(x["a"])(i,this.renderedTransform_)?s=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),s=Object(tt["c"])(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),Object(q["h"])(this.renderedTransform_,i));var l,c,h,u,d,p,f,_,m,y,v,j,E,w,C,S,I,T=0,R=r.length,k=0,A=0,D=0,M=null,F=null,N=this.coordinateCache_,L=this.viewRotation_,P=Math.round(1e12*Math.atan2(-i[1],i[0]))/1e12,V={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:L},B=this.instructions!=r||this.overlaps?0:200;while(T<R){var U=r[T],Y=U[0];switch(Y){case g.BEGIN_GEOMETRY:C=U[1],C.getGeometry()?void 0===a||Object(O["F"])(a,U[3])?++T:T=U[2]+1:T=U[2];break;case g.BEGIN_PATH:A>B&&(this.fill_(t),A=0),D>B&&(t.stroke(),D=0),A||D||(t.beginPath(),u=NaN,d=NaN),++T;break;case g.CIRCLE:k=U[1];var W=s[k],X=s[k+1],z=s[k+2],H=s[k+3],K=z-W,J=H-X,Z=Math.sqrt(K*K+J*J);t.moveTo(W+Z,X),t.arc(W,X,Z,0,2*Math.PI,!0),++T;break;case g.CLOSE_PATH:t.closePath(),++T;break;case g.CUSTOM:k=U[1],l=U[2];var $=U[3],Q=U[4],rt=6==U.length?U[5]:void 0;V.geometry=$,V.feature=C,T in N||(N[T]=[]);var nt=N[T];rt?rt(s,k,l,2,nt):(nt[0]=s[k],nt[1]=s[k+1],nt.length=2),Q(nt,V),++T;break;case g.DRAW_IMAGE:k=U[1],l=U[2],y=U[3],c=U[4],h=U[5],m=o?null:U[6];var ot=U[7],at=U[8],st=U[9],lt=U[10],ct=U[11],ht=U[12],ut=U[13],dt=U[14];if(!y&&U.length>=19){v=U[18],j=U[19],E=U[20],w=U[21];var pt=this.drawLabelWithPointPlacement_(v,j,E,w);y=pt.label,U[3]=y;var ft=U[22];c=(pt.anchorX-ft)*this.pixelRatio,U[4]=c;var gt=U[23];h=(pt.anchorY-gt)*this.pixelRatio,U[5]=h,ot=y.height,U[7]=ot,dt=y.width,U[14]=dt}var _t=void 0;U.length>24&&(_t=U[24]);var mt=void 0,yt=void 0,vt=void 0;U.length>16?(mt=U[15],yt=U[16],vt=U[17]):(mt=b["k"],yt=!1,vt=!1),ct&&P?ht+=L:ct||P||(ht-=L);for(var Ot=0,bt=0;k<l;k+=2)if(!(_t&&_t[Ot++]<dt/this.pixelRatio)){if(m){var xt=Math.floor(bt);_=m.length<xt+1?[m[0][0]]:m[xt]}var jt=this.replayImageOrLabel_(t,e,s[k],s[k+1],y,c,h,_,ot,at,st,lt,ht,ut,n,dt,mt,yt?M:null,vt?F:null);jt&&_&&m[m.length-1]!==_&&m.push(_),_&&(_.length-1===_[0]&&this.declutterItems.push(this,_,C),bt+=1/_[0])}++T;break;case g.DRAW_CHARS:var Et=U[1],wt=U[2],Ct=U[3];_=o?null:U[4];var St=U[5];w=U[6];var It=U[7],Tt=U[8],Rt=U[9];E=U[10];var kt=U[11];v=U[12],j=U[13];var At=[U[14],U[14]],Dt=this.textStates[j],Mt=Dt.font,Ft=[Dt.scale[0]*Tt,Dt.scale[1]*Tt],Nt=void 0;Mt in this.widths_?Nt=this.widths_[Mt]:(Nt={},this.widths_[Mt]=Nt);var Lt=it(s,Et,wt,2),Pt=Math.abs(Ft[0])*Object(b["p"])(Mt,v,Nt);if(St||Pt<=Lt){var Vt=this.textStates[j].textAlign,Bt=(Lt-Pt)*G[Vt],Gt=et(s,Et,wt,2,v,Bt,It,Math.abs(Ft[0]),b["p"],Mt,Nt,P?0:this.viewRotation_);if(Gt){jt=!1;var Ut=void 0,Yt=void 0,Wt=void 0,Xt=void 0,zt=void 0;if(E)for(Ut=0,Yt=Gt.length;Ut<Yt;++Ut)zt=Gt[Ut],Wt=zt[4],Xt=this.createLabel(Wt,j,"",E),c=zt[2]+kt,h=Ct*Xt.height+2*(.5-Ct)*kt*Ft[1]/Ft[0]-Rt,jt=this.replayImageOrLabel_(t,e,zt[0],zt[1],Xt,c,h,_,Xt.height,1,0,0,zt[3],At,!1,Xt.width,b["k"],null,null)||jt;if(w)for(Ut=0,Yt=Gt.length;Ut<Yt;++Ut)zt=Gt[Ut],Wt=zt[4],Xt=this.createLabel(Wt,j,w,""),c=zt[2],h=Ct*Xt.height-Rt,jt=this.replayImageOrLabel_(t,e,zt[0],zt[1],Xt,c,h,_,Xt.height,1,0,0,zt[3],At,!1,Xt.width,b["k"],null,null)||jt;jt&&this.declutterItems.push(this,_,C)}}++T;break;case g.END_GEOMETRY:if(void 0!==o){C=U[1];var Ht=o(C);if(Ht)return Ht}++T;break;case g.FILL:B?A++:this.fill_(t),++T;break;case g.MOVE_TO_LINE_TO:for(k=U[1],l=U[2],S=s[k],I=s[k+1],p=S+.5|0,f=I+.5|0,p===u&&f===d||(t.moveTo(S,I),u=p,d=f),k+=2;k<l;k+=2)S=s[k],I=s[k+1],p=S+.5|0,f=I+.5|0,k!=l-2&&p===u&&f===d||(t.lineTo(S,I),u=p,d=f);++T;break;case g.SET_FILL_STYLE:M=U,this.alignFill_=U[2],A&&(this.fill_(t),A=0,D&&(t.stroke(),D=0)),t.fillStyle=U[1],++T;break;case g.SET_STROKE_STYLE:F=U,D&&(t.stroke(),D=0),this.setStrokeStyle_(t,U),++T;break;case g.STROKE:B?D++:t.stroke(),++T;break;default:++T;break}}A&&this.fill_(t),D&&t.stroke()},t.prototype.execute=function(t,e,i,r,n){this.viewRotation_=r,this.execute_(t,e,i,this.instructions,n,void 0,void 0)},t.prototype.executeHitDetection=function(t,e,i,r,n){return this.viewRotation_=i,this.execute_(t,1,e,this.hitDetectionInstructions,!0,r,n)},t}(),ht=ct,ut=i("0999"),dt=[K["a"].POLYGON,K["a"].CIRCLE,K["a"].LINE_STRING,K["a"].IMAGE,K["a"].TEXT,K["a"].DEFAULT],pt=function(){function t(t,e,i,r,n,o){this.maxExtent_=t,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Object(q["c"])(),this.createExecutors_(n)}return t.prototype.clip=function(t,e){var i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()},t.prototype.createExecutors_=function(t){for(var e in t){var i=this.executorsByZIndex_[e];void 0===i&&(i={},this.executorsByZIndex_[e]=i);var r=t[e],n=[this.renderBuffer_||0,this.renderBuffer_||0];for(var o in r){var a=r[o];i[o]=new ht(this.resolution_,this.pixelRatio_,this.overlaps_,a,n)}}},t.prototype.hasExecutors=function(t){for(var e in this.executorsByZIndex_)for(var i=this.executorsByZIndex_[e],r=0,n=t.length;r<n;++r)if(t[r]in i)return!0;return!1},t.prototype.forEachFeatureAtCoordinate=function(t,e,i,r,n,o){r=Math.round(r);var a=2*r+1,s=Object(q["b"])(this.hitDetectionTransform_,r+.5,r+.5,1/e,-1/e,-i,-t[0],-t[1]);this.hitDetectionContext_||(this.hitDetectionContext_=Object(ut["a"])(a,a));var l,c=this.hitDetectionContext_;c.canvas.width!==a||c.canvas.height!==a?(c.canvas.width=a,c.canvas.height=a):c.clearRect(0,0,a,a),void 0!==this.renderBuffer_&&(l=Object(O["j"])(),Object(O["r"])(l,t),Object(O["c"])(l,e*(this.renderBuffer_+r),l));var h,u=_t(r);function d(t){for(var e=c.getImageData(0,0,a,a).data,i=0;i<a;i++)for(var r=0;r<a;r++)if(u[i][r]&&e[4*(r*a+i)+3]>0){var s=void 0;return(!o||h!=K["a"].IMAGE&&h!=K["a"].TEXT||-1!==o.indexOf(t))&&(s=n(t)),s||void c.clearRect(0,0,a,a)}}var p,f,g,_,m,y=Object.keys(this.executorsByZIndex_).map(Number);for(y.sort(x["f"]),p=y.length-1;p>=0;--p){var v=y[p].toString();for(g=this.executorsByZIndex_[v],f=dt.length-1;f>=0;--f)if(h=dt[f],_=g[h],void 0!==_&&(m=_.executeHitDetection(c,s,i,d,l),m))return m}},t.prototype.getClipCoords=function(t){var e=this.maxExtent_;if(!e)return null;var i=e[0],r=e[1],n=e[2],o=e[3],a=[i,r,i,o,n,o,n,r];return Object(tt["c"])(a,0,8,2,t,a),a},t.prototype.isEmpty=function(){return Object(n["d"])(this.executorsByZIndex_)},t.prototype.execute=function(t,e,i,r,n,o,a){var s=Object.keys(this.executorsByZIndex_).map(Number);s.sort(x["f"]),this.maxExtent_&&(t.save(),this.clip(t,i));var l,c,h,u,d,p,f=o||dt;for(l=0,c=s.length;l<c;++l){var g=s[l].toString();for(d=this.executorsByZIndex_[g],h=0,u=f.length;h<u;++h){var _=f[h];if(p=d[_],void 0!==p)if(!a||_!=K["a"].IMAGE&&_!=K["a"].TEXT)p.execute(t,e,i,r,n);else{var m=a[g];m?m.push(p,i.slice(0)):a[g]=[p,i.slice(0)]}}}this.maxExtent_&&t.restore()},t}(),ft={0:[[!0]]};function gt(t,e,i){var r,n=Math.floor(t.length/2);if(e>=n)for(r=n;r<e;r++)t[r][i]=!0;else if(e<n)for(r=e+1;r<n;r++)t[r][i]=!0}function _t(t){if(void 0!==ft[t])return ft[t];for(var e=2*t+1,i=new Array(e),r=0;r<e;r++)i[r]=new Array(e);var n=t,o=0,a=0;while(n>=o)gt(i,t+n,t+o),gt(i,t+o,t+n),gt(i,t-o,t+n),gt(i,t-n,t+o),gt(i,t-n,t-o),gt(i,t-o,t-n),gt(i,t+o,t-n),gt(i,t+n,t-o),o++,a+=1+2*o,2*(a-n)+1>0&&(n-=1,a+=1-2*n);return ft[t]=i,i}function mt(t,e,i,r,n,o){for(var a=Object.keys(t).map(Number).sort(x["f"]),s=0,l=a.length;s<l;++s)for(var c=t[a[s].toString()],h=void 0,u=0,d=c.length;u<d;){var p=c[u++],f=c[u++];p.execute(e,1,f,i,n),p!==h&&p.declutterItems.length>0&&(h=p,o.push({items:p.declutterItems,opacity:r}))}}var yt=pt,vt=i("496f"),Ot=i("c946"),bt=i("82b0"),xt=i("6cbf");function jt(t,e,i,r,n,o,a){var s=t[0]/2,l=t[1]/2,c=Object(ut["a"])(s,l);c.imageSmoothingEnabled=!1;for(var h=c.canvas,u=new Ot["a"](c,.5,n,null,a),d=i.length,p=Math.floor(16777215/d),f={},g=1;g<=d;++g){var m=i[g-1],y=m.getStyleFunction()||r;if(r){var v=y(m,o);if(v){Array.isArray(v)||(v=[v]);for(var b=g*p,j="#"+("000000"+b.toString(16)).slice(-6),E=0,w=v.length;E<w;++E){var C=v[E],S=C.clone(),I=S.getFill();I&&I.setColor(j);var T=S.getStroke();T&&T.setColor(j),S.setText(void 0);var R=C.getImage();if(R){var k=R.getImageSize();if(!k)continue;var A=document.createElement("canvas");A.width=k[0],A.height=k[1];var D=A.getContext("2d",{alpha:!1});D.fillStyle=j;var M=D.canvas;D.fillRect(0,0,M.width,M.height);var F=k?k[0]:M.width,N=k?k[1]:M.height,L=Object(ut["a"])(F,N);L.drawImage(M,0,0),S.setImage(new xt["a"]({img:M,imgSize:k,anchor:R.getAnchor(),anchorXUnits:bt["a"].PIXELS,anchorYUnits:bt["a"].PIXELS,offset:R.getOrigin(),size:R.getSize(),opacity:R.getOpacity(),scale:R.getScale(),rotation:R.getRotation(),rotateWithView:R.getRotateWithView()}))}var P=Number(S.getZIndex()),V=f[P];V||(V={},f[P]=V,V[_["a"].POLYGON]=[],V[_["a"].CIRCLE]=[],V[_["a"].LINE_STRING]=[],V[_["a"].POINT]=[]);var B=S.getGeometryFunction()(m);B&&Object(O["F"])(n,B.getExtent())&&V[B.getType().replace("Multi","")].push(B,S)}}}}for(var G=Object.keys(f).map(Number).sort(x["f"]),U=(g=0,G.length);g<U;++g){V=f[G[g]];for(var Y in V){var W=V[Y];for(E=0,w=W.length;E<w;E+=2){u.setStyle(W[E+1]);for(var X=0,z=e.length;X<z;++X)u.setTransform(e[X]),u.drawGeometry(W[E])}}}return c.getImageData(0,0,h.width,h.height)}function Et(t,e,i){var r=[];if(i){var n=4*(Math.round(t[0]/2)+Math.round(t[1]/2)*i.width),o=i.data[n],a=i.data[n+1],s=i.data[n+2],l=s+256*(a+256*o),c=Math.floor(16777215/e.length);l&&l%c===0&&r.push(e[l/c-1])}return r}var wt=i("30d1"),Ct=i("256f"),St=i("a568"),It=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Tt=function(t){function e(e){var i=t.call(this,e)||this;return i.boundHandleStyleImageChange_=i.handleStyleImageChange_.bind(i),i.animatingOrInteracting_,i.dirty_=!1,i.hitDetectionImageData_=null,i.renderedFeatures_=null,i.renderedRevision_=-1,i.renderedResolution_=NaN,i.renderedExtent_=Object(O["j"])(),i.renderedRotation_,i.renderedCenter_=null,i.renderedProjection_=null,i.renderedRenderOrder_=null,i.replayGroup_=null,i.replayGroupChanged=!0,i.clipping=!0,i}return It(e,t),e.prototype.useContainer=function(e,i,r){r<1&&(e=null),t.prototype.useContainer.call(this,e,i,r)},e.prototype.renderFrame=function(t,e){var i=t.pixelRatio,r=t.layerStatesArray[t.layerIndex];Object(q["e"])(this.pixelTransform,1/i,1/i),Object(q["d"])(this.inversePixelTransform,this.pixelTransform);var n=Object(q["i"])(this.pixelTransform);this.useContainer(e,n,r.opacity);var o=this.context,a=o.canvas,s=this.replayGroup_;if(!s||s.isEmpty())return!this.containerReused&&a.width>0&&(a.width=0),this.container;var l=Math.round(t.size[0]*i),c=Math.round(t.size[1]*i);a.width!=l||a.height!=c?(a.width=l,a.height=c,a.style.transform!==n&&(a.style.transform=n)):this.containerReused||o.clearRect(0,0,l,c),this.preRender(o,t);var h=t.extent,u=t.viewState,d=u.center,p=u.resolution,f=u.projection,g=u.rotation,_=f.getExtent(),m=this.getLayer().getSource(),y=!1;if(r.extent&&this.clipping){var v=Object(Ct["e"])(r.extent,f);y=!Object(O["g"])(v,t.extent)&&Object(O["F"])(v,t.extent),y&&this.clipUnrotated(o,t,v)}var b=t.viewHints,x=!(b[vt["a"].ANIMATING]||b[vt["a"].INTERACTING]),j=this.getRenderTransform(d,p,g,i,l,c,0),E=this.getLayer().getDeclutter()?{}:null;if(s.execute(o,1,j,g,x,void 0,E),m.getWrapX()&&f.canWrapX()&&!Object(O["g"])(_,h)){var w=h[0],C=Object(O["E"])(_),S=0,I=void 0;while(w<_[0]){--S,I=C*S;var T=this.getRenderTransform(d,p,g,i,l,c,I);s.execute(o,1,T,g,x,void 0,E),w+=C}S=0,w=h[2];while(w>_[2]){++S,I=C*S;var R=this.getRenderTransform(d,p,g,i,l,c,I);s.execute(o,1,R,g,x,void 0,E),w-=C}}if(E){var k=t.viewHints,A=!(k[vt["a"].ANIMATING]||k[vt["a"].INTERACTING]);mt(E,o,g,1,A,t.declutterItems)}y&&o.restore(),this.postRender(o,t);var D=r.opacity,M=this.container;return D!==parseFloat(M.style.opacity)&&(M.style.opacity=1===D?"":String(D)),this.renderedRotation_!==u.rotation&&(this.renderedRotation_=u.rotation,this.hitDetectionImageData_=null),this.container},e.prototype.getFeatures=function(t){return new Promise(function(e,i){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var r=[this.context.canvas.width,this.context.canvas.height];Object(q["a"])(this.pixelTransform,r);var n=this.renderedCenter_,o=this.renderedResolution_,a=this.renderedRotation_,s=this.renderedProjection_,l=this.renderedExtent_,c=this.getLayer(),h=[],u=r[0]/2,d=r[1]/2;h.push(this.getRenderTransform(n,o,a,.5,u,d,0).slice());var p=c.getSource(),f=s.getExtent();if(p.getWrapX()&&s.canWrapX()&&!Object(O["g"])(f,l)){var g=l[0],_=Object(O["E"])(f),m=0,y=void 0;while(g<f[0])--m,y=_*m,h.push(this.getRenderTransform(n,o,a,.5,u,d,y).slice()),g+=_;m=0,g=l[2];while(g>f[2])++m,y=_*m,h.push(this.getRenderTransform(n,o,a,.5,u,d,y).slice()),g-=_}this.hitDetectionImageData_=jt(r,h,this.renderedFeatures_,c.getStyleFunction(),l,o,a)}e(Et(t,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,r,n){if(this.replayGroup_){var o=e.viewState.resolution,a=e.viewState.rotation,s=this.getLayer(),l={},c=this.replayGroup_.forEachFeatureAtCoordinate(t,o,a,i,(function(t){var e=Object(P["c"])(t);if(!(e in l))return l[e]=!0,r(t,s)}),s.getDeclutter()?n:null);return c}},e.prototype.handleFontsChanged=function(){var t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.prepareFrame=function(t){var e=this.getLayer(),i=e.getSource();if(!i)return!1;var r=t.viewHints[vt["a"].ANIMATING],n=t.viewHints[vt["a"].INTERACTING],o=e.getUpdateWhileAnimating(),a=e.getUpdateWhileInteracting();if(!this.dirty_&&!o&&r||!a&&n)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var s=t.extent,l=t.viewState,c=l.projection,h=l.resolution,u=t.pixelRatio,d=e.getRevision(),p=e.getRenderBuffer(),f=e.getRenderOrder();void 0===f&&(f=wt["a"]);var g=l.center.slice(),_=Object(O["c"])(s,p*h),m=[_.slice()],y=c.getExtent();if(i.getWrapX()&&c.canWrapX()&&!Object(O["g"])(y,t.extent)){var v=Object(O["E"])(y),b=Math.max(Object(O["E"])(_)/2,v);_[0]=y[0]-b,_[2]=y[2]+b,Object(St["f"])(g,c);var x=Object(O["K"])(m[0],c);x[0]<y[0]&&x[2]<y[2]?m.push([x[0]+v,x[1],x[2]+v,x[3]]):x[0]>y[0]&&x[2]>y[2]&&m.push([x[0]-v,x[1],x[2]-v,x[3]])}if(!this.dirty_&&this.renderedResolution_==h&&this.renderedRevision_==d&&this.renderedRenderOrder_==f&&Object(O["g"])(this.renderedExtent_,_))return this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var j,E=new z(Object(wt["c"])(h,u),_,h,u,e.getDeclutter()),w=Object(Ct["j"])();if(w){for(var C=0,S=m.length;C<S;++C)i.loadFeatures(Object(Ct["l"])(m[C],c),h,w);j=Object(Ct["i"])(w,c)}else for(C=0,S=m.length;C<S;++C)i.loadFeatures(m[C],h,c);var I=Object(wt["b"])(h,u),T=function(t){var i,r=t.getStyleFunction()||e.getStyleFunction();if(r&&(i=r(t,h)),i){var n=this.renderFeature(t,I,i,E,j);this.dirty_=this.dirty_||n}}.bind(this),R=Object(Ct["l"])(_,c),k=i.getFeaturesInExtent(R);f&&k.sort(f);for(C=0,S=k.length;C<S;++C)T(k[C]);this.renderedFeatures_=k;var A=E.finish(),D=new yt(_,h,u,i.getOverlaps(),A,e.getRenderBuffer());return this.renderedResolution_=h,this.renderedRevision_=d,this.renderedRenderOrder_=f,this.renderedExtent_=_,this.renderedCenter_=g,this.renderedProjection_=c,this.replayGroup_=D,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0},e.prototype.renderFeature=function(t,e,i,r,n){if(!i)return!1;var o=!1;if(Array.isArray(i))for(var a=0,s=i.length;a<s;++a)o=Object(wt["d"])(r,t,i[a],e,this.boundHandleStyleImageChange_,n)||o;else o=Object(wt["d"])(r,t,i,e,this.boundHandleStyleImageChange_,n);return o},e}(H["a"]),Rt=Tt,kt=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),At=function(t){function e(e){return t.call(this,e)||this}return kt(e,t),e.prototype.createRenderer=function(){return new Rt(this)},e}(c);e["a"]=At},"4cdf":function(t,e,i){"use strict";var r=i("e269"),n=i("01d4"),o=i("92fa"),a=i("1e8d"),s=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),l=function(t){function e(e){var i=t.call(this)||this;if(i.id_=void 0,i.geometryName_="geometry",i.style_=null,i.styleFunction_=void 0,i.geometryChangeKey_=null,i.addEventListener(Object(r["b"])(i.geometryName_),i.handleGeometryChanged_),e)if("function"===typeof e.getSimplifiedGeometry){var n=e;i.setGeometry(n)}else{var o=e;i.setProperties(o)}return i}return s(e,t),e.prototype.clone=function(){var t=new e(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());var i=this.getGeometry();i&&t.setGeometry(i.clone());var r=this.getStyle();return r&&t.setStyle(r),t},e.prototype.getGeometry=function(){return this.get(this.geometryName_)},e.prototype.getId=function(){return this.id_},e.prototype.getGeometryName=function(){return this.geometryName_},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.handleGeometryChange_=function(){this.changed()},e.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(Object(a["c"])(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=Object(a["a"])(t,n["a"].CHANGE,this.handleGeometryChange_,this)),this.changed()},e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},e.prototype.setStyle=function(t){this.style_=t,this.styleFunction_=t?c(t):void 0,this.changed()},e.prototype.setId=function(t){this.id_=t,this.changed()},e.prototype.setGeometryName=function(t){this.removeEventListener(Object(r["b"])(this.geometryName_),this.handleGeometryChanged_),this.geometryName_=t,this.addEventListener(Object(r["b"])(this.geometryName_),this.handleGeometryChanged_),this.handleGeometryChanged_()},e}(r["a"]);function c(t){if("function"===typeof t)return t;var e;if(Array.isArray(t))e=t;else{Object(o["a"])("function"===typeof t.getZIndex,41);var i=t;e=[i]}return function(){return e}}e["a"]=l},5831:function(t,e,i){"use strict";var r=i("e300"),n=i("183a"),o=i("cef7"),a=i("01d4"),s=i("7b4f"),l=i("b55e"),c=i.n(l),h=i("0af5"),u=i("1300"),d=i("38f3"),p=function(){function t(t){this.rbush_=new c.a(t),this.items_={}}return t.prototype.insert=function(t,e){var i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[Object(u["c"])(e)]=i},t.prototype.load=function(t,e){for(var i=new Array(e.length),r=0,n=e.length;r<n;r++){var o=t[r],a=e[r],s={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[r]=s,this.items_[Object(u["c"])(a)]=s}this.rbush_.load(i)},t.prototype.remove=function(t){var e=Object(u["c"])(t),i=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(i)},t.prototype.update=function(t,e){var i=this.items_[Object(u["c"])(e)],r=[i.minX,i.minY,i.maxX,i.maxY];Object(h["p"])(r,t)||(this.remove(e),this.insert(t,e))},t.prototype.getAll=function(){var t=this.rbush_.all();return t.map((function(t){return t.value}))},t.prototype.getInExtent=function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]},i=this.rbush_.search(e);return i.map((function(t){return t.value}))},t.prototype.forEach=function(t){return this.forEach_(this.getAll(),t)},t.prototype.forEachInExtent=function(t,e){return this.forEach_(this.getInExtent(t),e)},t.prototype.forEach_=function(t,e){for(var i,r=0,n=t.length;r<n;r++)if(i=e(t[r]),i)return i;return i},t.prototype.isEmpty=function(){return Object(d["d"])(this.items_)},t.prototype.clear=function(){this.rbush_.clear(),this.items_={}},t.prototype.getExtent=function(t){var e=this.rbush_.toJSON();return Object(h["k"])(e.minX,e.minY,e.maxX,e.maxY,t)},t.prototype.concat=function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[e]=t.items_[e]},t}(),f=p,g=i("ff80"),_=i("6d83"),m={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature"},y=i("57cb");function v(t,e){return[[-1/0,-1/0,1/0,1/0]]}var O=i("92fa"),b=i("9f5e"),x=i("1e8d"),j={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"},E=!1;function w(t,e,i,r){return function(n,o,a){var s=new XMLHttpRequest;s.open("GET","function"===typeof t?t(n,o,a):t,!0),e.getType()==j.ARRAY_BUFFER&&(s.responseType="arraybuffer"),s.withCredentials=E,s.onload=function(t){if(!s.status||s.status>=200&&s.status<300){var o=e.getType(),l=void 0;o==j.JSON||o==j.TEXT?l=s.responseText:o==j.XML?(l=s.responseXML,l||(l=(new DOMParser).parseFromString(s.responseText,"application/xml"))):o==j.ARRAY_BUFFER&&(l=s.response),l?i.call(this,e.readFeatures(l,{extent:n,featureProjection:a}),e.readProjection(l)):r.call(this)}else r.call(this)}.bind(this),s.onerror=function(){r.call(this)}.bind(this),s.send()}}function C(t,e){return w(t,e,(function(t,e){var i=this;"function"===typeof i.addFeatures&&i.addFeatures(t)}),y["c"])}var S=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),I=function(t){function e(e,i){var r=t.call(this,e)||this;return r.feature=i,r}return S(e,t),e}(o["a"]),T=function(t){function e(e){var i=this,n=e||{};i=t.call(this,{attributions:n.attributions,projection:void 0,state:_["a"].READY,wrapX:void 0===n.wrapX||n.wrapX})||this,i.loader_=y["c"],i.format_=n.format,i.overlaps_=void 0===n.overlaps||n.overlaps,i.url_=n.url,void 0!==n.loader?i.loader_=n.loader:void 0!==i.url_&&(Object(O["a"])(i.format_,7),i.loader_=C(i.url_,i.format_)),i.strategy_=void 0!==n.strategy?n.strategy:v;var o,a,s=void 0===n.useSpatialIndex||n.useSpatialIndex;return i.featuresRtree_=s?new f:null,i.loadedExtentsRtree_=new f,i.nullGeometryFeatures_={},i.idIndex_={},i.uidIndex_={},i.featureChangeKeys_={},i.featuresCollection_=null,Array.isArray(n.features)?a=n.features:n.features&&(o=n.features,a=o.getArray()),s||void 0!==o||(o=new r["a"](a)),void 0!==a&&i.addFeaturesInternal(a),void 0!==o&&i.bindFeaturesCollection_(o),i}return S(e,t),e.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},e.prototype.addFeatureInternal=function(t){var e=Object(u["c"])(t);if(this.addToIndex_(e,t)){this.setupChangeEvents_(e,t);var i=t.getGeometry();if(i){var r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new I(m.ADDFEATURE,t))}else this.featuresCollection_&&this.featuresCollection_.remove(t)},e.prototype.setupChangeEvents_=function(t,e){this.featureChangeKeys_[t]=[Object(x["a"])(e,a["a"].CHANGE,this.handleFeatureChange_,this),Object(x["a"])(e,s["a"].PROPERTYCHANGE,this.handleFeatureChange_,this)]},e.prototype.addToIndex_=function(t,e){var i=!0,r=e.getId();return void 0!==r&&(r.toString()in this.idIndex_?i=!1:this.idIndex_[r.toString()]=e),i&&(Object(O["a"])(!(t in this.uidIndex_),30),this.uidIndex_[t]=e),i},e.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},e.prototype.addFeaturesInternal=function(t){for(var e=[],i=[],r=[],n=0,o=t.length;n<o;n++){var a=t[n],s=Object(u["c"])(a);this.addToIndex_(s,a)&&i.push(a)}n=0;for(var l=i.length;n<l;n++){a=i[n],s=Object(u["c"])(a);this.setupChangeEvents_(s,a);var c=a.getGeometry();if(c){var h=c.getExtent();e.push(h),r.push(a)}else this.nullGeometryFeatures_[s]=a}this.featuresRtree_&&this.featuresRtree_.load(e,r);n=0;for(var d=i.length;n<d;n++)this.dispatchEvent(new I(m.ADDFEATURE,i[n]))},e.prototype.bindFeaturesCollection_=function(t){var e=!1;this.addEventListener(m.ADDFEATURE,(function(i){e||(e=!0,t.push(i.feature),e=!1)})),this.addEventListener(m.REMOVEFEATURE,(function(i){e||(e=!0,t.remove(i.feature),e=!1)})),t.addEventListener(n["a"].ADD,function(t){e||(e=!0,this.addFeature(t.element),e=!1)}.bind(this)),t.addEventListener(n["a"].REMOVE,function(t){e||(e=!0,this.removeFeature(t.element),e=!1)}.bind(this)),this.featuresCollection_=t},e.prototype.clear=function(t){if(t){for(var e in this.featureChangeKeys_){var i=this.featureChangeKeys_[e];i.forEach(x["c"])}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_)for(var r in this.featuresRtree_.forEach(this.removeFeatureInternal.bind(this)),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var n=new I(m.CLEAR);this.dispatchEvent(n),this.changed()},e.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},e.prototype.forEachFeatureAtCoordinateDirect=function(t,e){var i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,(function(i){var r=i.getGeometry();return r.intersectsCoordinate(t)?e(i):void 0}))},e.prototype.forEachFeatureInExtent=function(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)},e.prototype.forEachFeatureIntersectingExtent=function(t,e){return this.forEachFeatureInExtent(t,(function(i){var r=i.getGeometry();if(r.intersectsExtent(t)){var n=e(i);if(n)return n}}))},e.prototype.getFeaturesCollection=function(){return this.featuresCollection_},e.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray():this.featuresRtree_&&(t=this.featuresRtree_.getAll(),Object(d["d"])(this.nullGeometryFeatures_)||Object(b["b"])(t,Object(d["c"])(this.nullGeometryFeatures_))),t},e.prototype.getFeaturesAtCoordinate=function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e},e.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_?this.featuresRtree_.getInExtent(t):this.featuresCollection_?this.featuresCollection_.getArray():[]},e.prototype.getClosestFeatureToCoordinate=function(t,e){var i=t[0],r=t[1],n=null,o=[NaN,NaN],a=1/0,s=[-1/0,-1/0,1/0,1/0],l=e||y["b"];return this.featuresRtree_.forEachInExtent(s,(function(t){if(l(t)){var e=t.getGeometry(),c=a;if(a=e.closestPointXY(i,r,o,a),a<c){n=t;var h=Math.sqrt(a);s[0]=i-h,s[1]=r-h,s[2]=i+h,s[3]=r+h}}})),n},e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},e.prototype.getFeatureById=function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getFeatureByUid=function(t){var e=this.uidIndex_[t];return void 0!==e?e:null},e.prototype.getFormat=function(){return this.format_},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.getUrl=function(){return this.url_},e.prototype.handleFeatureChange_=function(t){var e=t.target,i=Object(u["c"])(e),r=e.getGeometry();if(r){var n=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(n,e)):this.featuresRtree_&&this.featuresRtree_.update(n,e)}else i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);var o=e.getId();if(void 0!==o){var a=o.toString();this.idIndex_[a]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[a]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new I(m.CHANGEFEATURE,e))},e.prototype.hasFeature=function(t){var e=t.getId();return void 0!==e?e in this.idIndex_:Object(u["c"])(t)in this.uidIndex_},e.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&Object(d["d"])(this.nullGeometryFeatures_)},e.prototype.loadFeatures=function(t,e,i){var r=this.loadedExtentsRtree_,n=this.strategy_(t,e);this.loading=!1;for(var o=function(t,o){var s=n[t],l=r.forEachInExtent(s,(function(t){return Object(h["g"])(t.extent,s)}));l||(a.loader_.call(a,s,e,i),r.insert(s,{extent:s.slice()}),a.loading=a.loader_!==y["c"])},a=this,s=0,l=n.length;s<l;++s)o(s,l)},e.prototype.refresh=function(){this.clear(!0),this.loadedExtentsRtree_.clear(),t.prototype.refresh.call(this)},e.prototype.removeLoadedExtent=function(t){var e,i=this.loadedExtentsRtree_;i.forEachInExtent(t,(function(i){if(Object(h["p"])(i.extent,t))return e=i,!0})),e&&i.remove(e)},e.prototype.removeFeature=function(t){var e=Object(u["c"])(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},e.prototype.removeFeatureInternal=function(t){var e=Object(u["c"])(t);this.featureChangeKeys_[e].forEach(x["c"]),delete this.featureChangeKeys_[e];var i=t.getId();void 0!==i&&delete this.idIndex_[i.toString()],delete this.uidIndex_[e],this.dispatchEvent(new I(m.REMOVEFEATURE,t))},e.prototype.removeFromIdIndex_=function(t){var e=!1;for(var i in this.idIndex_)if(this.idIndex_[i]===t){delete this.idIndex_[i],e=!0;break}return e},e.prototype.setLoader=function(t){this.loader_=t},e.prototype.setUrl=function(t){Object(O["a"])(this.format_,7),this.setLoader(C(t,this.format_))},e}(g["a"]);e["a"]=T},6085:function(t,e,i){"use strict";i("b331")},"6c77":function(t,e,i){"use strict";i.d(e,"c",(function(){return l})),i.d(e,"a",(function(){return h}));var r=i("ce2c"),n=i("83a6"),o=(i("f623"),i("8682")),a=i("92fa"),s=function(){function t(t){var e=t||{};this.geometry_=null,this.geometryFunction_=u,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex}return t.prototype.clone=function(){var e=this.getGeometry();return e&&"object"===typeof e&&(e=e.clone()),new t({geometry:e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},t.prototype.getRenderer=function(){return this.renderer_},t.prototype.setRenderer=function(t){this.renderer_=t},t.prototype.getGeometry=function(){return this.geometry_},t.prototype.getGeometryFunction=function(){return this.geometryFunction_},t.prototype.getFill=function(){return this.fill_},t.prototype.setFill=function(t){this.fill_=t},t.prototype.getImage=function(){return this.image_},t.prototype.setImage=function(t){this.image_=t},t.prototype.getStroke=function(){return this.stroke_},t.prototype.setStroke=function(t){this.stroke_=t},t.prototype.getText=function(){return this.text_},t.prototype.setText=function(t){this.text_=t},t.prototype.getZIndex=function(){return this.zIndex_},t.prototype.setGeometry=function(t){"function"===typeof t?this.geometryFunction_=t:"string"===typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=u,this.geometry_=t},t.prototype.setZIndex=function(t){this.zIndex_=t},t}();function l(t){var e;if("function"===typeof t)e=t;else{var i;if(Array.isArray(t))i=t;else{Object(a["a"])("function"===typeof t.getZIndex,41);var r=t;i=[r]}e=function(){return i}}return e}var c=null;function h(t,e){if(!c){var i=new n["a"]({color:"rgba(255,255,255,0.4)"}),a=new o["a"]({color:"#3399CC",width:1.25});c=[new s({image:new r["a"]({fill:i,stroke:a,radius:5}),fill:i,stroke:a})]}return c}function u(t){return t.getGeometry()}e["b"]=s},"6cbf":function(t,e,i){"use strict";var r=i("01d4"),n=i("82b0"),o={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},a=i("869f"),s=i("ab35"),l=i("5c38"),c=i("92fa"),h=i("0ec0"),u=i("0999"),d=i("3c22"),p=i("6611"),f=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),g=null,_=function(t){function e(e,i,r,n,o,a){var s=t.call(this)||this;return s.hitDetectionImage_=null,s.image_=e||new Image,null!==n&&(s.image_.crossOrigin=n),s.canvas_={},s.color_=a,s.unlisten_=null,s.imageState_=o,s.size_=r,s.src_=i,s.tainted_,s}return f(e,t),e.prototype.isTainted_=function(){if(void 0===this.tainted_&&this.imageState_===a["a"].LOADED){g||(g=Object(u["a"])(1,1)),g.drawImage(this.image_,0,0);try{g.getImageData(0,0,1,1),this.tainted_=!1}catch(t){g=null,this.tainted_=!0}}return!0===this.tainted_},e.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(r["a"].CHANGE)},e.prototype.handleImageError_=function(){this.imageState_=a["a"].ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.handleImageLoad_=function(){this.imageState_=a["a"].LOADED,this.size_?(this.image_.width=this.size_[0],this.image_.height=this.size_[1]):this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.getImage=function(t){return this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_},e.prototype.getPixelRatio=function(t){return this.replaceColor_(t),this.canvas_[t]?t:1},e.prototype.getImageState=function(){return this.imageState_},e.prototype.getHitDetectionImage=function(){if(!this.hitDetectionImage_)if(this.isTainted_()){var t=this.size_[0],e=this.size_[1],i=Object(u["a"])(t,e);i.fillRect(0,0,t,e),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},e.prototype.getSize=function(){return this.size_},e.prototype.getSrc=function(){return this.src_},e.prototype.load=function(){if(this.imageState_==a["a"].IDLE){this.imageState_=a["a"].LOADING;try{this.image_.src=this.src_}catch(t){this.handleImageError_()}this.unlisten_=Object(p["a"])(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}},e.prototype.replaceColor_=function(t){if(this.color_&&!this.canvas_[t]){var e=document.createElement("canvas");this.canvas_[t]=e,e.width=Math.ceil(this.image_.width*t),e.height=Math.ceil(this.image_.height*t);var i=e.getContext("2d");if(i.scale(t,t),i.drawImage(this.image_,0,0),this.isTainted_()){var r=this.color_;return i.globalCompositeOperation="multiply",i.fillStyle="rgb("+r[0]+","+r[1]+","+r[2]+")",i.fillRect(0,0,e.width,e.height),i.globalCompositeOperation="destination-in",void i.drawImage(this.image_,0,0)}for(var n=i.getImageData(0,0,e.width,e.height),o=n.data,a=this.color_[0]/255,s=this.color_[1]/255,l=this.color_[2]/255,c=0,h=o.length;c<h;c+=4)o[c]*=a,o[c+1]*=s,o[c+2]*=l;i.putImageData(n,0,0)}},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(h["a"]);function m(t,e,i,r,n,o){var a=d["a"].get(e,r,o);return a||(a=new _(t,e,i,r,n,o),d["a"].set(e,r,o,a)),a}var y=i("1300"),v=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),O=function(t){function e(e){var i=this,r=e||{},s=void 0!==r.opacity?r.opacity:1,h=void 0!==r.rotation?r.rotation:0,u=void 0!==r.scale?r.scale:1,d=void 0!==r.rotateWithView&&r.rotateWithView;i=t.call(this,{opacity:s,rotation:h,scale:u,displacement:void 0!==r.displacement?r.displacement:[0,0],rotateWithView:d})||this,i.anchor_=void 0!==r.anchor?r.anchor:[.5,.5],i.normalizedAnchor_=null,i.anchorOrigin_=void 0!==r.anchorOrigin?r.anchorOrigin:o.TOP_LEFT,i.anchorXUnits_=void 0!==r.anchorXUnits?r.anchorXUnits:n["a"].FRACTION,i.anchorYUnits_=void 0!==r.anchorYUnits?r.anchorYUnits:n["a"].FRACTION,i.crossOrigin_=void 0!==r.crossOrigin?r.crossOrigin:null;var p=void 0!==r.img?r.img:null,f=void 0!==r.imgSize?r.imgSize:null,g=r.src;Object(c["a"])(!(void 0!==g&&p),4),Object(c["a"])(!p||p&&f,5),void 0!==g&&0!==g.length||!p||(g=p.src||Object(y["c"])(p)),Object(c["a"])(void 0!==g&&g.length>0,6);var _=void 0!==r.src?a["a"].IDLE:a["a"].LOADED;return i.color_=void 0!==r.color?Object(l["a"])(r.color):null,i.iconImage_=m(p,g,f,i.crossOrigin_,_,i.color_),i.offset_=void 0!==r.offset?r.offset:[0,0],i.offsetOrigin_=void 0!==r.offsetOrigin?r.offsetOrigin:o.TOP_LEFT,i.origin_=null,i.size_=void 0!==r.size?r.size:null,i}return v(e,t),e.prototype.clone=function(){var t=this.getScale();return new e({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},e.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var t=this.anchor_,e=this.getSize();if(this.anchorXUnits_==n["a"].FRACTION||this.anchorYUnits_==n["a"].FRACTION){if(!e)return null;t=this.anchor_.slice(),this.anchorXUnits_==n["a"].FRACTION&&(t[0]*=e[0]),this.anchorYUnits_==n["a"].FRACTION&&(t[1]*=e[1])}if(this.anchorOrigin_!=o.TOP_LEFT){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),this.anchorOrigin_!=o.TOP_RIGHT&&this.anchorOrigin_!=o.BOTTOM_RIGHT||(t[0]=-t[0]+e[0]),this.anchorOrigin_!=o.BOTTOM_LEFT&&this.anchorOrigin_!=o.BOTTOM_RIGHT||(t[1]=-t[1]+e[1])}return this.normalizedAnchor_=t,this.normalizedAnchor_},e.prototype.setAnchor=function(t){this.anchor_=t,this.normalizedAnchor_=null},e.prototype.getColor=function(){return this.color_},e.prototype.getImage=function(t){return this.iconImage_.getImage(t)},e.prototype.getPixelRatio=function(t){return this.iconImage_.getPixelRatio(t)},e.prototype.getImageSize=function(){return this.iconImage_.getSize()},e.prototype.getHitDetectionImageSize=function(){return this.getImageSize()},e.prototype.getImageState=function(){return this.iconImage_.getImageState()},e.prototype.getHitDetectionImage=function(){return this.iconImage_.getHitDetectionImage()},e.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var t=this.offset_,e=this.getDisplacement();if(this.offsetOrigin_!=o.TOP_LEFT){var i=this.getSize(),r=this.iconImage_.getSize();if(!i||!r)return null;t=t.slice(),this.offsetOrigin_!=o.TOP_RIGHT&&this.offsetOrigin_!=o.BOTTOM_RIGHT||(t[0]=r[0]-i[0]-t[0]),this.offsetOrigin_!=o.BOTTOM_LEFT&&this.offsetOrigin_!=o.BOTTOM_RIGHT||(t[1]=r[1]-i[1]-t[1])}return t[0]+=e[0],t[1]+=e[1],this.origin_=t,this.origin_},e.prototype.getSrc=function(){return this.iconImage_.getSrc()},e.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},e.prototype.listenImageChange=function(t){this.iconImage_.addEventListener(r["a"].CHANGE,t)},e.prototype.load=function(){this.iconImage_.load()},e.prototype.unlistenImageChange=function(t){this.iconImage_.removeEventListener(r["a"].CHANGE,t)},e}(s["a"]);e["a"]=O},8295:function(t,e,i){"use strict";var r=i("83a6"),n=i("29f6"),o=i("345d"),a="#333",s=function(){function t(t){var e=t||{};this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.scale_=e.scale,this.scaleArray_=Object(o["c"])(void 0!==e.scale?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.textBaseline_=e.textBaseline,this.fill_=void 0!==e.fill?e.fill:new r["a"]({color:a}),this.maxAngle_=void 0!==e.maxAngle?e.maxAngle:Math.PI/4,this.placement_=void 0!==e.placement?e.placement:n["a"].POINT,this.overflow_=!!e.overflow,this.stroke_=void 0!==e.stroke?e.stroke:null,this.offsetX_=void 0!==e.offsetX?e.offsetX:0,this.offsetY_=void 0!==e.offsetY?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=void 0===e.padding?null:e.padding}return t.prototype.clone=function(){var e=this.getScale();return new t({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()})},t.prototype.getOverflow=function(){return this.overflow_},t.prototype.getFont=function(){return this.font_},t.prototype.getMaxAngle=function(){return this.maxAngle_},t.prototype.getPlacement=function(){return this.placement_},t.prototype.getOffsetX=function(){return this.offsetX_},t.prototype.getOffsetY=function(){return this.offsetY_},t.prototype.getFill=function(){return this.fill_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.getRotation=function(){return this.rotation_},t.prototype.getScale=function(){return this.scale_},t.prototype.getScaleArray=function(){return this.scaleArray_},t.prototype.getStroke=function(){return this.stroke_},t.prototype.getText=function(){return this.text_},t.prototype.getTextAlign=function(){return this.textAlign_},t.prototype.getTextBaseline=function(){return this.textBaseline_},t.prototype.getBackgroundFill=function(){return this.backgroundFill_},t.prototype.getBackgroundStroke=function(){return this.backgroundStroke_},t.prototype.getPadding=function(){return this.padding_},t.prototype.setOverflow=function(t){this.overflow_=t},t.prototype.setFont=function(t){this.font_=t},t.prototype.setMaxAngle=function(t){this.maxAngle_=t},t.prototype.setOffsetX=function(t){this.offsetX_=t},t.prototype.setOffsetY=function(t){this.offsetY_=t},t.prototype.setPlacement=function(t){this.placement_=t},t.prototype.setRotateWithView=function(t){this.rotateWithView_=t},t.prototype.setFill=function(t){this.fill_=t},t.prototype.setRotation=function(t){this.rotation_=t},t.prototype.setScale=function(t){this.scale_=t,this.scaleArray_=Object(o["c"])(void 0!==t?t:1)},t.prototype.setStroke=function(t){this.stroke_=t},t.prototype.setText=function(t){this.text_=t},t.prototype.setTextAlign=function(t){this.textAlign_=t},t.prototype.setTextBaseline=function(t){this.textBaseline_=t},t.prototype.setBackgroundFill=function(t){this.backgroundFill_=t},t.prototype.setBackgroundStroke=function(t){this.backgroundStroke_=t},t.prototype.setPadding=function(t){this.padding_=t},t}();e["a"]=s},"82b0":function(t,e,i){"use strict";e["a"]={FRACTION:"fraction",PIXELS:"pixels"}},"83a6":function(t,e,i){"use strict";var r=function(){function t(t){var e=t||{};this.color_=void 0!==e.color?e.color:null}return t.prototype.clone=function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0})},t.prototype.getColor=function(){return this.color_},t.prototype.setColor=function(t){this.color_=t},t}();e["a"]=r},8682:function(t,e,i){"use strict";var r=function(){function t(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}return t.prototype.clone=function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},t.prototype.getColor=function(){return this.color_},t.prototype.getLineCap=function(){return this.lineCap_},t.prototype.getLineDash=function(){return this.lineDash_},t.prototype.getLineDashOffset=function(){return this.lineDashOffset_},t.prototype.getLineJoin=function(){return this.lineJoin_},t.prototype.getMiterLimit=function(){return this.miterLimit_},t.prototype.getWidth=function(){return this.width_},t.prototype.setColor=function(t){this.color_=t},t.prototype.setLineCap=function(t){this.lineCap_=t},t.prototype.setLineDash=function(t){this.lineDash_=t},t.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t},t.prototype.setLineJoin=function(t){this.lineJoin_=t},t.prototype.setMiterLimit=function(t){this.miterLimit_=t},t.prototype.setWidth=function(t){this.width_=t},t}();e["a"]=r},ab35:function(t,e,i){"use strict";var r=i("1300"),n=i("345d"),o=function(){function t(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=Object(n["c"])(t.scale),this.displacement_=t.displacement}return t.prototype.clone=function(){var e=this.getScale();return new t({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()})},t.prototype.getOpacity=function(){return this.opacity_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.getRotation=function(){return this.rotation_},t.prototype.getScale=function(){return this.scale_},t.prototype.getScaleArray=function(){return this.scaleArray_},t.prototype.getDisplacement=function(){return this.displacement_},t.prototype.getAnchor=function(){return Object(r["b"])()},t.prototype.getImage=function(t){return Object(r["b"])()},t.prototype.getHitDetectionImage=function(){return Object(r["b"])()},t.prototype.getPixelRatio=function(t){return 1},t.prototype.getImageState=function(){return Object(r["b"])()},t.prototype.getImageSize=function(){return Object(r["b"])()},t.prototype.getHitDetectionImageSize=function(){return Object(r["b"])()},t.prototype.getOrigin=function(){return Object(r["b"])()},t.prototype.getSize=function(){return Object(r["b"])()},t.prototype.setOpacity=function(t){this.opacity_=t},t.prototype.setRotateWithView=function(t){this.rotateWithView_=t},t.prototype.setRotation=function(t){this.rotation_=t},t.prototype.setScale=function(t){this.scale_=t,this.scaleArray_=Object(n["c"])(t)},t.prototype.listenImageChange=function(t){Object(r["b"])()},t.prototype.load=function(){Object(r["b"])()},t.prototype.unlistenImageChange=function(t){Object(r["b"])()},t}();e["a"]=o},b046:function(t,e,i){"use strict";var r=i("7a23");function n(t,e,i,n,o,a){const s=Object(r["resolveComponent"])("viMap"),l=Object(r["resolveComponent"])("Button"),c=Object(r["resolveComponent"])("Modal");return Object(r["openBlock"])(),Object(r["createBlock"])(c,{title:a.title,modelValue:a.showModal,"onUpdate:modelValue":e[2]||(e[2]=t=>a.showModal=t),width:1e3,"class-name":"vertical-center-modal singleUserMap"},{footer:Object(r["withCtx"])(()=>[i.isEdit?(Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],{key:0},[Object(r["createVNode"])(l,{type:"text",onClick:e[0]||(e[0]=t=>a.showModal=!1)},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])("取消")]),_:1}),Object(r["createVNode"])(l,{type:"primary",onClick:e[1]||(e[1]=e=>t.$emit("confirm",o.coordinate))},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])("确定")]),_:1})],64)):(Object(r["openBlock"])(),Object(r["createBlock"])(l,{key:1,type:"primary",onClick:a.toMapNavigation},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])("去导航")]),_:1},8,["onClick"]))]),default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(s,{onOnMount:a.onMount,class:"map"},null,8,["onOnMount"])]),_:1},8,["title","modelValue"])}var o=i("2af9"),a=i("3e6b"),s=i("5831"),l=i("4cdf"),c=i("6c77"),h=i("6cbf"),u=i("d051"),d=i("f403"),p=i("e47c"),f=i.n(p),g=i("ed08"),_={name:"singleUserMap",components:{viMap:o["h"]},props:{modelValue:{type:Boolean,default:!1},curRow:{type:Object,default(){return{}}},isEdit:{type:Boolean,default:!1}},data(){const t=JSON.parse(sessionStorage.getItem("webConfig")||"{}");return{mapConfig:t.map||{},map:null,vectorSource:null,coordinate:[]}},computed:{showModal:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}},title(){return`${this.isEdit?"点击/拖拽选择":"查看"} ${this.curRow.name} 定位`}},watch:{showModal(t){t&&this.drawPoint(this.curRow,!0)}},methods:{drawPoint({longitude:t,latitude:e},i){if(this.vectorSource.clear(),!t||!e)return void this.map.getView().setCenter(this.mapConfig.center);this.coordinate=[+t.toFixed(6),+e.toFixed(6)];const r=new l["a"]({geometry:new d["a"](this.coordinate)});this.vectorSource.addFeature(r),i&&this.map.getView().setCenter(this.coordinate)},onMount(t){this.map=t,this.vectorSource=new s["a"];const e=new a["a"]({source:this.vectorSource,style:()=>new c["b"]({image:new h["a"]({src:f.a,anchor:[.5,1]})})});if(this.map.addLayer(e),this.isEdit){this.map.on("singleclick",t=>{const[e,i]=t.coordinate;this.drawPoint({longitude:e,latitude:i})});const t=new u["a"]({layers:[e]});this.map.addInteraction(t),t.on("translateend",t=>{const[e,i]=t.features.array_[0].getGeometry().flatCoordinates;this.coordinate=[+e.toFixed(6),+i.toFixed(6)]})}},toMapNavigation(){const t=Object(g["e"])(this.curRow);if(!t)return this.$Message.error("未找到定位");window.open(t,"_self")}}},m=(i("c560"),i("6085"),i("6b0d")),y=i.n(m);const v=y()(_,[["render",n],["__scopeId","data-v-c0995978"]]);e["a"]=v},b116:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACyElEQVRYR82WP2gUQRTGv7eHvYLcxWi82SAkCDaSJhHRFMbGxEotVMTGUhS1MLebXLxNLIxoWisRA6KNXmz8AwmCSSFoI5KA5vaMhJuNYArb7JM1OZHNzs7uBYnbznvv++2bN98MYZM/Squ/fdjdn2HuAVEf+2ghwi5mfCMDC2AurxC9/F4Q75PWTQyQG6keg48LAPfqi9MEDNyT/fnnuthEAFmn8phAJ3TFwusMfuJZ5sm4PC1AznE5rXA4XlpCqRML0DTsjjLjykYBiHC7VhBXo+ooAVb3nCc2Kv4n36DeqJlQAzjVcrKBS4pIE9LK94WjIwGyI24n+ZhOUHqcmT8T0R4Ap3XxbKDL6xczf8dFAuRK1REQX4+dXubumm1O1WOaSpXDTDQZC8F0U9r5fj3AsDsNRqeqWIb99kW7dS683lyab1shY1YJQZiRBdGlBciW3IXA4aIK6c52nGcEjunZokULEHf2mXnIs82i6i+zpUqRiAZV62FPiB5Cx50loE1RZFxa4oxKIOe4D1UDycCcZ4l2fQdKlWfBZaMQWZaW2BYD8APA1sh15rK0zeN6AKd6B+BLKhEmKnqF/FB4Xdd+gO5KK39ZD5DEBYkWmf23YHwCYS+RcQDMzbHHMMIN/08nDP5i0++CAKLJcW8xEHmL6Ww3tM+jNUtci8pJ8B6ovgC4J41gKPa1tMQRVb4e4MbCPhgrr4JdaQBiyfdxdGlAfGgYIEjMOvNnCcaDtABEfL5WMO/H5Wk7UE9OPQ/MY9I2lV5Sr5sY4PfJcBLPw5S0RHeSjqUCWIVwa5p5WAYZB2Vh98d/ArDD+dLhI/NOadO+f84baE08L6k7sNqFykWAxtZDrPd6XRcaAliDeATQqboAg994lnlIJxhebxhgDeIrQMEL52eGt3Qs2jvXPdN0QBsCWBvKSWYe82zzqU6sIStupGianF/sHQ4wqSJAzQAAAABJRU5ErkJggg=="},b331:function(t,e,i){},b55e:function(t,e,i){(function(e,i){t.exports=i()})(0,(function(){"use strict";function t(t,i,n,o,a){e(t,i,n||0,o||t.length-1,a||r)}function e(t,r,n,o,a){while(o>n){if(o-n>600){var s=o-n+1,l=r-n+1,c=Math.log(s),h=.5*Math.exp(2*c/3),u=.5*Math.sqrt(c*h*(s-h)/s)*(l-s/2<0?-1:1),d=Math.max(n,Math.floor(r-l*h/s+u)),p=Math.min(o,Math.floor(r+(s-l)*h/s+u));e(t,r,d,p,a)}var f=t[r],g=n,_=o;i(t,n,r),a(t[o],f)>0&&i(t,n,o);while(g<_){i(t,g,_),g++,_--;while(a(t[g],f)<0)g++;while(a(t[_],f)>0)_--}0===a(t[n],f)?i(t,n,_):(_++,i(t,_,o)),_<=r&&(n=_+1),r<=_&&(o=_-1)}}function i(t,e,i){var r=t[e];t[e]=t[i],t[i]=r}function r(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function o(t,e,i){if(!i)return e.indexOf(t);for(var r=0;r<e.length;r++)if(i(t,e[r]))return r;return-1}function a(t,e){s(t,0,t.children.length,e,t)}function s(t,e,i,r,n){n||(n=m(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var o=e;o<i;o++){var a=t.children[o];l(n,t.leaf?r(a):a)}return n}function l(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function c(t,e){return t.minX-e.minX}function h(t,e){return t.minY-e.minY}function u(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function d(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function f(t,e){var i=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),n=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,n-i)*Math.max(0,o-r)}function g(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function _(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function m(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function y(e,i,r,n,o){var a=[i,r];while(a.length)if(r=a.pop(),i=a.pop(),!(r-i<=n)){var s=i+Math.ceil((r-i)/n/2)*n;t(e,s,i,r,o),a.push(i,s,s,r)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,i=[];if(!_(t,e))return i;var r=this.toBBox,n=[];while(e){for(var o=0;o<e.children.length;o++){var a=e.children[o],s=e.leaf?r(a):a;_(t,s)&&(e.leaf?i.push(a):g(t,s)?this._all(a,i):n.push(a))}e=n.pop()}return i},n.prototype.collides=function(t){var e=this.data;if(!_(t,e))return!1;var i=[];while(e){for(var r=0;r<e.children.length;r++){var n=e.children[r],o=e.leaf?this.toBBox(n):n;if(_(t,o)){if(e.leaf||g(t,o))return!0;i.push(n)}}e=i.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=m([]),this},n.prototype.remove=function(t,e){if(!t)return this;var i,r,n,a=this.data,s=this.toBBox(t),l=[],c=[];while(a||l.length){if(a||(a=l.pop(),r=l[l.length-1],i=c.pop(),n=!0),a.leaf){var h=o(t,a.children,e);if(-1!==h)return a.children.splice(h,1),l.push(a),this._condense(l),this}n||a.leaf||!g(a,s)?r?(i++,a=r.children[i],n=!1):a=null:(l.push(a),c.push(i),i=0,r=a,a=a.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){var i=[];while(t)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},n.prototype._build=function(t,e,i,r){var n,o=i-e+1,s=this._maxEntries;if(o<=s)return n=m(t.slice(e,i+1)),a(n,this.toBBox),n;r||(r=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,r-1))),n=m([]),n.leaf=!1,n.height=r;var l=Math.ceil(o/s),c=l*Math.ceil(Math.sqrt(s));y(t,e,i,c,this.compareMinX);for(var h=e;h<=i;h+=c){var u=Math.min(h+c-1,i);y(t,h,u,l,this.compareMinY);for(var d=h;d<=u;d+=l){var p=Math.min(d+l-1,u);n.children.push(this._build(t,d,p,r-1))}}return a(n,this.toBBox),n},n.prototype._chooseSubtree=function(t,e,i,r){while(1){if(r.push(e),e.leaf||r.length-1===i)break;for(var n=1/0,o=1/0,a=void 0,s=0;s<e.children.length;s++){var l=e.children[s],c=u(l),h=p(t,l)-c;h<o?(o=h,n=c<n?c:n,a=l):h===o&&c<n&&(n=c,a=l)}e=a||e.children[0]}return e},n.prototype._insert=function(t,e,i){var r=i?t:this.toBBox(t),n=[],o=this._chooseSubtree(r,this.data,e,n);o.children.push(t),l(o,r);while(e>=0){if(!(n[e].children.length>this._maxEntries))break;this._split(n,e),e--}this._adjustParentBBoxes(r,n,e)},n.prototype._split=function(t,e){var i=t[e],r=i.children.length,n=this._minEntries;this._chooseSplitAxis(i,n,r);var o=this._chooseSplitIndex(i,n,r),s=m(i.children.splice(o,i.children.length-o));s.height=i.height,s.leaf=i.leaf,a(i,this.toBBox),a(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(i,s)},n.prototype._splitRoot=function(t,e){this.data=m([t,e]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,i){for(var r,n=1/0,o=1/0,a=e;a<=i-e;a++){var l=s(t,0,a,this.toBBox),c=s(t,a,i,this.toBBox),h=f(l,c),d=u(l)+u(c);h<n?(n=h,r=a,o=d<o?d:o):h===n&&d<o&&(o=d,r=a)}return r||i-e},n.prototype._chooseSplitAxis=function(t,e,i){var r=t.leaf?this.compareMinX:c,n=t.leaf?this.compareMinY:h,o=this._allDistMargin(t,e,i,r),a=this._allDistMargin(t,e,i,n);o<a&&t.children.sort(r)},n.prototype._allDistMargin=function(t,e,i,r){t.children.sort(r);for(var n=this.toBBox,o=s(t,0,e,n),a=s(t,i-e,i,n),c=d(o)+d(a),h=e;h<i-e;h++){var u=t.children[h];l(o,t.leaf?n(u):u),c+=d(o)}for(var p=i-e-1;p>=e;p--){var f=t.children[p];l(a,t.leaf?n(f):f),c+=d(a)}return c},n.prototype._adjustParentBBoxes=function(t,e,i){for(var r=i;r>=0;r--)l(e[r],t)},n.prototype._condense=function(t){for(var e=t.length-1,i=void 0;e>=0;e--)0===t[e].children.length?e>0?(i=t[e-1].children,i.splice(i.indexOf(t[e]),1)):this.clear():a(t[e],this.toBBox)},n}))},b8b2:function(t,e,i){},c11a:function(t,e,i){"use strict";i("b8b2")},c560:function(t,e,i){"use strict";i("cd61")},c64b:function(t,e,i){"use strict";var r=i("7a23"),n=i("b116"),o=i.n(n);const a={class:"flex-ac"},s={key:0};function l(t,e,i,n,l,c){const h=Object(r["resolveComponent"])("viInput"),u=Object(r["resolveComponent"])("FormItem"),d=Object(r["resolveComponent"])("Option"),p=Object(r["resolveComponent"])("viSelect"),f=Object(r["resolveComponent"])("Form"),g=Object(r["resolveComponent"])("single-user-map"),_=Object(r["resolveComponent"])("Button"),m=Object(r["resolveComponent"])("Modal");return Object(r["openBlock"])(),Object(r["createBlock"])(m,{title:c.title,modelValue:c.showModal,"onUpdate:modelValue":e[7]||(e[7]=t=>c.showModal=t),width:400,"class-name":"vertical-center-modal"},{footer:Object(r["withCtx"])(()=>[Object(r["createVNode"])(_,{type:"text",onClick:e[6]||(e[6]=t=>c.showModal=!1)},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])("取消")]),_:1}),Object(r["createVNode"])(_,{type:"primary",onClick:c.submit,loading:l.loading},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])("确定")]),_:1},8,["onClick","loading"])]),default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(f,{ref:"form",model:l.formData,rules:l.rules,"label-width":90,onKeydown:Object(r["withKeys"])(c.submit,["enter"]),class:"plr"},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(u,{label:"客户名称:",prop:"name"},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(h,{modelValue:l.formData.name,"onUpdate:modelValue":e[0]||(e[0]=t=>l.formData.name=t)},null,8,["modelValue"])]),_:1}),Object(r["createVNode"])(u,{label:"用户权限:",prop:"power"},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(p,{modelValue:l.formData.power,"onUpdate:modelValue":e[1]||(e[1]=t=>l.formData.power=t)},{default:Object(r["withCtx"])(()=>[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(l.userPowerMap,(t,e)=>(Object(r["openBlock"])(),Object(r["createBlock"])(d,{key:e,value:e},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])(Object(r["toDisplayString"])(t),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(r["createVNode"])(u,{label:"标签:",prop:"label"},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(p,{modelValue:l.formData.label,"onUpdate:modelValue":e[2]||(e[2]=t=>l.formData.label=t),multiple:""},{default:Object(r["withCtx"])(()=>[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(l.dictMap.user,(t,e)=>(Object(r["openBlock"])(),Object(r["createBlock"])(d,{key:e,value:t.id},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])(Object(r["toDisplayString"])(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(r["createVNode"])(u,{label:"联系电话:",prop:"phone"},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(h,{modelValue:l.formData.phone,"onUpdate:modelValue":e[3]||(e[3]=t=>l.formData.phone=t)},null,8,["modelValue"])]),_:1}),Object(r["createVNode"])(u,{label:"定位:"},{default:Object(r["withCtx"])(()=>[Object(r["createElementVNode"])("div",a,[Object(r["createElementVNode"])("img",{src:o.a,onClick:e[4]||(e[4]=t=>l.showMapModal=!0),class:"pointer mr-10"}),l.formData.longitude&&l.formData.latitude?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",s,Object(r["toDisplayString"])(l.formData.longitude)+","+Object(r["toDisplayString"])(l.formData.latitude),1)):Object(r["createCommentVNode"])("",!0)])]),_:1})]),_:1},8,["model","rules","onKeydown"]),Object(r["createVNode"])(g,{modelValue:l.showMapModal,"onUpdate:modelValue":e[5]||(e[5]=t=>l.showMapModal=t),curRow:l.formData,isEdit:"",onConfirm:c.changeLonLat},null,8,["modelValue","curRow","onConfirm"])]),_:1},8,["title","modelValue"])}i("d9e2");var c=i("eeb9"),h=i("2410"),u=i.n(h),d=i("b046"),p=i("267e"),f=i("4360");const g=Object(f["a"])();var _={name:"addUserModal",components:{singleUserMap:d["a"]},props:{modelValue:{type:Boolean,default:!1},detailData:{type:Object,default(){return{}}}},data(){const t=async(t,e,i)=>{if(e&&this.detailData.name!==this.formData.name){const{data:t}=await Object(c["O"])({name:e})||{};if(t)return i(new Error("该客户名称已存在"))}i()};return{dictMap:g.dictMap,userPowerMap:p["b"],formData:{},rules:{name:[{required:!0,message:"请输入客户名称"},{validator:t,trigger:"blur"}]},loading:!1,showMapModal:!1}},computed:{title(){return(this.detailData.userId?"编辑":"新增")+"客户"},showModal:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t),t||this.$emit("close")}}},watch:{detailData:{deep:!0,handler(){this.$refs.form.resetFields(),this.formData=u()(this.detailData)}}},methods:{changeLonLat([t,e]){this.formData={...this.formData,longitude:t,latitude:e},this.showMapModal=!1},submit(){this.loading=!0,this.$refs.form.validate(async t=>{if(!t)return this.$Message.error("数据校验不通过"),void(this.loading=!1);try{const{_index:t,_rowKey:e,...i}=this.formData,{data:r}=await Object(c["K"])(i)||{};r&&(this.$Message.success(this.title+"成功"),this.$emit("save",{...this.formData}),this.$refs.form.resetFields(),this.showModal=!1)}catch(e){this.$Message.error("请求失败："+(e.message||e))}finally{this.loading=!1}})}}},m=i("6b0d"),y=i.n(m);const v=y()(_,[["render",l]]);e["a"]=v},cd61:function(t,e,i){},ce2c:function(t,e,i){"use strict";var r=i("869f"),n=i("ab35"),o=i("5c38"),a=i("e98d"),s=i("0999"),l=i("ddea"),c=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),h=function(t){function e(e){var i=this,r=void 0!==e.rotateWithView&&e.rotateWithView;return i=t.call(this,{opacity:1,rotateWithView:r,rotation:void 0!==e.rotation?e.rotation:0,scale:1,displacement:void 0!==e.displacement?e.displacement:[0,0]})||this,i.canvas_={},i.hitDetectionCanvas_=null,i.fill_=void 0!==e.fill?e.fill:null,i.origin_=[0,0],i.points_=e.points,i.radius_=void 0!==e.radius?e.radius:e.radius1,i.radius2_=e.radius2,i.angle_=void 0!==e.angle?e.angle:0,i.stroke_=void 0!==e.stroke?e.stroke:null,i.anchor_=null,i.size_=null,i.imageSize_=null,i.hitDetectionImageSize_=null,i.render(),i}return c(e,t),e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.getAnchor=function(){return this.anchor_},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(){if(!this.hitDetectionCanvas_){var t=this.createRenderOptions();this.createHitDetectionCanvas_(t)}return this.hitDetectionCanvas_},e.prototype.getImage=function(t){if(!this.canvas_[t||1]){var e=this.createRenderOptions(),i=Object(s["a"])(e.size*t||1,e.size*t||1);this.draw_(e,i,0,0,t||1),this.canvas_[t||1]=i.canvas}return this.canvas_[t||1]},e.prototype.getPixelRatio=function(t){return t},e.prototype.getImageSize=function(){return this.imageSize_},e.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},e.prototype.getImageState=function(){return r["a"].LOADED},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t){},e.prototype.createRenderOptions=function(){var t,e=l["e"],i=l["h"],r=0,n=null,o=0,s=0;this.stroke_&&(t=this.stroke_.getColor(),null===t&&(t=l["l"]),t=Object(a["a"])(t),s=this.stroke_.getWidth(),void 0===s&&(s=l["i"]),n=this.stroke_.getLineDash(),o=this.stroke_.getLineDashOffset(),i=this.stroke_.getLineJoin(),void 0===i&&(i=l["h"]),e=this.stroke_.getLineCap(),void 0===e&&(e=l["e"]),r=this.stroke_.getMiterLimit(),void 0===r&&(r=l["j"]));var c=2*(this.radius_+s)+1;return{strokeStyle:t,strokeWidth:s,size:c,lineCap:e,lineDash:n,lineDashOffset:o,lineJoin:i,miterLimit:r}},e.prototype.render=function(){var t=this.createRenderOptions(),e=Object(s["a"])(t.size,t.size);this.draw_(t,e,0,0,1),this.canvas_[1]=e.canvas;var i=e.canvas.width,r=i,n=this.getDisplacement();this.hitDetectionImageSize_=[t.size,t.size],this.createHitDetectionCanvas_(t),this.anchor_=[i/2-n[0],i/2+n[1]],this.size_=[i,i],this.imageSize_=[r,r]},e.prototype.draw_=function(t,e,i,r,n){var o,s,c;e.setTransform(n,0,0,n,0,0),e.translate(i,r),e.beginPath();var h=this.points_;if(h===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var u=void 0!==this.radius2_?this.radius2_:this.radius_;for(u!==this.radius_&&(h*=2),o=0;o<=h;o++)s=2*o*Math.PI/h-Math.PI/2+this.angle_,c=o%2===0?this.radius_:u,e.lineTo(t.size/2+c*Math.cos(s),t.size/2+c*Math.sin(s))}if(this.fill_){var d=this.fill_.getColor();null===d&&(d=l["c"]),e.fillStyle=Object(a["a"])(d),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,e.setLineDash&&t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke()),e.closePath()},e.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionCanvas_=this.getImage(1),this.fill_){var e=this.fill_.getColor(),i=0;if("string"===typeof e&&(e=Object(o["a"])(e)),null===e?i=1:Array.isArray(e)&&(i=4===e.length?e[3]:1),0===i){var r=Object(s["a"])(t.size,t.size);this.hitDetectionCanvas_=r.canvas,this.drawHitDetectionCanvas_(t,r,0,0)}}},e.prototype.drawHitDetectionCanvas_=function(t,e,i,r){e.translate(i,r),e.beginPath();var n=this.points_;if(n===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var o=void 0!==this.radius2_?this.radius2_:this.radius_;o!==this.radius_&&(n*=2);var a=void 0,s=void 0,c=void 0;for(a=0;a<=n;a++)c=2*a*Math.PI/n-Math.PI/2+this.angle_,s=a%2===0?this.radius_:o,e.lineTo(t.size/2+s*Math.cos(c),t.size/2+s*Math.sin(c))}e.fillStyle=l["c"],e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.stroke()),e.closePath()},e}(n["a"]),u=h,d=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),p=function(t){function e(e){var i=this,r=e||{};return i=t.call(this,{points:1/0,fill:r.fill,radius:r.radius,stroke:r.stroke,displacement:void 0!==r.displacement?r.displacement:[0,0]})||this,i}return d(e,t),e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),displacement:this.getDisplacement().slice()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.setRadius=function(t){this.radius_=t,this.render()},e}(u);e["a"]=p},d051:function(t,e,i){"use strict";var r=i("e300"),n=i("cef7"),o=i("bf62"),a=i("4105"),s=i("57cb"),l=i("e269"),c=i("9f5e"),h=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},t(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),u={TRANSLATESTART:"translatestart",TRANSLATING:"translating",TRANSLATEEND:"translateend"},d=function(t){function e(e,i,r,n,o){var a=t.call(this,e)||this;return a.features=i,a.coordinate=r,a.startCoordinate=n,a.mapBrowserEvent=o,a}return h(e,t),e}(n["a"]),p=function(t){function e(e){var i,r=this,n=e||{};if(r=t.call(this,n)||this,r.lastCoordinate_=null,r.startCoordinate_=null,r.features_=void 0!==n.features?n.features:null,n.layers)if("function"===typeof n.layers)i=n.layers;else{var a=n.layers;i=function(t){return Object(c["c"])(a,t)}}else i=s["b"];return r.layerFilter_=i,r.filter_=n.filter?n.filter:s["b"],r.hitTolerance_=n.hitTolerance?n.hitTolerance:0,r.lastFeature_=null,r.addEventListener(Object(l["b"])(o["a"].ACTIVE),r.handleActiveChanged_),r}return h(e,t),e.prototype.handleDownEvent=function(t){if(this.lastFeature_=this.featuresAtPixel_(t.pixel,t.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=t.coordinate,this.lastCoordinate_=t.coordinate,this.handleMoveEvent(t);var e=this.features_||new r["a"]([this.lastFeature_]);return this.dispatchEvent(new d(u.TRANSLATESTART,e,t.coordinate,this.startCoordinate_,t)),!0}return!1},e.prototype.handleUpEvent=function(t){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(t);var e=this.features_||new r["a"]([this.lastFeature_]);return this.dispatchEvent(new d(u.TRANSLATEEND,e,t.coordinate,this.startCoordinate_,t)),this.startCoordinate_=null,!0}return!1},e.prototype.handleDragEvent=function(t){if(this.lastCoordinate_){var e=t.coordinate,i=e[0]-this.lastCoordinate_[0],n=e[1]-this.lastCoordinate_[1],o=this.features_||new r["a"]([this.lastFeature_]);o.forEach((function(t){var e=t.getGeometry();e.translate(i,n),t.setGeometry(e)})),this.lastCoordinate_=e,this.dispatchEvent(new d(u.TRANSLATING,o,e,this.startCoordinate_,t))}},e.prototype.handleMoveEvent=function(t){var e=t.map.getViewport();this.featuresAtPixel_(t.pixel,t.map)?(e.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),e.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):e.classList.remove("ol-grab","ol-grabbing")},e.prototype.featuresAtPixel_=function(t,e){return e.forEachFeatureAtPixel(t,function(t,e){if(this.filter_(t,e)&&(!this.features_||Object(c["c"])(this.features_.getArray(),t)))return t}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})},e.prototype.getHitTolerance=function(){return this.hitTolerance_},e.prototype.setHitTolerance=function(t){this.hitTolerance_=t},e.prototype.setMap=function(e){var i=this.getMap();t.prototype.setMap.call(this,e),this.updateState_(i)},e.prototype.handleActiveChanged_=function(){this.updateState_(null)},e.prototype.updateState_=function(t){var e=this.getMap(),i=this.getActive();if((!e||!i)&&(e=e||t,e)){var r=e.getViewport();r.classList.remove("ol-grab","ol-grabbing")}},e}(a["b"]);e["a"]=p},d384:function(t,e,i){},e47c:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACvElEQVRYR7WXP2gUQRTGv3eb3TWIYJGAIdlFkXi7GBSMlZJgIQYEEURJJbHQaCMiFunUa8UihSAqYkijjQgBEYMYFcFGiyDk7lAJN5eoRG01t5u7J5uL4bzbP3OX3Wnnve/77cybN7OEFsenbeh0ddUgBrWT+nV74fe3VqSomaQ5QxtOgQcBnAJRZ30uARMVxrRddB7K6koBZE11lECjAPplhBn0hogyVmH5ZVR8JEDO1B4BGI4S8ptnYNIWzkhYbihAztSeAjjainltjiWcQJ/AibypXWPg+kbNq/l02RKlcT8tX4CsoR8h4ufxmFdVVoDdfcKZ8yncRpucqU0COB0nAIDHlnBORgJku/VdpHA+ZvPqRoBH0sL1Pm59NGxB1tCvEPHNRAAIT9IF50QoQM5QZ0B0KAkAT7P+RDSsQM7UPgPYmRSAUlaM3sU/C//0/QCWAehJATBVDtiFlXfBAIa65Nfn4wLiCvbYC87HsBX4AGBfXIb1Olx2OuxF/AoEyJvaAwbOJASwaAmnJ+oUXADR7SQAGMjYwvmvvTf2AVPtJ9D7ZAB4vy1cb4uDG5E3kzf1Owz27v/YBoHupkXpfL2g72WU36Hu5XLqBcAd8RDQT1Iqh9Pz7qwUgBeUNdVzHnUcAN5q2sK956cV8SBRxwG6tBEIZr5lF92LQRqRT7KsqU0RcKxFiGlLOENhuZEAs93tPbpSfgagr0mIAhQasuZLoVd7JMDqqTDaBphSHsRmaQim41axNBUVLwWwVpQjBJqIElybH7OEc0MmVhqgCqFlCLgaKsx03yqWzsqYezFNAVSblDbJge9FemuJ0oCseUsAM0Bbl6m/AvhgrRGBl1hJDUYVnXQjCvuKLz16r5vi1wC61uMkiy4WgNV6MPQhIvZ+27YCkC662AA8oVwHtiht2NT7HT+a2ffa2L/0LdAhIK9hBgAAAABJRU5ErkJggg=="},f095:function(t,e,i){"use strict";i("d384")},f6f3:function(t,e,i){"use strict";var r=i("7a23");const n={class:"flex-ac"},o={class:"user-list"};function a(t,e,i,a,s,l){const c=Object(r["resolveComponent"])("Spin"),h=Object(r["resolveComponent"])("van-field"),u=Object(r["resolveComponent"])("Icon"),d=Object(r["resolveComponent"])("viEmpty"),p=Object(r["resolveComponent"])("van-radio"),f=Object(r["resolveComponent"])("van-cell"),g=Object(r["resolveComponent"])("van-radio-group"),_=Object(r["resolveComponent"])("van-action-sheet");return Object(r["openBlock"])(),Object(r["createBlock"])(_,{show:l.showModal,"onUpdate:show":e[3]||(e[3]=t=>l.showModal=t),title:"选择客户"},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(c,{fix:"",show:s.newUserLoading},null,8,["show"]),Object(r["createElementVNode"])("div",n,[Object(r["createVNode"])(h,{modelValue:s.newUserName,"onUpdate:modelValue":e[0]||(e[0]=t=>s.newUserName=t),label:"没有？快速新增：","label-width":"120",clearable:"",placeholder:"客户名称"},null,8,["modelValue"]),Object(r["createVNode"])(u,{type:"ios-checkmark-circle-outline",color:"green",size:"30",class:"mr-10",onClick:l.confirmAddUser},null,8,["onClick"])]),Object(r["createVNode"])(h,{modelValue:s.filterName,"onUpdate:modelValue":e[1]||(e[1]=t=>s.filterName=t),label:"过滤客户：","label-width":"80",clearable:"",placeholder:"客户名称"},null,8,["modelValue"]),Object(r["createElementVNode"])("div",o,[Object(r["createVNode"])(g,{modelValue:l.curUserId,"onUpdate:modelValue":e[2]||(e[2]=t=>l.curUserId=t)},{default:Object(r["withCtx"])(()=>[l.filterUsers.length?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createBlock"])(d,{key:0})),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(l.filterUsers,t=>(Object(r["openBlock"])(),Object(r["createBlock"])(f,{key:t.userId,title:t.name,clickable:"",onClick:e=>l.selectUser(t)},{"right-icon":Object(r["withCtx"])(()=>[Object(r["createVNode"])(p,{name:t.userId},null,8,["name"])]),_:2},1032,["title","onClick"]))),128))]),_:1},8,["modelValue"])])]),_:1},8,["show"])}var s=i("f23a"),l=i("eeb9"),c={name:"userSelect",components:{[s["a"].name]:s["a"]},props:{modelValue:{type:Boolean,default:!1},allUsers:{type:Array,default(){return[]}},userId:{type:[Number,String],default:""}},data(){return{filterName:"",newUserName:"",newUserLoading:!1}},computed:{showModal:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}},curUserId:{get(){return this.userId},set(t){this.$emit("update:userId",t)}},filterUsers(){return this.allUsers.filter(t=>!this.filterName||t.name.includes(this.filterName))}},methods:{selectUser(t){this.curUserId=t.userId,this.newUserName="",this.showModal=!1,this.$emit("change",t)},async confirmAddUser(){if(this.newUserName)try{this.newUserLoading=!0;const{data:t}=await Object(l["O"])({name:this.newUserName})||{};if(t)return this.$Message.success("名称已存在\n已选择"),void this.selectUser(t);const{data:e}=await Object(l["K"])({name:this.newUserName})||{};e&&(this.$Message.success("新增成功"),this.selectUser(e))}catch(t){this.$Message.error("新增客户失败："+(t.message||t))}finally{this.newUserLoading=!1}else this.$Message.info("请输入要新增的客户名称")}}},h=(i("f095"),i("6b0d")),u=i.n(h);const d=u()(c,[["render",a],["__scopeId","data-v-d2dc9874"]]);e["a"]=d},ff79:function(t,e,i){"use strict";var r=i("7a23"),n=i("b116"),o=i.n(n);const a={class:"flex-ac"},s={key:0};function l(t,e,i,n,l,c){const h=Object(r["resolveComponent"])("Radio"),u=Object(r["resolveComponent"])("RadioGroup"),d=Object(r["resolveComponent"])("FormItem"),p=Object(r["resolveComponent"])("viInput"),f=Object(r["resolveComponent"])("userSelect"),g=Object(r["resolveComponent"])("Option"),_=Object(r["resolveComponent"])("viSelect"),m=Object(r["resolveComponent"])("Form"),y=Object(r["resolveComponent"])("single-user-map"),v=Object(r["resolveComponent"])("Button"),O=Object(r["resolveComponent"])("Modal");return Object(r["openBlock"])(),Object(r["createBlock"])(O,{title:"用户审批",modelValue:c.showModal,"onUpdate:modelValue":e[12]||(e[12]=t=>c.showModal=t),width:400,"class-name":"vertical-center-modal"},{footer:Object(r["withCtx"])(()=>[Object(r["createVNode"])(v,{type:"text",onClick:e[11]||(e[11]=t=>c.showModal=!1)},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])("取消")]),_:1}),Object(r["createVNode"])(v,{type:"primary",onClick:c.submit,loading:l.loading},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])("确定")]),_:1},8,["onClick","loading"])]),default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(m,{ref:"form",model:l.formData,rules:l.rules,"label-width":90,onKeydown:Object(r["withKeys"])(c.submit,["enter"]),class:"plr"},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(d,{label:"用户验证:"},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(u,{modelValue:l.userVerify,"onUpdate:modelValue":e[0]||(e[0]=t=>l.userVerify=t)},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(h,{label:"1"},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])("新建用户")]),_:1}),Object(r["createVNode"])(h,{label:"2"},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])("选择已有用户")]),_:1})]),_:1},8,["modelValue"])]),_:1}),"1"===l.userVerify?(Object(r["openBlock"])(),Object(r["createBlock"])(d,{key:0,label:"客户名称:",prop:"name"},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(p,{modelValue:l.formData.name,"onUpdate:modelValue":e[1]||(e[1]=t=>l.formData.name=t)},null,8,["modelValue"])]),_:1})):(Object(r["openBlock"])(),Object(r["createBlock"])(d,{key:1,label:"选择客户:"},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(p,{modelValue:l.formData.name,"onUpdate:modelValue":e[2]||(e[2]=t=>l.formData.name=t),readonly:"",onClick:e[3]||(e[3]=t=>l.showUserSelect=!0)},null,8,["modelValue"]),Object(r["createVNode"])(f,{modelValue:l.showUserSelect,"onUpdate:modelValue":e[4]||(e[4]=t=>l.showUserSelect=t),userId:l.curUserId,"onUpdate:userId":e[5]||(e[5]=t=>l.curUserId=t),allUsers:t.allUsers,onChange:c.selectUser},null,8,["modelValue","userId","allUsers","onChange"])]),_:1})),Object(r["createVNode"])(d,{label:"用户权限:",prop:"power"},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(_,{modelValue:l.formData.power,"onUpdate:modelValue":e[6]||(e[6]=t=>l.formData.power=t)},{default:Object(r["withCtx"])(()=>[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(l.userPowerMap,(t,e)=>(Object(r["openBlock"])(),Object(r["createBlock"])(g,{key:e,value:e},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])(Object(r["toDisplayString"])(t),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(r["createVNode"])(d,{label:"标签:",prop:"label"},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(_,{modelValue:l.formData.label,"onUpdate:modelValue":e[7]||(e[7]=t=>l.formData.label=t),multiple:""},{default:Object(r["withCtx"])(()=>[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(l.dictMap.user,(t,e)=>(Object(r["openBlock"])(),Object(r["createBlock"])(g,{key:e,value:t.id},{default:Object(r["withCtx"])(()=>[Object(r["createTextVNode"])(Object(r["toDisplayString"])(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(r["createVNode"])(d,{label:"联系电话:",prop:"phone"},{default:Object(r["withCtx"])(()=>[Object(r["createVNode"])(p,{modelValue:l.formData.phone,"onUpdate:modelValue":e[8]||(e[8]=t=>l.formData.phone=t)},null,8,["modelValue"])]),_:1}),Object(r["createVNode"])(d,{label:"定位:"},{default:Object(r["withCtx"])(()=>[Object(r["createElementVNode"])("div",a,[Object(r["createElementVNode"])("img",{src:o.a,onClick:e[9]||(e[9]=t=>l.showMapModal=!0),class:"pointer mr-10"}),l.formData.longitude&&l.formData.latitude?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",s,Object(r["toDisplayString"])(l.formData.longitude)+","+Object(r["toDisplayString"])(l.formData.latitude),1)):Object(r["createCommentVNode"])("",!0)])]),_:1})]),_:1},8,["model","rules","onKeydown"]),Object(r["createVNode"])(y,{modelValue:l.showMapModal,"onUpdate:modelValue":e[10]||(e[10]=t=>l.showMapModal=t),curRow:l.formData,isEdit:"",onConfirm:c.changeLonLat},null,8,["modelValue","curRow","onConfirm"])]),_:1},8,["modelValue"])}i("d9e2");var c=i("2410"),h=i.n(c),u=i("b046"),d=i("f6f3"),p=i("267e"),f=i("eeb9"),g=i("4360");const _=Object(g["a"])();var m={name:"auditUserModal",components:{singleUserMap:u["a"],userSelect:d["a"]},props:{modelValue:{type:Boolean,default:!1},detailData:{type:Object,default(){return{}}}},data(){const t=async(t,e,i)=>{if(e&&this.detailData.name!==this.formData.name){const{data:t}=await Object(f["O"])({name:e})||{};if(t)return i(new Error("该客户名称已存在"))}i()};return{dictMap:_.dictMap,userPowerMap:p["b"],formData:{},rules:{name:[{required:!0,message:"请输入客户名称"},{validator:t,trigger:"blur"}]},loading:!1,showMapModal:!1,userVerify:"1",showUserSelect:!1,curUserId:"",allUser:[]}},computed:{showModal:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t),t||this.$emit("close")}}},watch:{detailData:{deep:!0,handler(){this.$refs.form.resetFields(),this.userVerify="1",this.curUserId="",this.formData=h()(this.detailData)}}},methods:{changeLonLat([t,e]){this.formData={...this.formData,longitude:t,latitude:e},this.showMapModal=!1},selectUser(t){this.formData={...this.formData,name:t.name,longitude:t.longitude,latitude:t.latitude,power:t.power,label:t.label,phone:[this.formData.phone,t.phone].filter(t=>t).join(" ")}},submit(){this.loading=!0,this.$refs.form.validate(async t=>{if(!t)return this.$Message.error("数据校验不通过"),void(this.loading=!1);try{const{_index:t,_rowKey:e,...i}=this.formData,{data:r}=await Object(f["b"])({...i,userVerify:this.userVerify,updateUserId:this.curUserId})||{};r&&(this.$Message.success("操作成功"),this.$emit("save",{...this.formData}),this.$refs.form.resetFields(),this.showModal=!1)}catch(e){this.$Message.error("请求失败："+(e.message||e))}finally{this.loading=!1}})},async getUsersList(){try{const{returnCode:t,data:e}=await Object(f["x"])({status:"1"})||{};0===t&&(this.allUsers=e||[])}catch(t){this.$Message.error("获取客户列表失败："+(t.message||t))}}},mounted(){this.getUsersList()}},y=i("6b0d"),v=i.n(y);const O=v()(m,[["render",l]]);e["a"]=O}}]);