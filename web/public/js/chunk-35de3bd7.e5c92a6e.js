(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-35de3bd7"],{"0aeb":function(e,t,a){"use strict";a.r(t);var c=a("7a23");const o={class:"flex m-15"},r=["onClick"],l={class:"title"},i={class:"f-16"},s={class:"f-16"},n={class:"f-16"};function d(e,t,a,d,m,u){const b=Object(c["resolveComponent"])("van-tab"),h=Object(c["resolveComponent"])("van-tabs"),p=Object(c["resolveComponent"])("Icon"),O=Object(c["resolveComponent"])("van-cell"),j=Object(c["resolveComponent"])("van-search"),V=Object(c["resolveComponent"])("viCalendar"),v=Object(c["resolveComponent"])("Button"),C=Object(c["resolveComponent"])("van-action-sheet"),N=Object(c["resolveComponent"])("viListScroll"),k=Object(c["resolveComponent"])("orderDetail");return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",null,[Object(c["createVNode"])(h,{active:m.status,"onUpdate:active":t[0]||(t[0]=e=>m.status=e),onChange:u.reSearch},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(b,{title:"草稿",name:"1",badge:a.draftCount||void 0},null,8,["badge"]),Object(c["createVNode"])(b,{title:"已打印",name:"2"})]),_:1},8,["active","onChange"]),Object(c["createVNode"])(j,{modelValue:m.keyword,"onUpdate:modelValue":t[1]||(t[1]=e=>m.keyword=e),shape:"round",placeholder:"请输入客户名称搜索","show-action":"",onClear:u.reSearch,onSearch:u.reSearch,class:"search-input"},{action:Object(c["withCtx"])(()=>[m.curUserId?(Object(c["openBlock"])(),Object(c["createBlock"])(O,{key:0,title:"客户名称",value:m.curName,class:"user-id-cell"},{"right-icon":Object(c["withCtx"])(()=>[Object(c["createVNode"])(p,{type:"md-close",size:"25",onClick:u.deleteUserId,class:"vi-link-text ml-10"},null,8,["onClick"])]),_:1},8,["value"])):Object(c["createCommentVNode"])("",!0),Object(c["createVNode"])(p,{type:"ios-funnel-outline",size:"24",color:m.timeData.createTime||m.timeData.updateTime?"#2d8cf0":"#555",onClick:u.openMoreFilter},null,8,["color","onClick"])]),_:1},8,["modelValue","onClear","onSearch"]),Object(c["createVNode"])(C,{show:m.showMore,"onUpdate:show":t[4]||(t[4]=e=>m.showMore=e),title:"更多检索条件"},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(V,{modelValue:m.updateTime,"onUpdate:modelValue":t[2]||(t[2]=e=>m.updateTime=e),title:"修改时间"},null,8,["modelValue"]),Object(c["createVNode"])(V,{modelValue:m.createTime,"onUpdate:modelValue":t[3]||(t[3]=e=>m.createTime=e),title:"创建时间"},null,8,["modelValue"]),Object(c["createElementVNode"])("div",o,[Object(c["createVNode"])(v,{size:"large",long:"",shape:"circle",onClick:u.resetTime,class:"mr-10"},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])("重置")]),_:1},8,["onClick"]),Object(c["createVNode"])(v,{type:"primary",size:"large",long:"",shape:"circle",onClick:u.confirmSearch},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])("检索")]),_:1},8,["onClick"])])]),_:1},8,["show"]),Object(c["createVNode"])(N,{ref:"list",getData:u.getData,class:"container"},{default:Object(c["withCtx"])(({item:e})=>[Object(c["createElementVNode"])("div",{class:"card",onClick:t=>u.openDetail(e)},[Object(c["createElementVNode"])("p",l,"订单编号："+Object(c["toDisplayString"])(e.orderId),1),Object(c["createElementVNode"])("p",i,"客户名称："+Object(c["toDisplayString"])(e.userName),1),Object(c["createElementVNode"])("p",s,"总 金 额 ：￥"+Object(c["toDisplayString"])(e.total&&e.total.toFixed(2)),1),Object(c["createElementVNode"])("p",n,"修改时间："+Object(c["toDisplayString"])(e.updateTime),1)],8,r)]),_:1},8,["getData"]),Object(c["createVNode"])(k,{modelValue:m.showDetail,"onUpdate:modelValue":t[5]||(t[5]=e=>m.showDetail=e),detailData:m.detailData},null,8,["modelValue","detailData"])])}var m=a("3e47"),u=a("aad9"),b=a("eeb9"),h=a("2af9");const p={class:"detail-container"},O={class:"card-list"},j={class:"title"},V={class:"card-bottom"},v={key:0,class:"price origin"},C={class:"price"},N={key:1,class:"ml-5"},k={key:2,class:"standard"},g={class:"count"},D={class:"f-20"},w={class:"detail-footer"},f={class:"total"},y={class:"btn-box"};function T(e,t,a,o,r,l){const i=Object(c["resolveComponent"])("van-cell"),s=Object(c["resolveComponent"])("viEmpty"),n=Object(c["resolveComponent"])("Button"),d=Object(c["resolveComponent"])("van-action-sheet");return Object(c["openBlock"])(),Object(c["createBlock"])(d,{show:l.showModal,"onUpdate:show":t[0]||(t[0]=e=>l.showModal=e),title:"订单详情"},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(i,{title:"订单编号",value:a.detailData.orderId},null,8,["value"]),Object(c["createVNode"])(i,{title:"客户名称",value:a.detailData.userName},null,8,["value"]),Object(c["createElementVNode"])("div",p,[Object(c["createElementVNode"])("div",O,[a.detailData.list.length?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createBlock"])(s,{key:0})),(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(a.detailData.list,(e,t)=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",{class:"card",key:t},[Object(c["createElementVNode"])("p",j,Object(c["toDisplayString"])(e.name),1),Object(c["createElementVNode"])("div",V,[Object(c["createElementVNode"])("div",null,[e.price!=e.originPrice&&e.unit==e.originUnit&&e.standard==e.originStandard?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",v,"￥"+Object(c["toDisplayString"])(e.originPrice&&e.originPrice.toFixed(2)),1)):Object(c["createCommentVNode"])("",!0),Object(c["createElementVNode"])("span",C,"￥"+Object(c["toDisplayString"])(e.price&&e.price.toFixed(2)),1),e.unit?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",N,"/ "+Object(c["toDisplayString"])(e.unit),1)):Object(c["createCommentVNode"])("",!0),e.standard?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",k,Object(c["toDisplayString"])(e.standard),1)):Object(c["createCommentVNode"])("",!0)]),Object(c["createElementVNode"])("p",g,[Object(c["createTextVNode"])("X "),Object(c["createElementVNode"])("span",D,Object(c["toDisplayString"])(e.count),1)])])]))),128))])]),Object(c["createElementVNode"])("div",w,[Object(c["createElementVNode"])("p",f,"总金额：￥"+Object(c["toDisplayString"])(a.detailData.total),1),Object(c["createElementVNode"])("div",y,[Object(c["createVNode"])(n,{type:"primary",onClick:l.changeOrder,size:"large",long:"",shape:"circle",class:"ml-10"},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])("修改")]),_:1},8,["onClick"]),Object(c["createVNode"])(n,{type:"success",onClick:l.copyOrder,size:"large",long:"",shape:"circle",class:"ml-10"},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])("复制")]),_:1},8,["onClick"]),Object(c["createVNode"])(n,{type:"error",onClick:l.deleteOrder,size:"large",long:"",shape:"circle",class:"ml-10"},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])("删除")]),_:1},8,["onClick"])])])]),_:1},8,["show"])}a("14d9");var S={name:"mobileOrderDetail",props:{modelValue:{type:Boolean,default:!1},detailData:{type:Object,default(){return{}}}},computed:{showModal:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}},methods:{deleteOrder(){this.$Modal.confirm({title:"删除订单",content:"是否确认删除所选订单？",onOk:async()=>{try{const{returnCode:e,data:t}=await Object(b["b"])({orderIds:""+this.detailData.orderId})||{};0===e&&t&&(this.$Message.success("删除成功"),this.$EventBus.$emit("saveOrder"),this.showModal=!1)}catch(e){this.$Message.error("删除失败："+(e.message||e))}}})},changeOrder(){this.showModal=!1,this.$router.push({name:"mobileCashier",state:{params:{type:"change",userId:this.detailData.userId,goodList:this.detailData.detail,orderId:this.detailData.orderId}}})},copyOrder(){this.showModal=!1,this.$router.push({name:"mobileCashier",state:{params:{type:"copy",goodList:this.detailData.detail}}})}}},E=(a("c4c8"),a("6b0d")),x=a.n(E);const B=x()(S,[["render",T],["__scopeId","data-v-80dcde4a"]]);var I=B,M={name:"mobileOrder",components:{[m["a"].name]:m["a"],[u["a"].name]:u["a"],viListScroll:h["g"],viCalendar:h["a"],orderDetail:I},props:{draftCount:{type:Number,default:void 0}},data(){return{keyword:"",status:"1",timeData:{},createTime:[],updateTime:[],showMore:!1,curUserId:"",curName:"",showDetail:!1,detailData:{}}},watch:{draftCount(){this.reSearch()},$route:{deep:!0,immediate:!0,handler({name:e}){if("mobileOrder"!==e)return;const{params:t={}}=history.state;Object.keys(t).length&&(this.curUserId=t.userId,this.curName=t.name,this.keyword="",this.status="2",this.resetTime(),this.reSearch(),history.state.params={})}}},methods:{deleteUserId(){this.curUserId="",this.curName="",this.reSearch()},reSearch(){var e;null===(e=this.$refs.list)||void 0===e||e.reSearch()},getData(e){const{updateTime:t=[],createTime:a=[]}=this.timeData,[c,o]=t,[r,l]=a;return Object(b["l"])({...e,userId:this.curUserId,userName:this.keyword,status:this.status,updateTimeStart:c&&c+" 00:00:00",updateTimeEnd:o&&o+" 23:59:59",createTimeStart:r&&r+" 00:00:00",createTimeEnd:l&&l+" 23:59:59"})},openMoreFilter(){this.updateTime=this.timeData.updateTime||[],this.createTime=this.timeData.createTime||[],this.showMore=!0},resetTime(){this.updateTime=[],this.createTime=[]},confirmSearch(){this.timeData={updateTime:this.updateTime,createTime:this.createTime},this.showMore=!1,this.reSearch()},openDetail(e){this.detailData={...e,list:JSON.parse(e.detail||"[]"),total:e.total.toFixed(2)},this.showDetail=!0}},activated(){this.reSearch()}};a("dae7");const U=x()(M,[["render",d],["__scopeId","data-v-cdd467de"]]);t["default"]=U},"33ff":function(e,t,a){},"6ef3":function(e,t,a){},c4c8:function(e,t,a){"use strict";a("6ef3")},dae7:function(e,t,a){"use strict";a("33ff")}}]);
//# sourceMappingURL=chunk-35de3bd7.e5c92a6e.js.map