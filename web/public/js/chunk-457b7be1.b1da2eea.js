(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-457b7be1"],{"3c93":function(e,t,a){"use strict";a.r(t);var n=a("7a23"),c=a("23f9"),o=a("1fba"),r=a("e5f6"),l=a("8db7"),i=a("450f"),s=a("d7d5"),d=a("5913");const[u,b,j]=Object(o["a"])("pull-refresh"),O=50,f=["pulling","loosing","success"],v={disabled:Boolean,modelValue:Boolean,headHeight:Object(r["c"])(O),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:r["f"],successDuration:Object(r["c"])(500),animationDuration:Object(r["c"])(300)};var p=Object(n["defineComponent"])({name:u,props:v,emits:["change","refresh","update:modelValue"],setup(e,{emit:t,slots:a}){let c;const o=Object(n["ref"])(),r=Object(n["ref"])(),u=Object(i["useScrollParent"])(o),v=Object(n["reactive"])({status:"normal",distance:0,duration:0}),p=Object(s["a"])(),h=()=>{if(e.headHeight!==O)return{height:e.headHeight+"px"}},g=()=>"loading"!==v.status&&"success"!==v.status&&!e.disabled,m=t=>{const a=+(e.pullDistance||e.headHeight);return t>a&&(t=t<2*a?a+(t-a)/2:1.5*a+(t-2*a)/4),Math.round(t)},V=(a,n)=>{const c=+(e.pullDistance||e.headHeight);v.distance=a,v.status=n?"loading":0===a?"normal":a<c?"pulling":"loosing",t("change",{status:v.status,distance:a})},w=()=>{const{status:t}=v;return"normal"===t?"":e[t+"Text"]||j(t)},k=()=>{const{status:e,distance:t}=v;if(a[e])return a[e]({distance:t});const c=[];return f.includes(e)&&c.push(Object(n["createVNode"])("div",{class:b("text")},[w()])),"loading"===e&&c.push(Object(n["createVNode"])(d["a"],{class:b("loading")},{default:w})),c},x=()=>{v.status="success",setTimeout(()=>{V(0)},+e.successDuration)},S=e=>{c=0===Object(l["c"])(u.value),c&&(v.duration=0,p.start(e))},N=e=>{g()&&S(e)},y=e=>{if(g()){c||S(e);const{deltaY:t}=p;p.move(e),c&&t.value>=0&&p.isVertical()&&(Object(l["e"])(e),V(m(t.value)))}},B=()=>{c&&p.deltaY.value&&g()&&(v.duration=+e.animationDuration,"loosing"===v.status?(V(+e.headHeight,!0),t("update:modelValue",!0),Object(n["nextTick"])(()=>t("refresh"))):V(0))};return Object(n["watch"])(()=>e.modelValue,t=>{v.duration=+e.animationDuration,t?V(+e.headHeight,!0):a.success||e.successText?x():V(0,!1)}),Object(i["useEventListener"])("touchmove",y,{target:r}),()=>{var e;const t={transitionDuration:v.duration+"ms",transform:v.distance?`translate3d(0,${v.distance}px, 0)`:""};return Object(n["createVNode"])("div",{ref:o,class:b()},[Object(n["createVNode"])("div",{ref:r,class:b("track"),style:t,onTouchstartPassive:N,onTouchend:B,onTouchcancel:B},[Object(n["createVNode"])("div",{class:b("head"),style:h()},[k()]),null==(e=a.default)?void 0:e.call(a)])])}}});const h=Object(c["a"])(p);var g=a("5aa0");const[m,V]=Object(o["a"])("skeleton-title"),w={round:Boolean,titleWidth:r["f"]};var k=Object(n["defineComponent"])({name:m,props:w,setup(e){return()=>Object(n["createVNode"])("h3",{class:V([{round:e.round}]),style:{width:Object(g["b"])(e.titleWidth)}},null)}});const x=Object(c["a"])(k);var S=x;const[N,y]=Object(o["a"])("skeleton-avatar"),B={avatarSize:r["f"],avatarShape:Object(r["e"])("round")};var T=Object(n["defineComponent"])({name:N,props:B,setup(e){return()=>Object(n["createVNode"])("div",{class:y([e.avatarShape]),style:Object(g["f"])(e.avatarSize)},null)}});const C=Object(c["a"])(T);var D=C;const W="100%",z={round:Boolean,rowWidth:{type:r["f"],default:W}},[H,L]=Object(o["a"])("skeleton-paragraph");var P=Object(n["defineComponent"])({name:H,props:z,setup(e){return()=>Object(n["createVNode"])("div",{class:L([{round:e.round}]),style:{width:e.rowWidth}},null)}});const E=Object(c["a"])(P);var _=E;const[A,M]=Object(o["a"])("skeleton"),R="60%",U={row:Object(r["c"])(0),round:Boolean,title:Boolean,titleWidth:r["f"],avatar:Boolean,avatarSize:r["f"],avatarShape:Object(r["e"])("round"),loading:r["g"],animate:r["g"],rowWidth:{type:[Number,String,Array],default:W}};var F=Object(n["defineComponent"])({name:A,inheritAttrs:!1,props:U,setup(e,{slots:t,attrs:a}){const c=()=>{if(e.avatar)return Object(n["createVNode"])(D,{avatarShape:e.avatarShape,avatarSize:e.avatarSize},null)},o=()=>{if(e.title)return Object(n["createVNode"])(S,{round:e.round,titleWidth:e.titleWidth},null)},r=t=>{const{rowWidth:a}=e;return a===W&&t===+e.row-1?R:Array.isArray(a)?a[t]:a},l=()=>Array(+e.row).fill("").map((t,a)=>Object(n["createVNode"])(_,{key:a,round:e.round,rowWidth:Object(g["b"])(r(a))},null)),i=()=>t.template?t.template():Object(n["createVNode"])(n["Fragment"],null,[c(),Object(n["createVNode"])("div",{class:M("content")},[o(),l()])]);return()=>{var c;return e.loading?Object(n["createVNode"])("div",Object(n["mergeProps"])({class:M({animate:e.animate,round:e.round})},a),[i()]):null==(c=t.default)?void 0:c.call(t)}}});const I=Object(c["a"])(F);var $=a("af58");const J={key:0,class:"list"};var Y={__name:"index",props:{getData:{type:Function,default:()=>{}},isInitLoad:{type:Boolean,default:!0},cellSpacing:{type:Boolean,default:!0}},emits:["on-update"],setup(e,{expose:t,emit:a}){const c=e,o=Object(n["inject"])("$Message",()=>{}),r=Object(n["ref"])(!1);function l(e){r.value=0!=e.target.scrollTop}const i=Object(n["ref"])(!1),s=Object(n["ref"])(!1),d=Object(n["ref"])(!1),u=Object(n["ref"])(!1),b=Object(n["ref"])(!1),j=Object(n["ref"])([]),O=Object(n["ref"])(1);async function f(){if(!u.value)try{d.value=!0;const{returnCode:e,data:t}=await c.getData({curPage:O.value,pageSize:10})||{};0===e&&(a("on-update",{rows:t.rows,total:t.count||0}),Object(n["nextTick"])(()=>{j.value=[...j.value,...t.rows],O.value++,u.value=j.value.length>=t.count}))}catch(e){b.value=!0,o.error("加载失败："+(e.message||e))}finally{i.value=!1,s.value=!1,d.value=!1}}function v(){u.value=!1,i.value||(s.value=!0),d.value||(O.value=1,j.value=[],f())}function p(){i.value=!0,v()}return t({reSearch:v}),Object(n["onMounted"])(()=>{c.isInitLoad&&v()}),(t,a)=>{const c=Object(n["resolveComponent"])("viEmpty");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",null,[Object(n["createVNode"])(Object(n["unref"])(h),{modelValue:i.value,"onUpdate:modelValue":a[2]||(a[2]=e=>i.value=e),disabled:r.value,onRefresh:p,class:"viListScroll"},{default:Object(n["withCtx"])(()=>[s.value?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",J,[Object(n["createVNode"])(Object(n["unref"])(I),{title:"",row:3}),Object(n["createVNode"])(Object(n["unref"])(I),{title:"",row:3}),Object(n["createVNode"])(Object(n["unref"])(I),{title:"",row:3})])):Object(n["createCommentVNode"])("",!0),j.value.length||s.value?j.value.length?(Object(n["openBlock"])(),Object(n["createBlock"])(Object(n["unref"])($["a"]),{key:2,loading:d.value,"onUpdate:loading":a[0]||(a[0]=e=>d.value=e),finished:u.value,"finished-text":j.value.length?"没有更多了":"",error:b.value,"onUpdate:error":a[1]||(a[1]=e=>b.value=e),"error-text":"加载失败",onLoad:f,onScroll:l,class:Object(n["normalizeClass"])(["list",{"cell-spacing":e.cellSpacing}])},{default:Object(n["withCtx"])(()=>[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(j.value,(e,a)=>Object(n["renderSlot"])(t.$slots,"default",Object(n["normalizeProps"])(Object(n["guardReactiveProps"])({item:e,index:a})))),256))]),_:3},8,["loading","finished","finished-text","error","class"])):Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createBlock"])(c,{key:1}))]),_:3},8,["modelValue","disabled"])])}}},q=(a("b54c"),a("6b0d")),G=a.n(q);const K=G()(Y,[["__scopeId","data-v-3e34ff50"]]);t["default"]=K},a59c:function(e,t,a){},af58:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a("23f9"),c=a("7a23"),o=a("1fba"),r=a("e5f6"),l=a("8db7"),i=a("450f"),s=a("efd9"),d=a("be32"),u=a("5913");const[b,j,O]=Object(o["a"])("list"),f={error:Boolean,offset:Object(r["c"])(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:Object(r["e"])("down"),loadingText:String,finishedText:String,immediateCheck:r["g"]};var v=Object(c["defineComponent"])({name:b,props:f,emits:["load","update:error","update:loading"],setup(e,{emit:t,slots:a}){const n=Object(c["ref"])(e.loading),o=Object(c["ref"])(),r=Object(c["ref"])(),b=Object(d["b"])(),f=Object(i["useScrollParent"])(o),v=Object(c["computed"])(()=>e.scroller||f.value),p=()=>{Object(c["nextTick"])(()=>{if(n.value||e.finished||e.disabled||e.error||!1===(null==b?void 0:b.value))return;const{direction:a}=e,c=+e.offset,s=Object(i["useRect"])(v);if(!s.height||Object(l["d"])(o))return;let d=!1;const u=Object(i["useRect"])(r);d="up"===a?s.top-u.top<=c:u.bottom-s.bottom<=c,d&&(n.value=!0,t("update:loading",!0),t("load"))})},h=()=>{if(e.finished){const t=a.finished?a.finished():e.finishedText;if(t)return Object(c["createVNode"])("div",{class:j("finished-text")},[t])}},g=()=>{t("update:error",!1),p()},m=()=>{if(e.error){const t=a.error?a.error():e.errorText;if(t)return Object(c["createVNode"])("div",{role:"button",class:j("error-text"),tabindex:0,onClick:g},[t])}},V=()=>{if(n.value&&!e.finished&&!e.disabled)return Object(c["createVNode"])("div",{class:j("loading")},[a.loading?a.loading():Object(c["createVNode"])(u["a"],{class:j("loading-icon")},{default:()=>[e.loadingText||O("loading")]})])};return Object(c["watch"])(()=>[e.loading,e.finished,e.error],p),b&&Object(c["watch"])(b,e=>{e&&p()}),Object(c["onUpdated"])(()=>{n.value=e.loading}),Object(c["onMounted"])(()=>{e.immediateCheck&&p()}),Object(s["a"])({check:p}),Object(i["useEventListener"])("scroll",p,{target:v,passive:!0}),()=>{var t;const l=null==(t=a.default)?void 0:t.call(a),i=Object(c["createVNode"])("div",{ref:r,class:j("placeholder")},null);return Object(c["createVNode"])("div",{ref:o,role:"feed",class:j(),"aria-busy":n.value},["down"===e.direction?l:i,V(),h(),m(),"up"===e.direction?l:i])}}});const p=Object(n["a"])(v)},b54c:function(e,t,a){"use strict";a("a59c")},be32:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return o}));var n=a("7a23");const c=Symbol(),o=()=>Object(n["inject"])(c,null)}}]);