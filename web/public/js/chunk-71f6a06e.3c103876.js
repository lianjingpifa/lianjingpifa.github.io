(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-71f6a06e"],{"1f38":function(e,t,a){"use strict";var o=a("7a23");function n(e,t,a,n,r,l){const c=Object(o["resolveComponent"])("viInput"),i=Object(o["resolveComponent"])("FormItem"),d=Object(o["resolveComponent"])("viInputNumber"),s=Object(o["resolveComponent"])("Option"),u=Object(o["resolveComponent"])("Select"),b=Object(o["resolveComponent"])("Form"),f=Object(o["resolveComponent"])("Button"),m=Object(o["resolveComponent"])("Modal");return Object(o["openBlock"])(),Object(o["createBlock"])(m,{title:l.title,modelValue:l.showModal,"onUpdate:modelValue":t[8]||(t[8]=e=>l.showModal=e),width:400,"class-name":"vertical-center-modal"},{footer:Object(o["withCtx"])(()=>[Object(o["createVNode"])(f,{type:"text",onClick:t[7]||(t[7]=e=>l.showModal=!1)},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("取消")]),_:1}),Object(o["createVNode"])(f,{type:"primary",onClick:l.submit,loading:r.loading},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("确定")]),_:1},8,["onClick","loading"])]),default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(b,{ref:"form",model:r.formData,rules:r.rules,"label-width":60,onKeydown:Object(o["withKeys"])(l.submit,["enter"]),class:"plr"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(i,{label:"名称:",prop:"name"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(c,{modelValue:r.formData.name,"onUpdate:modelValue":t[0]||(t[0]=e=>r.formData.name=e)},null,8,["modelValue"])]),_:1}),Object(o["createVNode"])(i,{label:"规格:",prop:"standard"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(c,{modelValue:r.formData.standard,"onUpdate:modelValue":t[1]||(t[1]=e=>r.formData.standard=e)},null,8,["modelValue"])]),_:1}),Object(o["createVNode"])(i,{label:"单位:",prop:"unit"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(c,{modelValue:r.formData.unit,"onUpdate:modelValue":t[2]||(t[2]=e=>r.formData.unit=e)},null,8,["modelValue"])]),_:1}),Object(o["createVNode"])(i,{label:"单价:",prop:"price"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(d,{modelValue:r.formData.price,"onUpdate:modelValue":t[3]||(t[3]=e=>r.formData.price=e),min:0,step:.5},null,8,["modelValue"])]),_:1}),Object(o["createVNode"])(i,{label:"标签:",prop:"label"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(u,{modelValue:r.formData.label,"onUpdate:modelValue":t[4]||(t[4]=e=>r.formData.label=e),multiple:""},{default:Object(o["withCtx"])(()=>[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(r.dictMap.good,(e,t)=>(Object(o["openBlock"])(),Object(o["createBlock"])(s,{key:t,value:e.id},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(o["createVNode"])(i,{label:"仓库:",prop:"store"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(u,{modelValue:r.formData.store,"onUpdate:modelValue":t[5]||(t[5]=e=>r.formData.store=e),multiple:""},{default:Object(o["withCtx"])(()=>[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(r.dictMap.store,(e,t)=>(Object(o["openBlock"])(),Object(o["createBlock"])(s,{key:t,value:e.id},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a.showCount?(Object(o["openBlock"])(),Object(o["createBlock"])(i,{key:0,label:"数量:",prop:"count"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(d,{modelValue:r.formData.count,"onUpdate:modelValue":t[6]||(t[6]=e=>r.formData.count=e),integer:"",min:0},null,8,["modelValue"])]),_:1})):Object(o["createCommentVNode"])("",!0)]),_:1},8,["model","rules","onKeydown"])]),_:1},8,["title","modelValue"])}a("d9e2");var r=a("eeb9"),l=a("2410"),c=a.n(l),i=a("4360");const d=Object(i["a"])();var s={name:"addGoodModal",props:{modelValue:{type:Boolean,default:!1},detailData:{type:Object,default(){return{}}},showCount:{type:Boolean,default:!1}},data(){const e=async(e,t,a)=>{if(t&&this.detailData.name!==this.formData.name){const{data:e}=await Object(r["I"])({name:t})||{};if(e)return a(new Error("该商品名称已存在"))}a()};return{dictMap:d.dictMap,formData:{},rules:{name:[{required:!0,message:"请输入商品名称"},{validator:e,trigger:"blur"}]},loading:!1}},computed:{title(){return(this.detailData.goodId?"编辑":"新增")+"商品"},showModal:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e),e||this.$emit("close")}}},watch:{detailData:{deep:!0,handler(){this.$refs.form.resetFields(),this.formData=c()(this.detailData)}}},methods:{submit(){this.loading=!0,this.$refs.form.validate(async e=>{if(!e)return this.$Message.error("数据校验不通过"),void(this.loading=!1);try{const{_index:e,_rowKey:t,count:a,...o}=this.formData,{data:n}=await Object(r["C"])(o)||{};n&&(this.$Message.success(this.title+"成功"),this.$emit("save",{...this.formData}),this.$refs.form.resetFields(),this.showModal=!1)}catch(t){this.$Message.error("请求失败："+(t.message||t))}finally{this.loading=!1}})}}},u=a("6b0d"),b=a.n(u);const f=b()(s,[["render",n]]);t["a"]=f},2410:function(e,t,a){(function(t){var a=function(){"use strict";function e(e,t){return null!=t&&e instanceof t}var a,o,n;try{a=Map}catch(u){a=function(){}}try{o=Set}catch(u){o=function(){}}try{n=Promise}catch(u){n=function(){}}function r(l,c,i,d,u){"object"===typeof c&&(i=c.depth,d=c.prototype,u=c.includeNonEnumerable,c=c.circular);var b=[],f=[],m="undefined"!=typeof t;function p(l,i){if(null===l)return null;if(0===i)return l;var j,O;if("object"!=typeof l)return l;if(e(l,a))j=new a;else if(e(l,o))j=new o;else if(e(l,n))j=new n((function(e,t){l.then((function(t){e(p(t,i-1))}),(function(e){t(p(e,i-1))}))}));else if(r.__isArray(l))j=[];else if(r.__isRegExp(l))j=new RegExp(l.source,s(l)),l.lastIndex&&(j.lastIndex=l.lastIndex);else if(r.__isDate(l))j=new Date(l.getTime());else{if(m&&t.isBuffer(l))return j=t.allocUnsafe?t.allocUnsafe(l.length):new t(l.length),l.copy(j),j;e(l,Error)?j=Object.create(l):"undefined"==typeof d?(O=Object.getPrototypeOf(l),j=Object.create(O)):(j=Object.create(d),O=d)}if(c){var h=b.indexOf(l);if(-1!=h)return f[h];b.push(l),f.push(j)}for(var w in e(l,a)&&l.forEach((function(e,t){var a=p(t,i-1),o=p(e,i-1);j.set(a,o)})),e(l,o)&&l.forEach((function(e){var t=p(e,i-1);j.add(t)})),l){var g;O&&(g=Object.getOwnPropertyDescriptor(O,w)),g&&null==g.set||(j[w]=p(l[w],i-1))}if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(l);for(w=0;w<V.length;w++){var y=V[w],v=Object.getOwnPropertyDescriptor(l,y);(!v||v.enumerable||u)&&(j[y]=p(l[y],i-1),v.enumerable||Object.defineProperty(j,y,{enumerable:!1}))}}if(u){var D=Object.getOwnPropertyNames(l);for(w=0;w<D.length;w++){var C=D[w];v=Object.getOwnPropertyDescriptor(l,C);v&&v.enumerable||(j[C]=p(l[C],i-1),Object.defineProperty(j,C,{enumerable:!1}))}}return j}return"undefined"==typeof c&&(c=!0),"undefined"==typeof i&&(i=1/0),p(l,i)}function l(e){return Object.prototype.toString.call(e)}function c(e){return"object"===typeof e&&"[object Date]"===l(e)}function i(e){return"object"===typeof e&&"[object Array]"===l(e)}function d(e){return"object"===typeof e&&"[object RegExp]"===l(e)}function s(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return r.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},r.__objToStr=l,r.__isDate=c,r.__isArray=i,r.__isRegExp=d,r.__getRegExpFlags=s,r}();e.exports&&(e.exports=a)}).call(this,a("b639").Buffer)},"324a":function(e,t,a){"use strict";a.r(t);var o=a("7a23");const n={class:"plr"};function r(e,t,a,r,l,c){const i=Object(o["resolveComponent"])("Icon"),d=Object(o["resolveComponent"])("Spin"),s=Object(o["resolveComponent"])("vi-scan"),u=Object(o["resolveComponent"])("add-good-modal");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",n,[Object(o["createVNode"])(i,{type:"ios-add",size:"34",onClick:t[0]||(t[0]=e=>c.changeModal()),class:"vi-header-icon right"}),Object(o["createVNode"])(d,{fix:"",show:l.loading},null,8,["show"]),Object(o["createVNode"])(s,{ref:"scan","close-after-scan":"",onScan:c.onScan},null,8,["onScan"]),Object(o["createVNode"])(u,{modelValue:l.showGoodModal,"onUpdate:modelValue":t[1]||(t[1]=e=>l.showGoodModal=e),detailData:l.detailData,onSave:c.saveData},null,8,["modelValue","detailData","onSave"])])}var l=a("2af9"),c=a("1f38"),i=a("eeb9"),d={name:"mobileEnter",components:{viScan:l["k"],addGoodModal:c["a"]},data(){return{loading:!1,showGoodModal:!1,detailData:{}}},methods:{saveData(){this.$EventBus.$emit("saveGood"),this.$refs.scan.openScan()},async onScan(e){try{this.loading=!0;const{data:{code:t,msg:a,data:o}}=await Object(i["p"])(e)||{};1==t?this.detailData={name:o.goodsName,standard:o.standard,price:+o.price}:(this.detailData={},this.$Message.info(a+"\n免费接口查不到信息\n自己填吧")),this.showGoodModal=!0}catch(t){this.$Message.error("获取商品信息失败："+(t.message||t))}finally{this.loading=!1}},changeModal(e){this.detailData={...e},this.showGoodModal=!0}}},s=a("6b0d"),u=a.n(s);const b=u()(d,[["render",r]]);t["default"]=b}}]);