(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-49cb6119","chunk-112a79cb"],{"083a":function(e,t,a){"use strict";var o=a("0d51"),s=TypeError;e.exports=function(e,t){if(!delete e[t])throw s("Cannot delete property "+o(t)+" of "+o(e))}},"11de":function(e,t,a){"use strict";a("b4d3")},"16c8":function(e,t,a){"use strict";a("d743")},"16f7":function(e,t,a){"use strict";a.r(t);var o=a("7a23");const s={class:"mb-10"},c=["onClick"],l={key:1,class:"flex-cc"},r=["onClick"];function n(e,t,a,n,i,d){const u=Object(o["resolveComponent"])("viInput"),p=Object(o["resolveComponent"])("FormItem"),h=Object(o["resolveComponent"])("viInputNumber"),m=Object(o["resolveComponent"])("Button"),b=Object(o["resolveComponent"])("viSearchForm"),O=Object(o["resolveComponent"])("viTablePage"),j=Object(o["resolveComponent"])("viLayoutUpDown");return Object(o["openBlock"])(),Object(o["createBlock"])(j,null,{up:Object(o["withCtx"])(()=>[Object(o["createVNode"])(b,{modelValue:i.searchData,"onUpdate:modelValue":t[4]||(t[4]=e=>i.searchData=e),onSearch:d.reSearch},{extral:Object(o["withCtx"])(()=>[Object(o["createVNode"])(m,{type:"error",onClick:t[3]||(t[3]=e=>d.deleteData())},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("批量删除")]),_:1})]),default:Object(o["withCtx"])(()=>[a.curRow.userId?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createBlock"])(p,{key:0,label:"客户名称:",prop:"userName"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(u,{modelValue:i.searchData.userName,"onUpdate:modelValue":t[0]||(t[0]=e=>i.searchData.userName=e)},null,8,["modelValue"])]),_:1})),a.curRow.goodId?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createBlock"])(p,{key:1,label:"商品名称:",prop:"goodName"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(u,{modelValue:i.searchData.goodName,"onUpdate:modelValue":t[1]||(t[1]=e=>i.searchData.goodName=e)},null,8,["modelValue"])]),_:1})),Object(o["createElementVNode"])("div",s,[Object(o["createTextVNode"])(" 勾选数据批量调整： "),Object(o["createVNode"])(h,{modelValue:i.step,"onUpdate:modelValue":t[2]||(t[2]=e=>i.step=e),step:.5,onOnEnter:d.changeStep,class:"step-input"},null,8,["modelValue","onOnEnter"]),Object(o["createVNode"])(m,{type:"primary",onClick:d.changeStep,class:"ml-10"},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("确认")]),_:1},8,["onClick"])])]),_:1},8,["modelValue","onSearch"])]),down:Object(o["withCtx"])(()=>[Object(o["createVNode"])(O,{ref:"table",columns:d.columns,getData:d.getData,addSelect:"",addIndex:"",onOnSelectionChange:t[6]||(t[6]=e=>i.selected=e)},{special:Object(o["withCtx"])(({row:e,index:a})=>[i.changeIndex!=a?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",{key:0,class:"vi-link-pointer",onClick:e=>i.changeIndex=a}," ￥ "+Object(o["toDisplayString"])(e.specialPrice&&e.specialPrice.toFixed(2)),9,c)):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",l,[Object(o["createTextVNode"])(" ￥ "),Object(o["createVNode"])(h,{modelValue:e.specialPrice,"onUpdate:modelValue":t=>e.specialPrice=t,min:0,step:.5},null,8,["modelValue","onUpdate:modelValue"]),Object(o["createVNode"])(m,{onClick:t[5]||(t[5]=e=>i.changeIndex=-1)},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("取消")]),_:1}),Object(o["createVNode"])(m,{type:"primary",onClick:t=>d.changeData([e])},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("确认")]),_:2},1032,["onClick"])]))]),operate:Object(o["withCtx"])(({row:e})=>[Object(o["createElementVNode"])("a",{onClick:t=>d.deleteData([e]),class:"vi-red-pointer"},"删除",8,r)]),_:1},8,["columns","getData"])]),_:1})}var i=a("eeb9"),d={name:"specialMng",props:{curRow:{type:Object,default(){return{}}}},data(){return{searchData:{},selected:[],changeIndex:-1,step:0}},computed:{columns(){return[...this.curRow.userId?[]:[{title:"客户名称",key:"userName"}],...this.curRow.goodId?[]:[{title:"商品名称",key:"goodName"}],{title:"特价（点击修改）",slot:"special",width:300},{title:"操作",slot:"operate",width:150}]}},methods:{reSearch(){var e;null===(e=this.$refs.table)||void 0===e||e.changePage(1)},getData(e){return this.selected=[],this.changeIndex=-1,Object(i["u"])({...e,...this.searchData,...this.curRow})},changeStep(){if(!this.selected.length)return this.$Message.info("至少勾选一条数据");this.changeData(this.selected.map(e=>(e.specialPrice+=this.step,e)))},async changeData(e){try{const{returnCode:t,data:a}=await Object(i["J"])({list:e})||{};0===t&&a&&(this.$Message.success("保存成功"),this.$refs.table.changePage(1))}catch(t){this.$Message.error("保存失败："+(t.message||t))}},deleteData(e=this.selected){if(!e.length)return this.$Message.info("至少选中一项");this.$Modal.confirm({title:"删除特价",content:"是否确认删除所选特价？",onOk:async()=>{try{const{returnCode:t,data:a}=await Object(i["h"])({list:e.map(e=>({userId:e.userId,goodId:e.goodId}))})||{};0===t&&a&&(this.$Message.success("删除成功"),this.$refs.table.changePage(1))}catch(t){this.$Message.error("删除失败："+(t.message||t))}}})}},activated(){this.reSearch()}},u=(a("16c8"),a("6b0d")),p=a.n(u);const h=p()(d,[["render",n],["__scopeId","data-v-ea0a46c2"]]);t["default"]=h},"3c65":function(e,t,a){"use strict";var o=a("23e7"),s=a("7b0b"),c=a("07fa"),l=a("3a34"),r=a("083a"),n=a("3511"),i=1!==[].unshift(0),d=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(e){return e instanceof TypeError}},u=i||!d();o({target:"Array",proto:!0,arity:1,forced:u},{unshift:function(e){var t=s(this),a=c(t),o=arguments.length;if(o){n(a+o);var i=a;while(i--){var d=i+o;i in t?t[d]=t[i]:r(t,d)}for(var u=0;u<o;u++)t[u]=arguments[u]}return l(t,a+o)}})},"42d7":function(e,t,a){"use strict";a("8875")},"5d2e":function(e,t,a){},6873:function(e,t,a){"use strict";a("aa56")},7281:function(e,t,a){},"7e0a":function(e,t,a){"use strict";a.r(t);var o=a("7a23");const s=["onClick"],c=["onClick"],l=["onClick"];function r(e,t,a,r,n,i){const d=Object(o["resolveComponent"])("viInput"),u=Object(o["resolveComponent"])("FormItem"),p=Object(o["resolveComponent"])("Option"),h=Object(o["resolveComponent"])("viSelect"),m=Object(o["resolveComponent"])("DatePicker"),b=Object(o["resolveComponent"])("Button"),O=Object(o["resolveComponent"])("viSearchForm"),j=Object(o["resolveComponent"])("viTablePage"),f=Object(o["resolveComponent"])("viPrintContent"),g=Object(o["resolveComponent"])("Modal"),w=Object(o["resolveComponent"])("viLayoutUpDown");return Object(o["openBlock"])(),Object(o["createBlock"])(w,null,{up:Object(o["withCtx"])(()=>[Object(o["createVNode"])(O,{modelValue:n.searchData,"onUpdate:modelValue":t[5]||(t[5]=e=>n.searchData=e),onSearch:i.reSearch},{extral:Object(o["withCtx"])(()=>[Object(o["createVNode"])(b,{type:"error",onClick:t[4]||(t[4]=e=>i.deleteData())},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("批量删除")]),_:1})]),default:Object(o["withCtx"])(()=>[a.curRow.userId?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createBlock"])(u,{key:0,label:"客户名称:",prop:"userName"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(d,{modelValue:n.searchData.userName,"onUpdate:modelValue":t[0]||(t[0]=e=>n.searchData.userName=e),class:"vi-width"},null,8,["modelValue"])]),_:1})),Object(o["createVNode"])(u,{label:"订单状态:",prop:"status"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(h,{modelValue:n.searchData.status,"onUpdate:modelValue":t[1]||(t[1]=e=>n.searchData.status=e),class:"vi-width"},{default:Object(o["withCtx"])(()=>[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(n.orderStatusMap,(e,t)=>(Object(o["openBlock"])(),Object(o["createBlock"])(p,{key:t,value:t},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(o["createVNode"])(u,{label:"修改时间:",prop:"updateTime"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(m,{modelValue:n.searchData.updateTime,"onUpdate:modelValue":t[2]||(t[2]=e=>n.searchData.updateTime=e),type:"daterange",options:n.options,placeholder:"请选择",class:"vi-width"},null,8,["modelValue","options"])]),_:1}),Object(o["createVNode"])(u,{label:"创建时间:",prop:"createTime"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(m,{modelValue:n.searchData.createTime,"onUpdate:modelValue":t[3]||(t[3]=e=>n.searchData.createTime=e),type:"daterange",options:n.options,placeholder:"请选择",class:"vi-width"},null,8,["modelValue","options"])]),_:1})]),_:1},8,["modelValue","onSearch"])]),down:Object(o["withCtx"])(()=>[Object(o["createVNode"])(j,{ref:"table",columns:i.columns,getData:i.getData,addSelect:"",addIndex:"",onOnSelectionChange:t[6]||(t[6]=e=>n.selected=e)},{operate:Object(o["withCtx"])(({row:e})=>[Object(o["createElementVNode"])("a",{onClick:t=>i.changeOrder(e)},"修改",8,s),Object(o["createElementVNode"])("a",{onClick:t=>i.deleteData([e]),class:"vi-red-pointer"},"删除",8,c),Object(o["createElementVNode"])("a",{onClick:t=>i.copyOrder(e),class:"vi-green-pointer"},"一键复制",8,l)]),_:1},8,["columns","getData"]),Object(o["createVNode"])(g,{title:"订单详情",modelValue:n.showDetail,"onUpdate:modelValue":t[11]||(t[11]=e=>n.showDetail=e),width:880,"class-name":"vertical-center-modal"},{footer:Object(o["withCtx"])(()=>[Object(o["createVNode"])(b,{onClick:t[7]||(t[7]=e=>n.showDetail=!1)},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("取消")]),_:1}),Object(o["createVNode"])(b,{type:"primary",onClick:t[8]||(t[8]=e=>i.changeOrder(n.detailData))},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("去修改")]),_:1}),Object(o["createVNode"])(b,{type:"primary",onClick:t[9]||(t[9]=e=>i.copyOrder(n.detailData))},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("一键复制")]),_:1}),Object(o["createVNode"])(b,{type:"error",onClick:t[10]||(t[10]=e=>i.deleteData([n.detailData]))},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("删除")]),_:1})]),default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(f,{list:n.detailData.list,total:n.detailData.total,class:"order-detail"},null,8,["list","total"])]),_:1},8,["modelValue"])]),_:1})}var n=a("8738"),i=(a("14d9"),a("eeb9")),d=a("2af9"),u=a("267e"),p={name:"orderMng",components:{DatePicker:n["a"],viPrintContent:d["j"]},props:{curRow:{type:Object,default(){return{}}}},data(){return{orderStatusMap:u["a"],searchData:{},selected:[],options:{shortcuts:[{text:"今天",value:()=>[new Date,new Date]},{text:"近2天",value:()=>[(new Date).subtract(1),new Date]},{text:"近3天",value:()=>[(new Date).subtract(2),new Date]},{text:"近一周",value:()=>[(new Date).subtract(7),new Date]}]},showDetail:!1,detailData:{}}},computed:{columns(){return[{title:"订单编号",minWidth:130,render:(e,{row:t})=>e("span",{class:"vi-link-pointer",onClick:()=>{this.detailData={...t,list:JSON.parse(t.detail||"[]"),total:t.total.toFixed(2)},this.showDetail=!0}},t.orderId)},...this.curRow.userId?[]:[{title:"客户名称",key:"userName",minWidth:150}],{title:"订单状态",width:80,render:(e,{row:t})=>e("span",u["a"][t.status]||"-")},{title:"总金额",minWidth:90,render:(e,{row:t})=>e("span","￥"+t.total.toFixed(2))},{title:"修改时间",key:"updateTime",minWidth:90},{title:"创建时间",key:"createTime",minWidth:90},{title:"操作",slot:"operate",minWidth:100}]}},methods:{reSearch(){var e;null===(e=this.$refs.table)||void 0===e||e.changePage(1)},getData(e){this.selected=[];const{updateTime:t=[],createTime:a=[],...o}=this.searchData;return Object(i["t"])({...e,...o,updateTimeStart:t[0]&&new Date(t[0]).startOf("day").format("YYYY-MM-DD HH:mm:ss"),updateTimeEnd:t[1]&&new Date(t[1]).endOf("day").format("YYYY-MM-DD HH:mm:ss"),createTimeStart:a[0]&&new Date(a[0]).startOf("day").format("YYYY-MM-DD HH:mm:ss"),createTimeEnd:a[1]&&new Date(a[1]).endOf("day").format("YYYY-MM-DD HH:mm:ss"),...this.curRow})},changeOrder(e){this.showDetail=!1,this.$emit("close"),this.$router.push({name:"cashierMng",state:{params:{type:"change",userId:e.userId,goodList:e.detail,orderId:e.orderId}}})},copyOrder(e){this.showDetail=!1,this.$emit("close"),this.$router.push({name:"cashierMng",state:{params:{type:"copy",goodList:e.detail}}})},deleteData(e=this.selected){if(!e.length)return this.$Message.info("至少选中一项");this.$Modal.confirm({title:"删除订单",content:"是否确认删除所选订单？",onOk:async()=>{try{const{returnCode:t,data:a}=await Object(i["g"])({orderIds:e.map(e=>e.orderId).join()})||{};0===t&&a&&(this.$Message.success("删除成功"),this.$refs.table.changePage(1),this.$EventBus.$emit("saveOrder"))}catch(t){this.$Message.error("删除失败："+(t.message||t))}}})}},activated(){this.reSearch()}},h=(a("6873"),a("6b0d")),m=a.n(h);const b=m()(p,[["render",r],["__scopeId","data-v-2eb41203"]]);t["default"]=b},"7f90":function(e,t,a){"use strict";a("8afa")},8451:function(e,t,a){"use strict";var o=a("ca5c");t["a"]=o["a"]},8875:function(e,t,a){},"8afa":function(e,t,a){},"9bb2":function(e,t,a){"use strict";a("c1f3")},a458:function(e,t,a){"use strict";a("5d2e")},a9f5:function(e,t,a){"use strict";a("7281")},aa56:function(e,t,a){},b4d3:function(e,t,a){},c1f3:function(e,t,a){},ca5c:function(e,t,a){"use strict";var o=a("7a23");const s=["disabled","value","name"],c=["disabled","checked","name"],l={key:0,class:"ivu-checkbox-label-text"};function r(e,t,a,r,n,i){return Object(o["openBlock"])(),Object(o["createElementBlock"])("label",{class:Object(o["normalizeClass"])(i.wrapClasses)},[Object(o["createElementVNode"])("span",{class:Object(o["normalizeClass"])(i.checkboxClasses)},[Object(o["createElementVNode"])("span",{class:Object(o["normalizeClass"])(i.innerClasses)},null,2),i.group?Object(o["withDirectives"])((Object(o["openBlock"])(),Object(o["createElementBlock"])("input",{key:0,type:"checkbox",class:Object(o["normalizeClass"])(i.inputClasses),disabled:e.itemDisabled,value:a.label,"onUpdate:modelValue":t[0]||(t[0]=e=>n.model=e),name:a.name,onChange:t[1]||(t[1]=(...e)=>i.change&&i.change(...e)),onFocus:t[2]||(t[2]=(...e)=>i.onFocus&&i.onFocus(...e)),onBlur:t[3]||(t[3]=(...e)=>i.onBlur&&i.onBlur(...e))},null,42,s)),[[o["vModelCheckbox"],n.model]]):(Object(o["openBlock"])(),Object(o["createElementBlock"])("input",{key:1,type:"checkbox",class:Object(o["normalizeClass"])(i.inputClasses),disabled:e.itemDisabled,checked:i.currentValue,name:a.name,onChange:t[4]||(t[4]=(...e)=>i.change&&i.change(...e)),onFocus:t[5]||(t[5]=(...e)=>i.onFocus&&i.onFocus(...e)),onBlur:t[6]||(t[6]=(...e)=>i.onBlur&&i.onBlur(...e))},null,42,c))],2),n.showSlot?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",l,[Object(o["renderSlot"])(e.$slots,"default",{},()=>[Object(o["createTextVNode"])(Object(o["toDisplayString"])(a.label),1)])])):Object(o["createCommentVNode"])("",!0)],2)}var n=a("694c"),i=a("9836");const d="ivu-checkbox";var u={name:"Checkbox",mixins:[i["a"]],emits:["update:modelValue","on-change"],inject:{CheckboxGroupInstance:{default:null}},props:{disabled:{type:Boolean,default:!1},modelValue:{type:[String,Number,Boolean],default:!1},trueValue:{type:[String,Number,Boolean],default:!0},falseValue:{type:[String,Number,Boolean],default:!1},label:{type:[String,Number,Boolean]},indeterminate:{type:Boolean,default:!1},size:{validator(e){return Object(n["h"])(e,["small","large","default"])},default(){const e=Object(o["getCurrentInstance"])().appContext.config.globalProperties;return e.$VIEWUI&&""!==e.$VIEWUI.size?e.$VIEWUI.size:"default"}},name:{type:String},border:{type:Boolean,default:!1}},data(){return{showSlot:!0,focusInner:!1,model:[]}},computed:{wrapClasses(){return[d+"-wrapper",{[d+"-group-item"]:this.group,[d+"-wrapper-checked"]:this.currentValue,[d+"-wrapper-disabled"]:this.itemDisabled,[`${d}-${this.size}`]:!!this.size,[d+"-border"]:this.border}]},checkboxClasses(){return[""+d,{[d+"-checked"]:this.currentValue,[d+"-disabled"]:this.itemDisabled,[d+"-indeterminate"]:this.indeterminate}]},innerClasses(){return[d+"-inner",{[d+"-focus"]:this.focusInner}]},inputClasses(){return d+"-input"},currentValue(){return this.CheckboxGroupInstance?this.CheckboxGroupInstance.modelValue.indexOf(this.label)>=0:this.modelValue===this.trueValue},group(){return!!this.CheckboxGroupInstance}},mounted(){this.CheckboxGroupInstance||(this.showSlot=void 0!==this.$slots.default)},methods:{change(e){if(this.itemDisabled)return!1;const t=e.target.checked,a=t?this.trueValue:this.falseValue;this.$emit("update:modelValue",a),this.group?this.CheckboxGroupInstance.change(this.model):(this.$emit("on-change",a),this.handleFormItemChange("change",a))},onBlur(){this.focusInner=!1},onFocus(){this.focusInner=!0}},watch:{modelValue(e){if(e!==this.trueValue&&e!==this.falseValue)throw"Value should be trueValue or falseValue."},"CheckboxGroupInstance.modelValue":{handler(e){this.model=e||[]},immediate:!0}}},p=a("6b0d"),h=a.n(p);const m=h()(u,[["render",r]]);t["a"]=m},d743:function(e,t,a){},e903:function(e,t,a){"use strict";var o=a("7a23");const s={key:0,class:"specialMng"};function c(e,t,a,c,l,r){const n=Object(o["resolveComponent"])("specialMng"),i=Object(o["resolveComponent"])("Modal",!0);return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",null,[Object(o["createVNode"])(i,{title:a.curRow.name+"-特价",modelValue:r.showModal,"onUpdate:modelValue":t[1]||(t[1]=e=>r.showModal=e),width:"800",class:"specialMngModal"},{default:Object(o["withCtx"])(()=>[r.showModal?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",s,[Object(o["createVNode"])(n,{curRow:a.curRow,onClose:t[0]||(t[0]=e=>r.showModal=!1)},null,8,["curRow"])])):Object(o["createCommentVNode"])("",!0)]),_:1},8,["title","modelValue"])])}var l=a("16f7"),r={name:"specialMngModal",components:{specialMng:l["default"]},props:{modelValue:{type:Boolean,default:!1},curRow:{type:Object,default(){return{}}}},computed:{showModal:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}}},n=(a("9bb2"),a("11de"),a("6b0d")),i=a.n(n);const d=i()(r,[["render",c],["__scopeId","data-v-4f5c0f34"]]);t["a"]=d},ec16:function(e,t,a){"use strict";var o=a("7a23");const s=["multiple","webkitdirectory","accept"];function c(e,t,a,c,l,r){const n=Object(o["resolveComponent"])("upload-list");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",{class:Object(o["normalizeClass"])([l.prefixCls])},[Object(o["createElementVNode"])("div",{class:Object(o["normalizeClass"])(r.classes),onClick:t[1]||(t[1]=(...e)=>r.handleClick&&r.handleClick(...e)),onDrop:t[2]||(t[2]=Object(o["withModifiers"])((...e)=>r.onDrop&&r.onDrop(...e),["prevent"])),onPaste:t[3]||(t[3]=(...e)=>r.handlePaste&&r.handlePaste(...e)),onDragover:t[4]||(t[4]=Object(o["withModifiers"])(e=>l.dragOver=!0,["prevent"])),onDragleave:t[5]||(t[5]=Object(o["withModifiers"])(e=>l.dragOver=!1,["prevent"]))},[Object(o["createElementVNode"])("input",{ref:"input",type:"file",class:Object(o["normalizeClass"])([l.prefixCls+"-input"]),onChange:t[0]||(t[0]=(...e)=>r.handleChange&&r.handleChange(...e)),multiple:a.multiple,webkitdirectory:a.webkitdirectory,accept:a.accept},null,42,s),Object(o["renderSlot"])(e.$slots,"default")],34),Object(o["renderSlot"])(e.$slots,"tip"),a.showUploadList?(Object(o["openBlock"])(),Object(o["createBlock"])(n,{key:0,files:l.fileList,onOnFileRemove:r.handleRemove,onOnFilePreview:r.handlePreview},null,8,["files","onOnFileRemove","onOnFilePreview"])):Object(o["createCommentVNode"])("",!0)],2)}a("14d9");const l=["onClick"],r=["onClick"];function n(e,t,a,s,c,n){const i=Object(o["resolveComponent"])("Icon"),d=Object(o["resolveComponent"])("i-progress");return Object(o["openBlock"])(),Object(o["createElementBlock"])("ul",{class:Object(o["normalizeClass"])([c.prefixCls+"-list"])},[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(a.files,(e,t)=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("li",{key:t,class:Object(o["normalizeClass"])(n.fileCls(e)),onClick:t=>n.handleClick(e)},[Object(o["createElementVNode"])("span",{onClick:t=>n.handlePreview(e)},[Object(o["createVNode"])(i,{type:n.format(e)},null,8,["type"]),Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.name),1)],8,r),Object(o["withDirectives"])(Object(o["createVNode"])(i,{type:"ios-close",class:Object(o["normalizeClass"])([c.prefixCls+"-list-remove"]),onClick:t=>n.handleRemove(e)},null,8,["class","onClick"]),[[o["vShow"],"finished"===e.status]]),Object(o["createVNode"])(o["Transition"],{name:"fade"},{default:Object(o["withCtx"])(()=>[e.showProgress?(Object(o["openBlock"])(),Object(o["createBlock"])(d,{key:0,"stroke-width":2,percent:n.parsePercentage(e.percentage),status:"finished"===e.status&&e.showProgress?"success":"normal"},null,8,["percent","status"])):Object(o["createCommentVNode"])("",!0)]),_:2},1024)],10,l))),128))],2)}var i=a("2628");const d={key:0,class:"ivu-progress-inner-text"};function u(e,t,a,s,c,l){const r=Object(o["resolveComponent"])("Icon");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",{class:Object(o["normalizeClass"])(l.wrapClasses)},[Object(o["createElementVNode"])("div",{class:Object(o["normalizeClass"])(l.outerClasses)},[Object(o["createElementVNode"])("div",{class:Object(o["normalizeClass"])(l.innerClasses)},[Object(o["createElementVNode"])("div",{class:Object(o["normalizeClass"])(l.bgClasses),style:Object(o["normalizeStyle"])(l.bgStyle)},[a.textInside?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",d,Object(o["toDisplayString"])(a.percent)+"%",1)):Object(o["createCommentVNode"])("",!0)],6),Object(o["createElementVNode"])("div",{class:Object(o["normalizeClass"])(l.successBgClasses),style:Object(o["normalizeStyle"])(l.successBgStyle)},null,6)],2)],2),a.hideInfo||a.textInside?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",{key:0,class:Object(o["normalizeClass"])(l.textClasses)},[Object(o["renderSlot"])(e.$slots,"default",{},()=>[l.isStatus?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",{key:0,class:Object(o["normalizeClass"])(l.textInnerClasses)},[Object(o["createVNode"])(r,{type:l.statusIcon},null,8,["type"])],2)):(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",{key:1,class:Object(o["normalizeClass"])(l.textInnerClasses)},Object(o["toDisplayString"])(a.percent)+"% ",3))])],2))],2)}var p=a("456c"),h=a("694c");const m="ivu-progress";var b={name:"Progress",components:{Icon:p["a"]},props:{percent:{type:Number,default:0},successPercent:{type:Number,default:0},status:{validator(e){return Object(h["h"])(e,["normal","active","wrong","success"])},default:"normal"},hideInfo:{type:Boolean,default:!1},strokeWidth:{type:Number,default:10},vertical:{type:Boolean,default:!1},strokeColor:{type:[String,Array]},textInside:{type:Boolean,default:!1}},data(){return{currentStatus:this.status}},computed:{isStatus(){return"wrong"===this.currentStatus||"success"===this.currentStatus},statusIcon(){let e="";switch(this.currentStatus){case"wrong":e="ios-close-circle";break;case"success":e="ios-checkmark-circle";break}return e},bgStyle(){const e=this.vertical?{height:this.percent+"%",width:this.strokeWidth+"px"}:{width:this.percent+"%",height:this.strokeWidth+"px"};return this.strokeColor&&("string"===typeof this.strokeColor?e["background-color"]=this.strokeColor:e["background-image"]=`linear-gradient(to right, ${this.strokeColor[0]} 0%, ${this.strokeColor[1]} 100%)`),e},successBgStyle(){return this.vertical?{height:this.successPercent+"%",width:this.strokeWidth+"px"}:{width:this.successPercent+"%",height:this.strokeWidth+"px"}},wrapClasses(){return[""+m,`${m}-${this.currentStatus}`,{[m+"-show-info"]:!this.hideInfo&&!this.textInside,[m+"-vertical"]:this.vertical}]},textClasses(){return m+"-text"},textInnerClasses(){return m+"-text-inner"},outerClasses(){return m+"-outer"},innerClasses(){return m+"-inner"},bgClasses(){return m+"-bg"},successBgClasses(){return m+"-success-bg"}},created(){this.handleStatus()},methods:{handleStatus(e){e?(this.currentStatus="normal",this.$emit("on-status-change","normal")):100===parseInt(this.percent,10)&&(this.currentStatus="success",this.$emit("on-status-change","success"))}},watch:{percent(e,t){e<t?this.handleStatus(!0):this.handleStatus()},status(e){this.currentStatus=e}}},O=a("6b0d"),j=a.n(O);const f=j()(b,[["render",u]]);var g=f;const w="ivu-upload";var C={name:"UploadList",components:{Icon:i["a"],iProgress:g},emits:["on-file-click","on-file-preview","on-file-remove"],props:{files:{type:Array,default(){return[]}}},data(){return{prefixCls:w}},methods:{fileCls(e){return[w+"-list-file",{[w+"-list-file-finish"]:"finished"===e.status}]},handleClick(e){this.$emit("on-file-click",e)},handlePreview(e){this.$emit("on-file-preview",e)},handleRemove(e){this.$emit("on-file-remove",e)},format(e){const t=e.name.split(".").pop().toLocaleLowerCase()||"";let a="ios-document-outline";return["gif","jpg","jpeg","png","bmp","webp"].indexOf(t)>-1&&(a="ios-image"),["mp4","m3u8","rmvb","avi","swf","3gp","mkv","flv"].indexOf(t)>-1&&(a="ios-film"),["mp3","wav","wma","ogg","aac","flac"].indexOf(t)>-1&&(a="ios-musical-notes"),["doc","txt","docx","pages","epub","pdf"].indexOf(t)>-1&&(a="md-document"),["numbers","csv","xls","xlsx"].indexOf(t)>-1&&(a="ios-stats"),["keynote","ppt","pptx"].indexOf(t)>-1&&(a="ios-videocam"),a},parsePercentage(e){return parseInt(e,10)}}};const k=j()(C,[["render",n]]);var v=k;function V(e,t,a){const o=`fail to post ${e} ${a.status}'`,s=new Error(o);return s.status=a.status,s.method="post",s.url=e,s}function x(e){const t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch(a){return t}}function y(e){if("undefined"===typeof XMLHttpRequest)return;const t=new XMLHttpRequest,a=e.action;t.upload&&(t.upload.onprogress=function(t){t.total>0&&(t.percent=t.loaded/t.total*100),e.onProgress(t)});const o=new FormData;e.data&&Object.keys(e.data).map(t=>{o.append(t,e.data[t])}),o.append(e.filename,e.file),t.onerror=function(t){e.onError(t)},t.onload=function(){if(t.status<200||t.status>=300)return e.onError(V(a,e,t),x(t));e.onSuccess(x(t))},t.open("post",a,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);const s=e.headers||{};for(let c in s)s.hasOwnProperty(c)&&null!==s[c]&&t.setRequestHeader(c,s[c]);t.send(o)}var D=a("9836");const M="ivu-upload";var N={name:"Upload",mixins:[D["a"]],components:{UploadList:v},props:{action:{type:String,required:!0},headers:{type:Object,default(){return{}}},multiple:{type:Boolean,default:!1},data:{type:Object},name:{type:String,default:"file"},withCredentials:{type:Boolean,default:!1},showUploadList:{type:Boolean,default:!0},type:{type:String,validator(e){return Object(h["h"])(e,["select","drag"])},default:"select"},format:{type:Array,default(){return[]}},accept:{type:String},maxSize:{type:Number},beforeUpload:Function,onProgress:{type:Function,default(){return{}}},onSuccess:{type:Function,default(){return{}}},onError:{type:Function,default(){return{}}},onRemove:{type:Function,default(){return{}}},onPreview:{type:Function,default(){return{}}},onExceededSize:{type:Function,default(){return{}}},onFormatError:{type:Function,default(){return{}}},defaultFileList:{type:Array,default(){return[]}},paste:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},webkitdirectory:{type:Boolean,default:!1}},data(){return{prefixCls:M,dragOver:!1,fileList:[],tempIndex:1}},computed:{classes(){return[""+M,{[M+"-select"]:"select"===this.type,[M+"-drag"]:"drag"===this.type,[M+"-dragOver"]:"drag"===this.type&&this.dragOver}]}},methods:{handleClick(){this.itemDisabled||this.$refs.input.click()},handleChange(e){const t=e.target.files;t&&(this.uploadFiles(t),this.$refs.input.value=null)},onDrop(e){this.dragOver=!1,this.itemDisabled||this.uploadFiles(e.dataTransfer.files)},handlePaste(e){this.itemDisabled||this.paste&&this.uploadFiles(e.clipboardData.files)},uploadFiles(e){let t=Array.prototype.slice.call(e);this.multiple||(t=t.slice(0,1)),0!==t.length&&t.forEach(e=>{this.upload(e)})},upload(e){if(!this.beforeUpload)return this.post(e);const t=this.beforeUpload(e);t&&t.then?t.then(t=>{"[object File]"===Object.prototype.toString.call(t)?this.post(t):this.post(e)},()=>{}):!1!==t&&this.post(e)},post(e){if(this.format.length){const t=e.name.split(".").pop().toLocaleLowerCase(),a=this.format.some(e=>e.toLocaleLowerCase()===t);if(!a)return this.onFormatError(e,this.fileList),!1}if(this.maxSize&&e.size>1024*this.maxSize)return this.onExceededSize(e,this.fileList),!1;this.handleStart(e);let t=new FormData;t.append(this.name,e),y({headers:this.headers,withCredentials:this.withCredentials,file:e,data:this.data,filename:this.name,action:this.action,onProgress:t=>{this.handleProgress(t,e)},onSuccess:t=>{this.handleSuccess(t,e)},onError:(t,a)=>{this.handleError(t,a,e)}})},handleStart(e){e.uid=Date.now()+this.tempIndex++;const t={status:"uploading",name:e.name,size:e.size,percentage:0,uid:e.uid,showProgress:!0};this.fileList.push(t)},getFile(e){const t=this.fileList;let a;return t.every(t=>(a=e.uid===t.uid?t:null,!a)),a},handleProgress(e,t){const a=this.getFile(t);this.onProgress(e,a,this.fileList),a.percentage=e.percent||0},handleSuccess(e,t){const a=this.getFile(t);a&&(a.status="finished",a.response=e,this.onSuccess(e,a,this.fileList),this.handleFormItemChange("change",a),setTimeout(()=>{a.showProgress=!1},1e3))},handleError(e,t,a){const o=this.getFile(a),s=this.fileList;o.status="fail",s.splice(s.indexOf(o),1),this.onError(e,t,a)},handleRemove(e){const t=this.fileList;t.splice(t.indexOf(e),1),this.onRemove(e,t)},handlePreview(e){"finished"===e.status&&this.onPreview(e)},clearFiles(){this.fileList=[]}},watch:{defaultFileList:{immediate:!0,handler(e){this.fileList=e.map(e=>(e.status="finished",e.percentage=100,e.uid=Date.now()+this.tempIndex++,e))}}}};const B=j()(N,[["render",c]]);var S=B;t["a"]=S},f642:function(e,t,a){"use strict";a.r(t);var o=a("7a23"),s=a("b116"),c=a.n(s);const l=["onClick"],r={key:1},n=["onClick"],i=["onClick"],d=["onClick"],u=["onClick"],p=["onClick"],h={key:1,class:"users-map"};function m(e,t,a,s,m,b){const O=Object(o["resolveComponent"])("viInput"),j=Object(o["resolveComponent"])("FormItem"),f=Object(o["resolveComponent"])("Option"),g=Object(o["resolveComponent"])("viSelect"),w=Object(o["resolveComponent"])("Button"),C=Object(o["resolveComponent"])("viSearchForm"),k=Object(o["resolveComponent"])("viTablePage"),v=Object(o["resolveComponent"])("viLayoutUpDown"),V=Object(o["resolveComponent"])("allUsersMap"),x=Object(o["resolveComponent"])("add-user-modal"),y=Object(o["resolveComponent"])("orderMngModal"),D=Object(o["resolveComponent"])("specialMngModal"),M=Object(o["resolveComponent"])("template-import-users"),N=Object(o["resolveComponent"])("single-user-map"),B=Object(o["resolveComponent"])("audit-user-modal");return Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],null,[m.isMapMode?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",h,[Object(o["createVNode"])(V,{ref:"userMap",onChangeUser:b.changeModal,onDeleteUser:t[10]||(t[10]=e=>b.deleteData([e])),onOpenHistoryOrder:b.openHistoryOrder,onOpenSpecialMng:b.openSpecialMng,onClose:t[11]||(t[11]=e=>m.isMapMode=!1)},null,8,["onChangeUser","onOpenHistoryOrder","onOpenSpecialMng"])])):(Object(o["openBlock"])(),Object(o["createBlock"])(v,{key:0},{up:Object(o["withCtx"])(()=>[Object(o["createVNode"])(C,{modelValue:m.searchData,"onUpdate:modelValue":t[8]||(t[8]=e=>m.searchData=e),onSearch:b.reSearch},{extral:Object(o["withCtx"])(()=>[Object(o["createVNode"])(w,{type:"error",onClick:t[4]||(t[4]=e=>b.deleteData())},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("批量删除")]),_:1}),Object(o["createVNode"])(w,{type:"success",onClick:t[5]||(t[5]=e=>b.changeModal())},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("新增")]),_:1}),Object(o["createVNode"])(w,{onClick:b.exportData,loading:m.exportLoading},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("导出")]),_:1},8,["onClick","loading"]),Object(o["createVNode"])(w,{type:"primary",onClick:t[6]||(t[6]=e=>m.showImport=!0)},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("批量导入")]),_:1}),Object(o["createVNode"])(w,{type:"success",onClick:t[7]||(t[7]=e=>m.isMapMode=!0)},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("地图模式")]),_:1})]),default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(j,{label:"客户名称:",prop:"name"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(O,{modelValue:m.searchData.name,"onUpdate:modelValue":t[0]||(t[0]=e=>m.searchData.name=e)},null,8,["modelValue"])]),_:1}),Object(o["createVNode"])(j,{label:"注册状态:",prop:"status"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(g,{modelValue:m.searchData.status,"onUpdate:modelValue":t[1]||(t[1]=e=>m.searchData.status=e),class:"vi-width"},{default:Object(o["withCtx"])(()=>[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(m.userStatusMap,(e,t)=>(Object(o["openBlock"])(),Object(o["createBlock"])(f,{key:t,value:t},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(o["createVNode"])(j,{label:"用户权限:",prop:"power"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(g,{modelValue:m.searchData.power,"onUpdate:modelValue":t[2]||(t[2]=e=>m.searchData.power=e),class:"vi-width"},{default:Object(o["withCtx"])(()=>[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(m.userPowerMap,(e,t)=>(Object(o["openBlock"])(),Object(o["createBlock"])(f,{key:t,value:t},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(o["createVNode"])(j,{label:"用户标签:",prop:"label"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(g,{modelValue:m.searchData.label,"onUpdate:modelValue":t[3]||(t[3]=e=>m.searchData.label=e),class:"vi-width"},{default:Object(o["withCtx"])(()=>[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(m.dictMap.user,(e,t)=>(Object(o["openBlock"])(),Object(o["createBlock"])(f,{key:t,value:e.id},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.name),1)]),_:2},1032,["value"]))),128)),Object(o["createVNode"])(f,{value:"其他"},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("其他")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue","onSearch"])]),down:Object(o["withCtx"])(()=>[Object(o["createVNode"])(k,{ref:"table",columns:m.columns,getData:b.getData,addSelect:"",addIndex:"",onOnSelectionChange:t[9]||(t[9]=e=>m.selected=e)},{point:Object(o["withCtx"])(({row:e})=>[e.longitude&&e.latitude?(Object(o["openBlock"])(),Object(o["createElementBlock"])("img",{key:0,src:c.a,onClick:t=>b.openMap(e),class:"pointer"},null,8,l)):(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",r,"-"))]),operate:Object(o["withCtx"])(({row:e})=>["2"==e.status?(Object(o["openBlock"])(),Object(o["createElementBlock"])("a",{key:0,onClick:t=>b.openAuditModal(e),class:"vi-green-pointer"},"审批",8,n)):(Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],{key:1},[Object(o["createElementVNode"])("a",{onClick:t=>b.openHistoryOrder(e)},"历史订单",8,i),Object(o["createElementVNode"])("a",{onClick:t=>b.openSpecialMng(e),class:"vi-green-pointer"},"特价",8,d),Object(o["createElementVNode"])("a",{onClick:t=>b.changeModal(e)},"修改",8,u)],64)),Object(o["createElementVNode"])("a",{onClick:t=>b.deleteData([e]),class:"vi-red-pointer"},"删除",8,p)]),_:1},8,["columns","getData"])]),_:1})),Object(o["createVNode"])(x,{modelValue:m.showUserModal,"onUpdate:modelValue":t[12]||(t[12]=e=>m.showUserModal=e),detailData:m.detailData,onSave:b.reSearch},null,8,["modelValue","detailData","onSave"]),Object(o["createVNode"])(y,{modelValue:m.showOrderModal,"onUpdate:modelValue":t[13]||(t[13]=e=>m.showOrderModal=e),curRow:m.detailData},null,8,["modelValue","curRow"]),Object(o["createVNode"])(D,{modelValue:m.showSpecialModal,"onUpdate:modelValue":t[14]||(t[14]=e=>m.showSpecialModal=e),curRow:m.detailData},null,8,["modelValue","curRow"]),Object(o["createVNode"])(M,{modelValue:m.showImport,"onUpdate:modelValue":t[15]||(t[15]=e=>m.showImport=e),onSave:b.reSearch},null,8,["modelValue","onSave"]),Object(o["createVNode"])(N,{modelValue:m.showMapModal,"onUpdate:modelValue":t[16]||(t[16]=e=>m.showMapModal=e),curRow:m.detailData},null,8,["modelValue","curRow"]),Object(o["createVNode"])(B,{modelValue:m.showAuditModal,"onUpdate:modelValue":t[17]||(t[17]=e=>m.showAuditModal=e),detailData:m.detailData,onSave:b.reSearch},null,8,["modelValue","detailData","onSave"])],64)}var b=a("eeb9"),O=a("c64b");const j={key:0,class:"orderMng"};function f(e,t,a,s,c,l){const r=Object(o["resolveComponent"])("orderMng"),n=Object(o["resolveComponent"])("Modal",!0);return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",null,[Object(o["createVNode"])(n,{title:a.curRow.name+"-历史订单",modelValue:l.showModal,"onUpdate:modelValue":t[1]||(t[1]=e=>l.showModal=e),width:"1200",class:"orderMngModal"},{default:Object(o["withCtx"])(()=>[l.showModal?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",j,[Object(o["createVNode"])(r,{curRow:a.curRow,onClose:t[0]||(t[0]=e=>l.showModal=!1)},null,8,["curRow"])])):Object(o["createCommentVNode"])("",!0)]),_:1},8,["title","modelValue"])])}var g=a("7e0a"),w={name:"orderMngModal",components:{orderMng:g["default"]},props:{modelValue:{type:Boolean,default:!1},curRow:{type:Object,default(){return{}}}},computed:{showModal:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}}},C=(a("a458"),a("7f90"),a("6b0d")),k=a.n(C);const v=k()(w,[["render",f],["__scopeId","data-v-550c1e58"]]);var V=v,x=a("e903");const y=e=>(Object(o["pushScopeId"])("data-v-55087470"),e=e(),Object(o["popScopeId"])(),e),D={class:"pt-20 pb-20"},M=y(()=>Object(o["createElementVNode"])("p",null,"点击或者拖拽文件上传",-1)),N={class:"mt-10"},B={class:"upload-msg",ref:"uploadMsg"},S={key:0};function I(e,t,a,s,c,l){const r=Object(o["resolveComponent"])("Icon"),n=Object(o["resolveComponent"])("Upload"),i=Object(o["resolveComponent"])("Checkbox"),d=Object(o["resolveComponent"])("Button"),u=Object(o["resolveComponent"])("Modal");return Object(o["openBlock"])(),Object(o["createBlock"])(u,{title:"批量导入客户",modelValue:l.showModal,"onUpdate:modelValue":t[2]||(t[2]=e=>l.showModal=e),width:500,draggable:"",sticky:"",scrollable:"",mask:!1},{footer:Object(o["withCtx"])(()=>[Object(o["createVNode"])(d,{type:"text",onClick:t[1]||(t[1]=e=>l.showModal=!1)},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("取消")]),_:1}),Object(o["createVNode"])(d,{type:"primary",onClick:l.exportTemplate},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("模板下载")]),_:1},8,["onClick"])]),default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(n,{type:"drag",action:c.importUsers,headers:c.headers,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",format:["xlsx"],"show-upload-list":!1,"before-upload":l.beforeUpload,"on-success":l.onSuccess,"on-error":l.onError},{default:Object(o["withCtx"])(()=>[Object(o["createElementVNode"])("div",D,[Object(o["createVNode"])(r,{type:"ios-cloud-upload",size:"52",style:{color:"#3399ff"}}),M])]),_:1},8,["action","headers","before-upload","on-success","on-error"]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",N,[Object(o["createElementVNode"])("p",null,[Object(o["createElementVNode"])("span",null,"导入文件名："+Object(o["toDisplayString"])(c.uploadName),1),Object(o["createVNode"])(i,{modelValue:c.showError,"onUpdate:modelValue":t[0]||(t[0]=e=>c.showError=e),class:"fr"},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("只看错误信息")]),_:1},8,["modelValue"])]),Object(o["createElementVNode"])("div",B,[l.msgList.length?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createElementBlock"])("p",S,Object(o["toDisplayString"])(c.showError?"【无】":"【正在导入中】"),1)),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(l.msgList,(e,t)=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("p",{key:t},[Object(o["createElementVNode"])("span",{class:Object(o["normalizeClass"])({"vi-red-text":1==e.status,"vi-green-text":[0,2,10].includes(e.status)})},Object(o["toDisplayString"])(e.mes),3)]))),128))],512)],512),[[o["vShow"],c.uploadId]])]),_:1},8,["modelValue"])}var E=a("8451"),$=a("ec16"),U=(a("3c65"),{name:"templateImportUsers",components:{Upload:$["a"],Checkbox:E["a"]},props:{modelValue:{type:Boolean,default:!1}},data(){return{importUsers:b["A"],headers:{authorization:sessionStorage.getItem("authorization")},uploadId:"",uploadName:"",uploadMsg:[],showError:!1}},computed:{showModal:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e),e||this.$emit("close")}},msgList(){return this.uploadMsg.filter(e=>!this.showError||this.showError&&1==e.status)}},methods:{exportTemplate(){Object(b["l"])({userIds:"下载模板"},`客户模板${(new Date).format("YYYYMMDDHHmmss")}.xlsx`)},beforeUpload(){return this.uploadId="",this.uploadName="",this.uploadMsg=[],!0},onSuccess(e,t){0==e.returnCode?(this.uploadName=t.name,e.data&&e.data.length?(this.uploadId=e.data[0].id,this.uploadMsg=e.data||[],this.$Message.success("导入成功"),this.$emit("save")):this.$Message.success("上传成功，开始导入")):this.$Message.error("上传失败："+e.returnMsg)},onError(e){this.$Message.error("上传失败："+(e.message||e))},batchImportUsers(e){if(0!==e.status||this.uploadId){if(e.id===this.uploadId){const t=this.uploadMsg.findIndex(t=>t.index<e.index);-1===t?this.uploadMsg.unshift(e):this.uploadMsg.splice(t,0,e),10==e.status&&this.$emit("save")}}else this.uploadId=e.id,this.uploadMsg=[e]}},mounted(){this.$EventBus.$on("batchImportUsers",this.batchImportUsers)},beforeMount(){this.$EventBus.$off("batchImportUsers",this.batchImportUsers)}});a("a9f5");const _=k()(U,[["render",I],["__scopeId","data-v-55087470"]]);var F=_,P=a("b046"),T=a("31fd"),L=a("ff79"),z=a("267e"),R=a("4360");const Y=Object(R["a"])();var H={name:"userMng",components:{addUserModal:O["a"],orderMngModal:V,specialMngModal:x["a"],templateImportUsers:F,singleUserMap:P["a"],allUsersMap:T["a"],auditUserModal:L["a"]},data(){return{dictMap:Y.dictMap,userStatusMap:z["c"],userPowerMap:z["b"],searchData:{},showUserModal:!1,detailData:{},columns:[{title:"客户名称",minWidth:100,key:"name",render:(e,{row:t})=>e("span","2"==t.status?t.nickName:t.name)},{title:"注册状态",width:80,render:(e,{row:t})=>e("span",z["c"][t.status]||"-")},{title:"用户权限",width:80,render:(e,{row:t})=>e("span",z["b"][t.power]||"-")},{title:"联系电话",key:"phone",minWidth:90},{title:"定位",slot:"point",width:60},{title:"修改时间",key:"updateTime",minWidth:90},{title:"操作",slot:"operate",minWidth:100}],selected:[],showOrderModal:!1,showSpecialModal:!1,exportLoading:!1,showImport:!1,showMapModal:!1,isMapMode:!1,showAuditModal:!1}},methods:{reSearch(){var e;this.isMapMode?this.$refs.userMap.getUsersList():null===(e=this.$refs.table)||void 0===e||e.changePage(1)},getData(e){this.selected=[];const t={...e,...this.searchData};return Object(b["y"])(t)},changeModal(e){this.detailData={...e},this.showUserModal=!0},openHistoryOrder(e){this.detailData={...e},this.showOrderModal=!0},openSpecialMng(e){this.detailData={...e},this.showSpecialModal=!0},deleteData(e=this.selected){if(!e.length)return this.$Message.info("至少选中一项");this.$Modal.confirm({title:"删除客户",content:"是否确认删除所选客户（将会删除该用户所有数据）？",onOk:async()=>{try{const{returnCode:t,data:a}=await Object(b["i"])({userIds:e.map(e=>e.userId).join()})||{};0===t&&a&&(this.$Message.success("删除成功"),this.reSearch())}catch(t){this.$Message.error("删除失败："+(t.message||t))}}})},exportData(){this.exportLoading=!0,Object(b["l"])({...this.searchData,userIds:this.selected.map(e=>e.userId).join()},`客户${(new Date).format("YYYYMMDDHHmmss")}.xlsx`).finally(()=>{this.exportLoading=!1})},openMap(e){this.detailData={...e},this.showMapModal=!0},openAuditModal(e){this.detailData={...e,name:e.nickName},this.showAuditModal=!0}},activated(){this.reSearch()}};a("42d7");const W=k()(H,[["render",m],["__scopeId","data-v-43cfe4ea"]]);t["default"]=W}}]);