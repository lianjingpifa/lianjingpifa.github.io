{"version":3,"sources":["webpack:///./src/viewsMobile/mobileUser/index.vue?3ec6","webpack:///./src/viewsMobile/mobileUser/index.vue","webpack:///./src/viewsMobile/mobileUser/index.vue?7a03"],"names":["class","_createElementBlock","_createVNode","_component_Icon","type","$data","isMapMode","size","onClick","_cache","$event","$options","onSelect","_hoisted_6","_component_allUsersMap","ref","onChangeUser","onDeleteUser","onOpenHistoryOrder","onOpenSpecialMng","onClose","_Fragment","key","_component_van_search","keyword","shape","placeholder","onClear","reSearch","onSearch","_component_viListScroll","getData","onOnUpdate","_ctx","$emit","total","default","_withCtx","item","_createElementVNode","openPopup","_hoisted_2","_hoisted_3","_toDisplayString","name","_hoisted_4","phone","_hoisted_5","remarks","_component_add_user_modal","showUserModal","detailData","onSave","_component_single_user_map","showMapModal","curRow","_component_van_action_sheet","show","showPopup","title","actions","cancel-text","close-on-click-action","action","components","viListScroll","addUserModal","singleUserMap","allUsersMap","data","computed","color","this","longitude","latitude","methods","_this$$refs$list","$refs","userMap","getUsersList","list","param","getUsersByPage","deleteUser","userId","$Modal","confirm","content","onOk","async","returnCode","deleteUsers","userIds","$Message","success","err","error","message","$router","push","state","params","__exports__","render"],"mappings":"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","file":"public/js/chunk-ae59a4b2.035cf5a8.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=3b1046df&lang=less&scoped=true\"","<!--\r\n * @Author: zzx\r\n * @Date: 2023-11-11 15:07:00\r\n * @LastEditors: zzx\r\n * @LastEditTime: 2023-12-18 20:52:18\r\n-->\r\n<template>\r\n  <div>\r\n    <Icon\r\n      :type=\"isMapMode ? 'ios-list' : 'ios-pin-outline'\"\r\n      size=\"32\"\r\n      @click=\"isMapMode = !isMapMode\"\r\n      class=\"header-icon left\"\r\n    />\r\n    <Icon\r\n      type=\"ios-person-add-outline\"\r\n      size=\"34\"\r\n      @click=\"onSelect('change', {})\"\r\n      class=\"header-icon right\"\r\n    />\r\n    <template v-if=\"!isMapMode\">\r\n      <van-search\r\n        v-model=\"keyword\"\r\n        shape=\"round\"\r\n        placeholder=\"请输入客户名称搜索\"\r\n        @clear=\"reSearch\"\r\n        @search=\"reSearch\"\r\n        class=\"search-input\"\r\n      />\r\n      <viListScroll ref=\"list\" :getData=\"getData\" @on-update=\"$emit('total', $event.total)\" class=\"container\">\r\n        <template #default=\"{ item }\">\r\n          <div class=\"card\" @click=\"openPopup(item)\">\r\n            <div class=\"card-top\">\r\n              <p class=\"title\">{{ item.name }}</p>\r\n              <span class=\"f-16\">{{ item.phone }}</span>\r\n            </div>\r\n            <p class=\"remarks\">备注：{{ item.remarks || \"无\" }}</p>\r\n          </div>\r\n        </template>\r\n      </viListScroll>\r\n    </template>\r\n    <div v-else class=\"h100\">\r\n      <allUsersMap\r\n        ref=\"userMap\"\r\n        @changeUser=\"onSelect('change', $event)\"\r\n        @deleteUser=\"onSelect('delete', $event)\"\r\n        @openHistoryOrder=\"onSelect('order', $event)\"\r\n        @openSpecialMng=\"onSelect('special', $event)\"\r\n        @close=\"isMapMode = false\"\r\n      />\r\n    </div>\r\n    <add-user-modal v-model=\"showUserModal\" :detailData=\"detailData\" @save=\"reSearch\"></add-user-modal>\r\n    <single-user-map v-model=\"showMapModal\" :curRow=\"detailData\"></single-user-map>\r\n    <van-action-sheet\r\n      v-model:show=\"showPopup\"\r\n      :title=\"detailData.name\"\r\n      :actions=\"actions\"\r\n      cancel-text=\"取消\"\r\n      close-on-click-action\r\n      @select=\"(action) => onSelect(action.type)\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getUsersByPage, deleteUsers } from \"@/axios\";\r\nimport { viListScroll } from \"@/components\";\r\nimport addUserModal from \"@/views/userMng/addUserModal\";\r\nimport singleUserMap from \"@/views/userMng/singleUserMap\";\r\nimport allUsersMap from \"@/views/userMng/allUsersMap\";\r\n\r\nexport default {\r\n  name: \"mobileUser\",\r\n  components: { viListScroll, addUserModal, singleUserMap, allUsersMap },\r\n  data() {\r\n    return {\r\n      keyword: \"\",\r\n      showUserModal: false,\r\n      detailData: {},\r\n      showPopup: false,\r\n      showMapModal: false,\r\n      isMapMode: false,\r\n    };\r\n  },\r\n  computed: {\r\n    actions() {\r\n      return [\r\n        { name: \"删除\", type: \"delete\", color: \"#f66161\" },\r\n        { name: \"特价\", type: \"special\", color: \"#07c160\" },\r\n        { name: \"历史订单\", type: \"order\", color: \"#2d8cf0\" },\r\n        ...(this.detailData.longitude && this.detailData.latitude ?\r\n          [{ name: \"定位\", type: \"location\", color: \"#07c160\" }] : []),\r\n        { name: \"修改\", type: \"change\" },\r\n      ];\r\n    },\r\n  },\r\n  methods: {\r\n    reSearch() {\r\n      if (this.isMapMode) {\r\n        this.$refs.userMap.getUsersList();\r\n      } else {\r\n        this.$refs.list?.reSearch();\r\n      }\r\n    },\r\n    getData(param) {\r\n      return getUsersByPage({\r\n        ...param,\r\n        name: this.keyword,\r\n      });\r\n    },\r\n    deleteUser({ userId, name }) {\r\n      this.$Modal.confirm({\r\n        title: \"删除客户\",\r\n        content: `是否确认删除${name}？`,\r\n        onOk: async () => {\r\n          try {\r\n            const { returnCode, data } = await deleteUsers({\r\n              userIds: `${userId}`,\r\n            }) || {};\r\n            if (returnCode === 0 && data) {\r\n              this.$Message.success(\"删除成功\");\r\n              this.reSearch();\r\n            }\r\n          } catch (err) {\r\n            this.$Message.error(`删除失败：${err.message || err}`);\r\n          }\r\n        },\r\n      });\r\n    },\r\n    openPopup(data) {\r\n      this.detailData = { ...data };\r\n      this.showPopup = true;\r\n    },\r\n    onSelect(type, data = this.detailData) {\r\n      if (type === \"change\") {\r\n        this.detailData = { ...data };\r\n        this.showUserModal = true;\r\n      } else if (type === \"special\") {\r\n        this.$router.push({\r\n          name: \"mobileSpecial\",\r\n          state: {\r\n            params: { userId: data.userId, name: data.name },\r\n          },\r\n        });\r\n      } else if (type === \"order\") {\r\n        this.$router.push({\r\n          name: \"mobileOrder\",\r\n          state: {\r\n            params: { userId: data.userId, name: data.name },\r\n          },\r\n        });\r\n      } else if (type === \"delete\") {\r\n        this.deleteUser(data);\r\n      } else if (type === \"location\") {\r\n        this.showMapModal = true;\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.header-icon {\r\n  position: fixed;\r\n  top: 23px;\r\n  transform: translateY(-50%);\r\n  &.right {\r\n    right: 10px;\r\n  }\r\n  &.left {\r\n    left: 10px;\r\n  }\r\n}\r\n.search-input {\r\n  border-radius: 0 0 4px 4px;\r\n}\r\n.container {\r\n  height: calc(100% - 54px);\r\n}\r\n.card {\r\n  padding: 10px;\r\n  background: #FFFFFF;\r\n  border-radius: 4px;\r\n  &-top {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    .title {\r\n      font-size: 16px;\r\n      font-weight: 600;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import { render } from \"./index.vue?vue&type=template&id=3b1046df&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=3b1046df&lang=less&scoped=true\"\n\nimport exportComponent from \"E:\\\\goodCashier\\\\web\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-3b1046df\"]])\n\nexport default __exports__"],"sourceRoot":""}