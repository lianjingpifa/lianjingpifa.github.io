{"version":3,"sources":["webpack:///./src/views/orderMng/index.vue?002a","webpack:///./src/views/orderMng/index.vue","webpack:///./src/views/orderMng/index.vue?63c9"],"names":["_createBlock","_component_viLayoutUpDown","up","_withCtx","_createVNode","_component_viSearchForm","$data","searchData","$event","onSearch","$options","reSearch","extral","_component_Button","type","onClick","_cache","deleteData","class","$props","curRow","userId","_component_FormItem","label","prop","_component_viInput","userName","_component_Select","status","clearable","_createElementBlock","_Fragment","_renderList","statusMap","item","key","_component_Option","value","_component_DatePicker","updateTime","options","placeholder","createTime","down","_component_viTablePage","ref","columns","getData","addSelect","addIndex","onOnSelectionChange","selected","operate","row","_createElementVNode","changeOrder","_hoisted_1","_hoisted_2","copyOrder","_hoisted_3","_component_Modal","title","showDetail","width","class-name","footer","detailData","_component_viPrintContent","list","total","name","components","DatePicker","_DatePicker","viPrintContent","props","Object","default","data","1","2","shortcuts","text","Date","subtract","computed","align","render","h","this","JSON","parse","detail","toFixed","orderId","minWidth","slot","methods","_this$$refs$table","$refs","table","changePage","param","params","getOrdersByPage","updateTimeStart","startOf","format","updateTimeEnd","endOf","createTimeStart","createTimeEnd","$emit","$router","push","state","goodList","length","$Message","info","$Modal","confirm","content","onOk","async","returnCode","deleteOrders","orderIds","map","join","success","$EventBus","err","error","message","activated","__exports__"],"mappings":"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","file":"public/js/chunk-96a3b086.e0940bad.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./index.vue?vue&type=style&index=0&id=69495745&lang=less&scoped=true\"","<!--\r\n * @Author: zzx\r\n * @Date: 2022-06-11 20:35:10\r\n * @LastEditors: zzx\r\n * @LastEditTime: 2023-12-01 21:35:11\r\n-->\r\n<template>\r\n  <viLayoutUpDown>\r\n    <template #up>\r\n      <viSearchForm v-model=\"searchData\" @search=\"reSearch\">\r\n        <FormItem label=\"客户名称:\" prop=\"userName\" v-if=\"!curRow.userId\">\r\n          <viInput v-model=\"searchData.userName\" class=\"vi-width\"></viInput>\r\n        </FormItem>\r\n        <FormItem label=\"订单状态:\" prop=\"status\">\r\n          <Select v-model=\"searchData.status\" clearable class=\"vi-width\">\r\n            <Option\r\n              v-for=\"(item, key) in statusMap\"\r\n              :value=\"item\"\r\n              :key=\"key\"\r\n            >{{ item }}</Option>\r\n          </Select>\r\n        </FormItem>\r\n        <FormItem label=\"修改时间:\" prop=\"updateTime\">\r\n          <DatePicker\r\n            v-model=\"searchData.updateTime\"\r\n            type=\"daterange\"\r\n            :options=\"options\"\r\n            placeholder=\"请选择\"\r\n            class=\"vi-width\"\r\n          />\r\n        </FormItem>\r\n        <FormItem label=\"创建时间:\" prop=\"createTime\">\r\n          <DatePicker\r\n            v-model=\"searchData.createTime\"\r\n            type=\"daterange\"\r\n            :options=\"options\"\r\n            placeholder=\"请选择\"\r\n            class=\"vi-width\"\r\n          />\r\n        </FormItem>\r\n        <template #extral>\r\n          <Button type=\"error\" @click=\"deleteData()\" class=\"ml-10\">批量删除</Button>\r\n        </template>\r\n      </viSearchForm>\r\n    </template>\r\n    <template #down>\r\n      <viTablePage\r\n        ref=\"table\"\r\n        :columns=\"columns\"\r\n        :getData=\"getData\"\r\n        addSelect\r\n        addIndex\r\n        @on-selection-change=\"selected = $event\"\r\n      >\r\n        <template #operate=\"{ row }\">\r\n          <a @click=\"changeOrder(row)\">修改</a>\r\n          <a @click=\"deleteData([row])\" class=\"ml-10 vi-red-pointer\">删除</a>\r\n          <a @click=\"copyOrder(row)\" class=\"ml-10 vi-green-pointer\">一键复制</a>\r\n        </template>\r\n      </viTablePage>\r\n      <Modal title=\"订单详情\" v-model=\"showDetail\" :width=\"880\" class-name=\"vertical-center-modal\">\r\n        <viPrintContent :list=\"detailData.list\" :total=\"detailData.total\" class=\"order-detail\" />\r\n        <template #footer>\r\n          <Button @click=\"showDetail = false\">取消</Button>\r\n          <Button type=\"primary\" @click=\"changeOrder(detailData)\">去修改</Button>\r\n          <Button type=\"primary\" @click=\"copyOrder(detailData)\">一键复制</Button>\r\n          <Button type=\"error\" @click=\"deleteData([detailData])\">删除</Button>\r\n        </template>\r\n      </Modal>\r\n    </template>\r\n  </viLayoutUpDown>\r\n</template>\r\n\r\n<script>\r\nimport { DatePicker } from \"view-ui-plus\";\r\nimport { getOrdersByPage, deleteOrders } from \"@/axios\";\r\nimport { viPrintContent } from \"@/components\";\r\n\r\nexport default {\r\n  name: \"orderMng\",\r\n  components: { DatePicker, viPrintContent },\r\n  props: {\r\n    curRow: {\r\n      type: Object,\r\n      default() {\r\n        return {};\r\n      },\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      searchData: {},\r\n      statusMap: {\r\n        1: \"草稿\",\r\n        2: \"已打印\",\r\n      },\r\n      selected: [],\r\n      options: {\r\n        shortcuts: [\r\n          { text: \"今天\", value: () => [new Date(), new Date()] },\r\n          { text: \"近2天\", value: () => [new Date().subtract(1), new Date()] },\r\n          { text: \"近3天\", value: () => [new Date().subtract(2), new Date()] },\r\n          { text: \"近一周\", value: () => [new Date().subtract(7), new Date()] },\r\n        ],\r\n      },\r\n      showDetail: false,\r\n      detailData: {},\r\n    };\r\n  },\r\n  computed: {\r\n    columns() {\r\n      return [\r\n        {\r\n          title: \"订单编号\",\r\n          align: \"center\",\r\n          width: 180,\r\n          render: (h, { row }) => h(\"span\", {\r\n            class: \"vi-link-pointer\",\r\n            onClick: () => {\r\n              this.detailData = {\r\n                ...row,\r\n                list: JSON.parse(row.detail || \"[]\"),\r\n                total: row.total.toFixed(2),\r\n              };\r\n              this.showDetail = true;\r\n            }\r\n          }, row.orderId),\r\n        },\r\n        ...(this.curRow.userId ? [] : [{ title: \"客户名称\", key: \"userName\", align: \"center\", minWidth: 200 }]),\r\n        { title: \"订单状态\", align: \"center\", width: 100, render: (h, { row }) => h(\"span\", this.statusMap[row.status] || \"-\") },\r\n        { title: \"总金额\", align: \"center\", minWidth: 150, render: (h, { row }) => h(\"span\", `￥${row.total.toFixed(2)}`) },\r\n        { title: \"修改时间\", key: \"updateTime\", align: \"center\", width: 180 },\r\n        { title: \"创建时间\", key: \"createTime\", align: \"center\", width: 180 },\r\n        { title: \"操作\", slot: \"operate\", align: \"center\", width: 200 },\r\n      ];\r\n    },\r\n  },\r\n  methods: {\r\n    reSearch() {\r\n      this.$refs.table?.changePage(1);\r\n    },\r\n    getData(param) {\r\n      this.selected = [];\r\n      const { updateTime = [], createTime = [], ...params } = this.searchData;\r\n      return getOrdersByPage({\r\n        ...param,\r\n        ...params,\r\n        updateTimeStart: updateTime[0] && new Date(updateTime[0]).startOf(\"day\").format(\"YYYY-MM-DD HH:mm:ss\"),\r\n        updateTimeEnd: updateTime[1] && new Date(updateTime[1]).endOf(\"day\").format(\"YYYY-MM-DD HH:mm:ss\"),\r\n        createTimeStart: createTime[0] && new Date(createTime[0]).startOf(\"day\").format(\"YYYY-MM-DD HH:mm:ss\"),\r\n        createTimeEnd: createTime[1] && new Date(createTime[1]).endOf(\"day\").format(\"YYYY-MM-DD HH:mm:ss\"),\r\n        ...this.curRow,\r\n      });\r\n    },\r\n    changeOrder(data) {\r\n      this.showDetail = false;\r\n      this.$emit(\"close\");\r\n      this.$router.push({\r\n        name: \"cashierMng\",\r\n        state: {\r\n          params: {\r\n            type: \"change\",\r\n            userId: data.userId,\r\n            goodList: data.detail,\r\n            orderId: data.orderId,\r\n          }\r\n        },\r\n      });\r\n    },\r\n    copyOrder(data) {\r\n      this.showDetail = false;\r\n      this.$emit(\"close\");\r\n      this.$router.push({\r\n        name: \"cashierMng\",\r\n        state: {\r\n          params: { type: \"copy\", goodList: data.detail },\r\n        }\r\n      });\r\n    },\r\n    deleteData(selected = this.selected) {\r\n      if (!selected.length) return this.$Message.info(\"至少选中一项\");\r\n      this.$Modal.confirm({\r\n        title: \"删除订单\",\r\n        content: \"是否确认删除所选订单？\",\r\n        onOk: async () => {\r\n          try {\r\n            const { returnCode, data } = await deleteOrders({\r\n              orderIds: selected.map((item) => item.orderId).join()\r\n            }) || {};\r\n            if (returnCode === 0 && data) {\r\n              this.$Message.success(\"删除成功\");\r\n              this.$refs.table.changePage(1);\r\n              this.$EventBus.$emit(\"saveOrder\");\r\n            }\r\n          } catch (err) {\r\n            this.$Message.error(`删除失败：${err.message || err}`);\r\n          }\r\n        },\r\n      });\r\n    },\r\n  },\r\n  activated() {\r\n    this.reSearch();\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.order-detail {\r\n  position: relative !important;\r\n  left: 0 !important;\r\n  width: 100% !important;\r\n  height: calc(100vh - 240px);\r\n  overflow-y: auto;\r\n  overflow-x: hidden;\r\n  padding-right: 10px;\r\n}\r\n</style>\r\n","import { render } from \"./index.vue?vue&type=template&id=69495745&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=69495745&lang=less&scoped=true\"\n\nimport exportComponent from \"E:\\\\goodCashier\\\\web\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-69495745\"]])\n\nexport default __exports__"],"sourceRoot":""}