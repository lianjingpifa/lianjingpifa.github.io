(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d1e21bb0"],{"1b20":function(e,t,a){"use strict";a.r(t);a("14d9");var c=a("7a23"),l=a("aad9"),n=a("3e47"),o=a("df7b"),r=a("b351"),u=a("eeb9"),s=a("2af9"),d=a("c64b"),i=a("b046"),b=a("31fd"),O=a("ff79"),j=a("4360"),m=a("6605");const v={class:"container"},f=["onClick"],p={class:"card-top"},k={class:"remarks"},V={key:0,class:"remarks"},h={key:1,class:"h100"};var g={__name:"mobile",props:{draftCount:{type:Number,default:void 0}},emits:["total"],setup(e,{emit:t}){const a=e,g=Object(j["a"])(),y=Object(c["computed"])(()=>g.dictMap),C=Object(m["d"])(),N=Object(c["inject"])("$Message",()=>{}),w=Object(c["inject"])("$Modal",()=>{}),B=Object(c["inject"])("$Auth",()=>!1),S=Object(c["ref"])(),U=Object(c["ref"])(),E=Object(c["ref"])(!1);function I(){var e;E.value?S.value.getUsersList():null===(e=U.value)||void 0===e||e.reSearch()}Object(c["watch"])(()=>a.draftCount,()=>I());const x=Object(c["ref"])({}),D=Object(c["computed"])(()=>[...B(3)&&x.value.wxid?[{name:"重置密码",type:"resetPassword",color:"#f66161"}]:[],{name:"删除",type:"delete",color:"#f66161"},..."2"==x.value.status?[{name:"审批",type:"audit",color:"#07c160"}]:[{name:"特价",type:"special",color:"#07c160"},{name:"历史订单",type:"order",color:"#2d8cf0"},...x.value.longitude&&x.value.latitude?[{name:"定位",type:"location",color:"#07c160"}]:[],{name:"修改",type:"change"}]]),_=Object(c["ref"])("2"),$=Object(c["ref"])(0),A=Object(c["ref"])("");function P(e){const t=y.value.user||[],a=["",...t.map(e=>e.id),"其他"];return Object(u["A"])({...e,name:A.value,status:_.value,label:a[$.value]})}function M({userId:e,name:t}){w.confirm({title:"删除客户",content:`是否确认删除${t}？`,loading:!0,onOk:async()=>{try{const{returnCode:t,data:a}=await Object(u["j"])({userIds:""+e})||{};0===t&&a&&(N.success("删除成功"),w.remove(),window.$EventBus.$emit("saveUser"),I())}catch(t){N.error("删除失败："+(t.message||t))}}})}function R(e){w.confirm({title:"重置密码",content:"是否确认重置该客户密码？",loading:!0,onOk:async()=>{try{const{returnCode:t,data:a}=await Object(u["G"])({userId:e.userId})||{};0===t&&a&&(w.remove(),setTimeout(()=>{w.success({title:"重置密码成功",content:`重置后的密码为：<h2 style="display: inline-block;">${a}</h2>`,loading:!1})},300))}catch(t){N.error("重置失败："+(t.message||t))}}})}const z=Object(c["ref"])(!1);function F(e){x.value={...e},z.value=!0}const J=Object(c["ref"])(!1),L=Object(c["ref"])(!1),G=Object(c["ref"])(!1);function H(e,t=x.value){"change"===e?(x.value={...t},J.value=!0):"special"===e?C.push({name:"mobileSpecial",state:{params:{userId:t.userId,name:t.name}}}):"order"===e?C.push({name:"mobileOrder",state:{params:{userId:t.userId,name:t.name}}}):"delete"===e?M(t):"location"===e?L.value=!0:"audit"===e?G.value=!0:"resetPassword"===e&&R(t)}return(a,u)=>{const j=Object(c["resolveComponent"])("Icon"),m=Object(c["resolveComponent"])("van-search"),g=Object(c["resolveComponent"])("van-action-sheet");return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",null,[Object(c["createVNode"])(j,{type:E.value?"ios-list":"ios-pin-outline",size:"32",onClick:u[0]||(u[0]=e=>E.value=!E.value),class:"vi-header-icon left"},null,8,["type"]),Object(c["createVNode"])(j,{type:"ios-person-add-outline",size:"34",onClick:u[1]||(u[1]=e=>H("change",{})),class:"vi-header-icon right"}),E.value?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",h,[Object(c["createVNode"])(Object(c["unref"])(b["a"]),{ref_key:"userMapRef",ref:S,onChangeUser:u[6]||(u[6]=e=>H("change",e)),onDeleteUser:u[7]||(u[7]=e=>H("delete",e)),onOpenHistoryOrder:u[8]||(u[8]=e=>H("order",e)),onOpenSpecialMng:u[9]||(u[9]=e=>H("special",e)),onClose:u[10]||(u[10]=e=>E.value=!1)},null,512)])):(Object(c["openBlock"])(),Object(c["createElementBlock"])(c["Fragment"],{key:0},[Object(c["createVNode"])(Object(c["unref"])(l["a"]),{active:_.value,"onUpdate:active":u[2]||(u[2]=e=>_.value=e),onChange:I},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(Object(c["unref"])(n["a"]),{title:"用户审批",name:"2",badge:e.draftCount||void 0},null,8,["badge"]),Object(c["createVNode"])(Object(c["unref"])(n["a"]),{title:"用户管理",name:"1,3"})]),_:1},8,["active"]),Object(c["createVNode"])(m,{modelValue:A.value,"onUpdate:modelValue":u[3]||(u[3]=e=>A.value=e),shape:"round",placeholder:"请输入客户名称搜索",onClear:I,onSearch:I,class:"search-input"},null,8,["modelValue"]),Object(c["createElementVNode"])("div",v,["2"!=_.value?(Object(c["openBlock"])(),Object(c["createBlock"])(Object(c["unref"])(o["a"]),{key:0,modelValue:$.value,"onUpdate:modelValue":u[4]||(u[4]=e=>$.value=e),onChange:I,class:"sidebar"},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(Object(c["unref"])(r["a"]),{title:"全部",key:"all"}),(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(y.value.user,(e,t)=>(Object(c["openBlock"])(),Object(c["createBlock"])(Object(c["unref"])(r["a"]),{key:t,title:e.name},null,8,["title"]))),128)),Object(c["createVNode"])(Object(c["unref"])(r["a"]),{title:"其他",key:"other"})]),_:1},8,["modelValue"])):Object(c["createCommentVNode"])("",!0),Object(c["createVNode"])(Object(c["unref"])(s["i"]),{ref_key:"listRef",ref:U,getData:P,onOnUpdate:u[5]||(u[5]=e=>t("total",e.total)),class:"flex-1 h100"},{default:Object(c["withCtx"])(({item:e})=>[Object(c["createElementVNode"])("div",{class:"card",onClick:t=>F(e)},[Object(c["createElementVNode"])("p",p,Object(c["toDisplayString"])("2"==e.status?e.nickName:e.name),1),Object(c["createElementVNode"])("p",k,"联系电话："+Object(c["toDisplayString"])(e.phone||"无"),1),"2"==_.value?(Object(c["openBlock"])(),Object(c["createElementBlock"])("p",V,"备注："+Object(c["toDisplayString"])(e.remarks||"无"),1)):Object(c["createCommentVNode"])("",!0)],8,f)]),_:1},512)])],64)),Object(c["createVNode"])(Object(c["unref"])(d["a"]),{modelValue:J.value,"onUpdate:modelValue":u[11]||(u[11]=e=>J.value=e),detailData:x.value,onSave:I},null,8,["modelValue","detailData"]),Object(c["createVNode"])(Object(c["unref"])(i["a"]),{modelValue:L.value,"onUpdate:modelValue":u[12]||(u[12]=e=>L.value=e),curRow:x.value},null,8,["modelValue","curRow"]),Object(c["createVNode"])(Object(c["unref"])(O["a"]),{modelValue:G.value,"onUpdate:modelValue":u[13]||(u[13]=e=>G.value=e),detailData:x.value,onSave:I},null,8,["modelValue","detailData"]),Object(c["createVNode"])(g,{show:z.value,"onUpdate:show":u[14]||(u[14]=e=>z.value=e),title:x.value.name,actions:D.value,"cancel-text":"取消","close-on-click-action":"",onSelect:u[15]||(u[15]=e=>H(e.type))},null,8,["show","title","actions"])])}}},y=(a("330e"),a("6b0d")),C=a.n(y);const N=C()(g,[["__scopeId","data-v-2585f90e"]]);t["default"]=N},"330e":function(e,t,a){"use strict";a("df76")},a68d:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return i}));var c=a("7a23"),l=a("1fba"),n=a("e5f6"),o=a("450f");const[r,u]=Object(l["a"])("sidebar"),s=Symbol(r),d={modelValue:Object(n["c"])(0)};var i=Object(c["defineComponent"])({name:r,props:d,emits:["change","update:modelValue"],setup(e,{emit:t,slots:a}){const{linkChildren:l}=Object(o["useChildren"])(s),n=()=>+e.modelValue,r=e=>{e!==n()&&(t("update:modelValue",e),t("change",e))};return l({getActive:n,setActive:r}),()=>{var e;return Object(c["createVNode"])("div",{role:"tablist",class:u()},[null==(e=a.default)?void 0:e.call(a)])}}})},b351:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var c=a("23f9"),l=a("7a23"),n=a("1fba"),o=a("fa7c"),r=a("e5f6"),u=a("a68d"),s=a("450f"),d=a("4e5e"),i=a("8be7");const[b,O]=Object(n["a"])("sidebar-item"),j=Object(o["a"])({},d["b"],{dot:Boolean,title:String,badge:r["f"],disabled:Boolean,badgeProps:Object});var m=Object(l["defineComponent"])({name:b,props:j,emits:["click"],setup(e,{emit:t,slots:a}){const c=Object(d["c"])(),{parent:n,index:o}=Object(s["useParent"])(u["a"]);if(!n)return void 0;const r=()=>{e.disabled||(t("click",o.value),n.setActive(o.value),c())};return()=>{const{dot:t,badge:c,title:u,disabled:s}=e,d=o.value===n.getActive();return Object(l["createVNode"])("div",{role:"tab",class:O({select:d,disabled:s}),tabindex:s?void 0:0,"aria-selected":d,onClick:r},[Object(l["createVNode"])(i["a"],Object(l["mergeProps"])({dot:t,class:O("text"),content:c},e.badgeProps),{default:()=>[a.title?a.title():u]})])}}});const v=Object(c["a"])(m)},df76:function(e,t,a){},df7b:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var c=a("23f9"),l=a("a68d");const n=Object(c["a"])(l["b"])}}]);