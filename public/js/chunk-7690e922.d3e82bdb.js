(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7690e922"],{6564:function(e,t,l){"use strict";l("d189")},"6b05":function(e,t,l){"use strict";l.r(t);l("14d9");var a=l("7a23"),n=l("af58");const o=["onClick"];var c={__name:"index",props:{modelValue:{type:[String,Number],default:""},multiple:{type:Boolean,default:!1},filterable:{type:Boolean,default:!1},getData:{type:Function},valueKey:{type:String,default:"id"},labelKey:{type:String,default:"name"},queryKey:{type:String,default:"name"},params:{type:Object,default(){return{}}}},emits:["update:modelValue","on-change"],setup(e,{emit:t}){const l=e,c=Object(a["inject"])("$Message",()=>{}),r=Object(a["ref"])([]),u=Object(a["ref"])(!1),i=Object(a["computed"])({get(){return l.modelValue},set(e){u.value||(t("update:modelValue",e),t("on-change",e,l.multiple?[...r.value]:r.value[0]))}}),d=Object(a["ref"])();function s(e){const t=r.value.findIndex(t=>e[l.valueKey]===t[l.valueKey]);-1!==t?r.value.splice(t,1):l.multiple?r.value.push(e):r.value=[e];const a=r.value.map(e=>e[l.valueKey]);i.value=a.join(),l.multiple||d.value.changeDropdown(!1)}const b=Object(a["ref"])(!1),v=Object(a["ref"])(!1),f=Object(a["ref"])([]),p=Object(a["ref"])(1),j=Object(a["ref"])("");async function O(){if(!b.value)try{u.value=!0;const{returnCode:e,data:t}=await l.getData({[l.queryKey]:j.value,...l.params,curPage:p.value,pageSize:10})||{};0===e&&(f.value=[...f.value,...t.rows],p.value++,b.value=f.value.length>=t.count)}catch(e){v.value=!0,c.error("加载失败："+(e.message||e))}finally{u.value=!1}}function m(e){!l.multiple&&r.value[0]&&r.value[0][l.labelKey]===e||(b.value=!1,j.value=e,p.value=1,f.value=[],O())}return Object(a["watch"])(()=>l.modelValue,async e=>{const t=r.value.filter(t=>l.multiple?!!e.split(",").find(e=>e==t[l.valueKey]):t[l.valueKey]==e);if(e&&!t.length)try{u.value=!0;const{returnCode:e,data:t}=await l.getData({[l.valueKey]:l.modelValue})||{};0===e&&(u.value=!1,s(t.rows[0]),d.value.$refs.selectRef.values=t.rows.map(e=>({value:e[l.valueKey],label:e[l.labelKey],tag:null})))}catch(a){u.value=!1,console.error("回显失败："+(a.message||a))}else r.value=t},{immediate:!0}),Object(a["onMounted"])(()=>{m()}),(t,l)=>{const c=Object(a["resolveComponent"])("Option"),p=Object(a["resolveComponent"])("viSelect");return Object(a["openBlock"])(),Object(a["createBlock"])(p,{ref_key:"selectRef",ref:d,modelValue:i.value,"onUpdate:modelValue":l[3]||(l[3]=e=>i.value=e),filterable:e.filterable,multiple:e.multiple,notFoundText:"",onOnQueryChange:m},{default:Object(a["withCtx"])(()=>[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(r.value,t=>(Object(a["openBlock"])(),Object(a["createBlock"])(c,{key:t,value:String(t[e.valueKey]),label:t[e.labelKey],style:{display:"none !important"}},null,8,["value","label"]))),128)),Object(a["createVNode"])(Object(a["unref"])(n["a"]),{loading:u.value,"onUpdate:loading":l[0]||(l[0]=e=>u.value=e),finished:b.value,"finished-text":f.value.length?"没有更多了":"无匹配数据",error:v.value,"onUpdate:error":l[1]||(l[1]=e=>v.value=e),"error-text":"加载失败",onLoad:l[2]||(l[2]=e=>O()),class:"list"},{default:Object(a["withCtx"])(()=>[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(f.value,t=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("li",{key:t[e.valueKey],onClick:e=>s(t),class:Object(a["normalizeClass"])(["ivu-select-item",{"ivu-select-item-selected":!!r.value.find(l=>t[e.valueKey]==l[e.valueKey])}])},Object(a["toDisplayString"])(t[e.labelKey]),11,o))),128))]),_:1},8,["loading","finished","finished-text","error"])]),_:1},8,["modelValue","filterable","multiple"])}}},r=(l("6564"),l("6b0d")),u=l.n(r);const i=u()(c,[["__scopeId","data-v-904398d2"]]);t["default"]=i},af58:function(e,t,l){"use strict";l.d(t,"a",(function(){return O}));var a=l("23f9"),n=l("7a23"),o=l("1fba"),c=l("e5f6"),r=l("8db7"),u=l("450f"),i=l("efd9"),d=l("be32"),s=l("5913");const[b,v,f]=Object(o["a"])("list"),p={error:Boolean,offset:Object(c["c"])(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:Object(c["e"])("down"),loadingText:String,finishedText:String,immediateCheck:c["g"]};var j=Object(n["defineComponent"])({name:b,props:p,emits:["load","update:error","update:loading"],setup(e,{emit:t,slots:l}){const a=Object(n["ref"])(e.loading),o=Object(n["ref"])(),c=Object(n["ref"])(),b=Object(d["b"])(),p=Object(u["useScrollParent"])(o),j=Object(n["computed"])(()=>e.scroller||p.value),O=()=>{Object(n["nextTick"])(()=>{if(a.value||e.finished||e.disabled||e.error||!1===(null==b?void 0:b.value))return;const{direction:l}=e,n=+e.offset,i=Object(u["useRect"])(j);if(!i.height||Object(r["d"])(o))return;let d=!1;const s=Object(u["useRect"])(c);d="up"===l?i.top-s.top<=n:s.bottom-i.bottom<=n,d&&(a.value=!0,t("update:loading",!0),t("load"))})},m=()=>{if(e.finished){const t=l.finished?l.finished():e.finishedText;if(t)return Object(n["createVNode"])("div",{class:v("finished-text")},[t])}},g=()=>{t("update:error",!1),O()},y=()=>{if(e.error){const t=l.error?l.error():e.errorText;if(t)return Object(n["createVNode"])("div",{role:"button",class:v("error-text"),tabindex:0,onClick:g},[t])}},h=()=>{if(a.value&&!e.finished&&!e.disabled)return Object(n["createVNode"])("div",{class:v("loading")},[l.loading?l.loading():Object(n["createVNode"])(s["a"],{class:v("loading-icon")},{default:()=>[e.loadingText||f("loading")]})])};return Object(n["watch"])(()=>[e.loading,e.finished,e.error],O),b&&Object(n["watch"])(b,e=>{e&&O()}),Object(n["onUpdated"])(()=>{a.value=e.loading}),Object(n["onMounted"])(()=>{e.immediateCheck&&O()}),Object(i["a"])({check:O}),Object(u["useEventListener"])("scroll",O,{target:j,passive:!0}),()=>{var t;const r=null==(t=l.default)?void 0:t.call(l),u=Object(n["createVNode"])("div",{ref:c,class:v("placeholder")},null);return Object(n["createVNode"])("div",{ref:o,role:"feed",class:v(),"aria-busy":a.value},["down"===e.direction?r:u,h(),m(),y(),"up"===e.direction?r:u])}}});const O=Object(a["a"])(j)},be32:function(e,t,l){"use strict";l.d(t,"a",(function(){return n})),l.d(t,"b",(function(){return o}));var a=l("7a23");const n=Symbol(),o=()=>Object(a["inject"])(n,null)},d189:function(e,t,l){}}]);