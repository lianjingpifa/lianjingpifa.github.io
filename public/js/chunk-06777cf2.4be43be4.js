(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-06777cf2"],{"13d5":function(e,t,o){"use strict";var a=o("23e7"),c=o("d58f").left,n=o("a640"),l=o("2d00"),r=o("605d"),u=!r&&l>79&&l<83,i=u||!n("reduce");a({target:"Array",proto:!0,forced:i},{reduce:function(e){var t=arguments.length;return c(this,e,t,t>1?arguments[1]:void 0)}})},"1f38":function(e,t,o){"use strict";o("d9e2");var a=o("7a23"),c=o("2af9"),n=o("eeb9"),l=o("2410"),r=o.n(l),u=o("4360"),i={__name:"addGoodModal",props:{modelValue:{type:Boolean,default:!1},detailData:{type:Object,default(){return{}}},showCount:{type:Boolean,default:!1}},emits:["update:modelValue","save","close"],setup(e,{emit:t}){const o=e,l=Object(u["a"])(),i=Object(a["computed"])(()=>l.dictMap),d=Object(a["inject"])("$Message",()=>{}),s=Object(a["ref"])({});async function b(e,t,a){if(t&&o.detailData.name!==s.value.name){const{data:e}=await Object(n["T"])({name:t})||{};if(e)return a(new Error("该商品名称已存在"))}a()}const p={name:[{required:!0,message:"请输入商品名称"},{validator:b,trigger:"blur"}]},O=Object(a["computed"])(()=>(o.detailData.goodId?"编辑":"新增")+"商品"),f=Object(a["computed"])({get(){return o.modelValue},set(e){t("update:modelValue",e),e||t("close")}}),j=Object(a["ref"])();Object(a["watch"])(()=>o.detailData,()=>{var e;null===(e=j.value)||void 0===e||e.resetFields(),s.value=r()(o.detailData)},{deep:!0});const m=Object(a["ref"])(!1);function v(){m.value=!0,j.value.validate(async e=>{if(!e)return d.error("数据校验不通过"),void(m.value=!1);try{const{_index:e,_rowKey:o,count:a,...c}=s.value,{data:l}=await Object(n["L"])(c)||{};l&&(d.success(O.value+"成功"),t("save",{...s.value}),j.value.resetFields(),f.value=!1)}catch(o){d.error("请求失败："+(o.message||o))}finally{m.value=!1}})}return(t,o)=>{const n=Object(a["resolveComponent"])("viInput"),l=Object(a["resolveComponent"])("FormItem"),r=Object(a["resolveComponent"])("viInputNumber"),u=Object(a["resolveComponent"])("Option"),d=Object(a["resolveComponent"])("viSelect"),b=Object(a["resolveComponent"])("Form"),g=Object(a["resolveComponent"])("Button"),h=Object(a["resolveComponent"])("viModal");return Object(a["openBlock"])(),Object(a["createBlock"])(h,{modelValue:f.value,"onUpdate:modelValue":o[9]||(o[9]=e=>f.value=e),title:O.value},{footer:Object(a["withCtx"])(()=>[Object(a["createVNode"])(g,{onClick:o[8]||(o[8]=e=>f.value=!1)},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("取消")]),_:1}),Object(a["createVNode"])(g,{type:"primary",onClick:v,loading:m.value},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("确定")]),_:1},8,["loading"])]),default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(b,{ref_key:"formRef",ref:j,model:s.value,rules:p,"label-width":60,onKeydown:Object(a["withKeys"])(v,["enter"]),class:"vi-modal-content"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(l,{label:"名称:",prop:"name"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(n,{modelValue:s.value.name,"onUpdate:modelValue":o[0]||(o[0]=e=>s.value.name=e)},null,8,["modelValue"])]),_:1}),Object(a["createVNode"])(l,{label:"规格:",prop:"standard"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(n,{modelValue:s.value.standard,"onUpdate:modelValue":o[1]||(o[1]=e=>s.value.standard=e)},null,8,["modelValue"])]),_:1}),Object(a["createVNode"])(l,{label:"单位:",prop:"unit"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(n,{modelValue:s.value.unit,"onUpdate:modelValue":o[2]||(o[2]=e=>s.value.unit=e)},null,8,["modelValue"])]),_:1}),Object(a["createVNode"])(l,{label:"单价:",prop:"price"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(r,{modelValue:s.value.price,"onUpdate:modelValue":o[3]||(o[3]=e=>s.value.price=e),step:.5},null,8,["modelValue"])]),_:1}),Object(a["createVNode"])(l,{label:"标签:",prop:"label"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(d,{modelValue:s.value.label,"onUpdate:modelValue":o[4]||(o[4]=e=>s.value.label=e),multiple:""},{default:Object(a["withCtx"])(()=>[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(i.value.good,(e,t)=>(Object(a["openBlock"])(),Object(a["createBlock"])(u,{key:t,value:e.id},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(a["createVNode"])(l,{label:"仓库:",prop:"store"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(d,{modelValue:s.value.store,"onUpdate:modelValue":o[5]||(o[5]=e=>s.value.store=e),multiple:""},{default:Object(a["withCtx"])(()=>[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(i.value.store,(e,t)=>(Object(a["openBlock"])(),Object(a["createBlock"])(u,{key:t,value:e.id},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(a["createVNode"])(l,{label:"图片:",prop:"picture"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(Object(a["unref"])(c["s"]),{modelValue:s.value.picture,"onUpdate:modelValue":o[6]||(o[6]=e=>s.value.picture=e)},null,8,["modelValue"])]),_:1}),e.showCount?(Object(a["openBlock"])(),Object(a["createBlock"])(l,{key:0,label:"数量:",prop:"count"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(r,{modelValue:s.value.count,"onUpdate:modelValue":o[7]||(o[7]=e=>s.value.count=e),integer:"",min:0},null,8,["modelValue"])]),_:1})):Object(a["createCommentVNode"])("",!0)]),_:1},8,["model","onKeydown"])]),_:1},8,["modelValue","title"])}}};const d=i;t["a"]=d},2410:function(e,t,o){(function(t){var o=function(){"use strict";function e(e,t){return null!=t&&e instanceof t}var o,a,c;try{o=Map}catch(s){o=function(){}}try{a=Set}catch(s){a=function(){}}try{c=Promise}catch(s){c=function(){}}function n(l,r,u,i,s){"object"===typeof r&&(u=r.depth,i=r.prototype,s=r.includeNonEnumerable,r=r.circular);var b=[],p=[],O="undefined"!=typeof t;function f(l,u){if(null===l)return null;if(0===u)return l;var j,m;if("object"!=typeof l)return l;if(e(l,o))j=new o;else if(e(l,a))j=new a;else if(e(l,c))j=new c((function(e,t){l.then((function(t){e(f(t,u-1))}),(function(e){t(f(e,u-1))}))}));else if(n.__isArray(l))j=[];else if(n.__isRegExp(l))j=new RegExp(l.source,d(l)),l.lastIndex&&(j.lastIndex=l.lastIndex);else if(n.__isDate(l))j=new Date(l.getTime());else{if(O&&t.isBuffer(l))return j=t.allocUnsafe?t.allocUnsafe(l.length):new t(l.length),l.copy(j),j;e(l,Error)?j=Object.create(l):"undefined"==typeof i?(m=Object.getPrototypeOf(l),j=Object.create(m)):(j=Object.create(i),m=i)}if(r){var v=b.indexOf(l);if(-1!=v)return p[v];b.push(l),p.push(j)}for(var g in e(l,o)&&l.forEach((function(e,t){var o=f(t,u-1),a=f(e,u-1);j.set(o,a)})),e(l,a)&&l.forEach((function(e){var t=f(e,u-1);j.add(t)})),l){var h;m&&(h=Object.getOwnPropertyDescriptor(m,g)),h&&null==h.set||(j[g]=f(l[g],u-1))}if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(l);for(g=0;g<V.length;g++){var y=V[g],w=Object.getOwnPropertyDescriptor(l,y);(!w||w.enumerable||s)&&(j[y]=f(l[y],u-1),w.enumerable||Object.defineProperty(j,y,{enumerable:!1}))}}if(s){var C=Object.getOwnPropertyNames(l);for(g=0;g<C.length;g++){var k=C[g];w=Object.getOwnPropertyDescriptor(l,k);w&&w.enumerable||(j[k]=f(l[k],u-1),Object.defineProperty(j,k,{enumerable:!1}))}}return j}return"undefined"==typeof r&&(r=!0),"undefined"==typeof u&&(u=1/0),f(l,u)}function l(e){return Object.prototype.toString.call(e)}function r(e){return"object"===typeof e&&"[object Date]"===l(e)}function u(e){return"object"===typeof e&&"[object Array]"===l(e)}function i(e){return"object"===typeof e&&"[object RegExp]"===l(e)}function d(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return n.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},n.__objToStr=l,n.__isDate=r,n.__isArray=u,n.__isRegExp=i,n.__getRegExpFlags=d,n}();e.exports&&(e.exports=o)}).call(this,o("b639").Buffer)},"2e7e":function(e,t,o){"use strict";o.r(t);o("14d9"),o("13d5");var a=o("7a23"),c=o("df7b"),n=o("b351"),l=o("eeb9"),r=o("2af9"),u=o("1f38"),i=o("4360"),d=o("6605");const s={class:"container"},b=["onClick"],p={class:"card-content"},O={class:"title"},f={class:"price-box"},j={key:0,class:"price"},m={class:"f-16 origin"},v={class:"f-16"},g={key:2,class:"ml-5"},h={key:3,class:"standard"};var V={__name:"mobile",emits:["total"],setup(e,{emit:t}){const o=Object(i["a"])(),V=Object(a["computed"])(()=>o.dictMap),y=Object(d["d"])(),w=Object(a["inject"])("$Message",()=>{}),C=Object(a["inject"])("$Modal",()=>{}),k=Object(a["inject"])("$Auth",()=>!1),N=[{name:"删除",type:"delete",color:"#f66161"},{name:"特价",type:"special",color:"#07c160"},{name:"修改",type:"change"}],x=Object(a["computed"])(()=>location.href.startsWith("https")||location.href.startsWith("http://localhost")),B=Object(a["ref"])();function _(){var e;null===(e=B.value)||void 0===e||e.reSearch()}const E=Object(a["ref"])(!1),S=Object(a["ref"])({sortBy:"updateTime",order:"DESC"}),D=Object(a["computed"])(()=>{const e=[{name:"修改时间倒序",sortBy:"updateTime",order:"DESC"},{name:"修改时间顺序",sortBy:"updateTime",order:"ASC"},{name:"价格倒序",sortBy:"price",order:"DESC"},{name:"价格顺序",sortBy:"price",order:"ASC"}];return e.map(e=>(S.value.sortBy==e.sortBy&&S.value.order==e.order&&(e.color="#2d8cf0"),e))});function I({sortBy:e,order:t}){S.value={sortBy:e,order:t},_()}const U=Object(a["ref"])(0),P=Object(a["ref"])(""),A=Object(a["ref"])(!1);function F(e){const t=V.value.good||[],o=["",...t.map(e=>e.id),"其他"];return Object(l["u"])({...e,name:P.value,label:o[U.value],...S.value})}function T({rows:e,total:o}){t("total","mobileGood",o);const a=JSON.parse(localStorage.getItem("order")||"[]"),c={};a.forEach(e=>c[e.goodId]=e.count),e.forEach(e=>{e.originPrice=e.price||0,e.originUnit=e.unit,e.originStandard=e.standard,e.count=c[e.goodId]||0})}function M(e,t){const o=JSON.parse(localStorage.getItem("order")||"[]"),a=o.findIndex(t=>t.goodId===e.goodId),c={...e,...-1===a?{}:o[a],count:t};t?-1===a?o.push(c):o.splice(a,1,c):-1!==a&&o.splice(a,1),localStorage.setItem("order",JSON.stringify(o)),window.$EventBus.$emit("badge",{mobileCashier:o.reduce((e,t)=>e+ +t.count,0)})}function R({goodId:e,name:t}){C.confirm({title:"删除商品",content:`是否确认删除${t}？`,loading:!0,onOk:async()=>{try{const{returnCode:t,data:o}=await Object(l["h"])({goodIds:""+e})||{};0===t&&o&&(w.success("删除成功"),C.remove(),_())}catch(t){w.error("删除失败："+(t.message||t))}}})}const $=Object(a["ref"])({}),J=Object(a["ref"])(!1);function K(e){k(2)&&($.value={...e},J.value=!0)}function L(e,t=$.value){"change"===e?($.value={...t},A.value=!0):"special"===e?y.push({name:"mobileSpecial",state:{params:{goodId:t.goodId,name:t.name}}}):"delete"===e&&R(t)}const z=Object(a["ref"])({});async function q(){if(!k(3))try{const{returnCode:e,data:t}=await Object(l["x"])()||{};if(0===e){const e={};t.forEach(t=>{e[t.goodId]=+t.specialPrice}),z.value=e}}catch(e){w.error("获取特价失败："+(e.message||e))}}return Object(a["onActivated"])(()=>{q(),_()}),(e,t)=>{const o=Object(a["resolveComponent"])("Icon"),l=Object(a["resolveComponent"])("van-search"),i=Object(a["resolveComponent"])("van-action-sheet"),d=Object(a["resolveComponent"])("viInputNumber");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",null,[Object(a["unref"])(k)(2)&&x.value?(Object(a["openBlock"])(),Object(a["createBlock"])(o,{key:0,type:"ios-qr-scanner",size:"28",onClick:t[0]||(t[0]=t=>e.$router.push("mobileEnter")),class:"vi-header-icon left"})):Object(a["createCommentVNode"])("",!0),Object(a["unref"])(k)(2)?(Object(a["openBlock"])(),Object(a["createBlock"])(o,{key:1,type:"ios-add",size:"34",onClick:t[1]||(t[1]=e=>L("change",{})),class:"vi-header-icon right"})):Object(a["createCommentVNode"])("",!0),Object(a["createVNode"])(l,{modelValue:P.value,"onUpdate:modelValue":t[3]||(t[3]=e=>P.value=e),shape:"round",placeholder:"请输入商品名称搜索","show-action":"",onClear:_,onSearch:_,class:"search-input"},{action:Object(a["withCtx"])(()=>[Object(a["createVNode"])(o,{type:"ios-repeat",size:"24",onClick:t[2]||(t[2]=e=>E.value=!0),class:"rotate"})]),_:1},8,["modelValue"]),Object(a["createVNode"])(i,{show:E.value,"onUpdate:show":t[4]||(t[4]=e=>E.value=e),title:"排序",actions:D.value,"cancel-text":"取消","close-on-click-action":"",onSelect:I},null,8,["show","actions"]),Object(a["createElementVNode"])("div",s,[Object(a["createVNode"])(Object(a["unref"])(c["a"]),{modelValue:U.value,"onUpdate:modelValue":t[5]||(t[5]=e=>U.value=e),onChange:_,class:"sidebar"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(Object(a["unref"])(n["a"]),{title:"全部",key:"all"}),(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(V.value.good,(e,t)=>(Object(a["openBlock"])(),Object(a["createBlock"])(Object(a["unref"])(n["a"]),{key:t,title:e.name},null,8,["title"]))),128)),Object(a["createVNode"])(Object(a["unref"])(n["a"]),{title:"其他",key:"other"})]),_:1},8,["modelValue"]),Object(a["createVNode"])(Object(a["unref"])(r["i"]),{ref_key:"listRef",ref:B,getData:F,onOnUpdate:T,class:"flex-1 h100"},{default:Object(a["withCtx"])(({item:e})=>[Object(a["createElementVNode"])("div",{class:"card",onClick:t=>K(e)},[Object(a["createVNode"])(Object(a["unref"])(r["e"]),{src:e.picture,cover:e.name,class:"card-image"},null,8,["src","cover"]),Object(a["createElementVNode"])("div",p,[Object(a["createElementVNode"])("p",O,Object(a["toDisplayString"])(e.name),1),Object(a["createElementVNode"])("div",f,[Object(a["unref"])(k)(3)||!z.value[e.goodId]?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",j,"￥"+Object(a["toDisplayString"])(e.price&&e.price.toFixed(2)),1)):(Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],{key:1},[Object(a["createElementVNode"])("span",m,"￥"+Object(a["toDisplayString"])(e.price&&e.price.toFixed(2)),1),Object(a["createElementVNode"])("span",v,"￥"+Object(a["toDisplayString"])(z.value[e.goodId].toFixed(2)),1)],64)),e.unit?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",g,"/ "+Object(a["toDisplayString"])(e.unit),1)):Object(a["createCommentVNode"])("",!0),e.standard?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",h,Object(a["toDisplayString"])(e.standard),1)):Object(a["createCommentVNode"])("",!0)]),Object(a["createVNode"])(d,{modelValue:e.count,"onUpdate:modelValue":t=>e.count=t,integer:"",min:0,onOnChange:t=>M(e,t),onClick:t[6]||(t[6]=Object(a["withModifiers"])(()=>{},["stop"])),class:"card-input"},null,8,["modelValue","onUpdate:modelValue","onOnChange"])])],8,b)]),_:1},512)]),Object(a["createVNode"])(Object(a["unref"])(u["a"]),{modelValue:A.value,"onUpdate:modelValue":t[7]||(t[7]=e=>A.value=e),detailData:$.value,onSave:_},null,8,["modelValue","detailData"]),Object(a["createVNode"])(i,{show:J.value,"onUpdate:show":t[8]||(t[8]=e=>J.value=e),title:$.value.name,actions:N,"cancel-text":"取消","close-on-click-action":"",onSelect:t[9]||(t[9]=e=>L(e.type))},null,8,["show","title"])])}}},y=(o("bf46"),o("6b0d")),w=o.n(y);const C=w()(V,[["__scopeId","data-v-9a77f6dc"]]);t["default"]=C},"5e48":function(e,t,o){},"605d":function(e,t,o){"use strict";var a=o("da84"),c=o("c6b6");e.exports="process"===c(a.process)},a640:function(e,t,o){"use strict";var a=o("d039");e.exports=function(e,t){var o=[][e];return!!o&&a((function(){o.call(null,t||function(){return 1},1)}))}},a68d:function(e,t,o){"use strict";o.d(t,"a",(function(){return i})),o.d(t,"b",(function(){return s}));var a=o("7a23"),c=o("1fba"),n=o("e5f6"),l=o("450f");const[r,u]=Object(c["a"])("sidebar"),i=Symbol(r),d={modelValue:Object(n["c"])(0)};var s=Object(a["defineComponent"])({name:r,props:d,emits:["change","update:modelValue"],setup(e,{emit:t,slots:o}){const{linkChildren:c}=Object(l["useChildren"])(i),n=()=>+e.modelValue,r=e=>{e!==n()&&(t("update:modelValue",e),t("change",e))};return c({getActive:n,setActive:r}),()=>{var e;return Object(a["createVNode"])("div",{role:"tablist",class:u()},[null==(e=o.default)?void 0:e.call(o)])}}})},b351:function(e,t,o){"use strict";o.d(t,"a",(function(){return j}));var a=o("23f9"),c=o("7a23"),n=o("1fba"),l=o("fa7c"),r=o("e5f6"),u=o("a68d"),i=o("450f"),d=o("4e5e"),s=o("8be7");const[b,p]=Object(n["a"])("sidebar-item"),O=Object(l["a"])({},d["b"],{dot:Boolean,title:String,badge:r["f"],disabled:Boolean,badgeProps:Object});var f=Object(c["defineComponent"])({name:b,props:O,emits:["click"],setup(e,{emit:t,slots:o}){const a=Object(d["c"])(),{parent:n,index:l}=Object(i["useParent"])(u["a"]);if(!n)return void 0;const r=()=>{e.disabled||(t("click",l.value),n.setActive(l.value),a())};return()=>{const{dot:t,badge:a,title:u,disabled:i}=e,d=l.value===n.getActive();return Object(c["createVNode"])("div",{role:"tab",class:p({select:d,disabled:i}),tabindex:i?void 0:0,"aria-selected":d,onClick:r},[Object(c["createVNode"])(s["a"],Object(c["mergeProps"])({dot:t,class:p("text"),content:a},e.badgeProps),{default:()=>[o.title?o.title():u]})])}}});const j=Object(a["a"])(f)},bf46:function(e,t,o){"use strict";o("5e48")},d58f:function(e,t,o){"use strict";var a=o("59ed"),c=o("7b0b"),n=o("44ad"),l=o("07fa"),r=TypeError,u=function(e){return function(t,o,u,i){a(o);var d=c(t),s=n(d),b=l(d),p=e?b-1:0,O=e?-1:1;if(u<2)while(1){if(p in s){i=s[p],p+=O;break}if(p+=O,e?p<0:b<=p)throw r("Reduce of empty array with no initial value")}for(;e?p>=0:b>p;p+=O)p in s&&(i=o(i,s[p],p,d));return i}};e.exports={left:u(!1),right:u(!0)}},df7b:function(e,t,o){"use strict";o.d(t,"a",(function(){return n}));var a=o("23f9"),c=o("a68d");const n=Object(a["a"])(c["b"])}}]);