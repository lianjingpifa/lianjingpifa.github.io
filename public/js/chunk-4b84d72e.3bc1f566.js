(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4b84d72e"],{"192b":function(e,t,a){"use strict";a("14d9");var c=a("7a23"),o=a("4360");const l={class:"detail-container"},n={class:"group-title"},r={class:"card-list"},d={class:"title"},u={class:"count"},i={class:"f-20"};var s={__name:"orderStatModal",props:{modelValue:{type:Boolean,default:!1},statOrders:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,s=Object(o["a"])(),b=Object(c["computed"])(()=>s.dictMap),O=Object(c["ref"])(window.isMobile),m=Object(c["computed"])({get(){return a.modelValue},set(e){t("update:modelValue",e)}}),j=Object(c["ref"])({});return Object(c["watch"])(()=>a.statOrders,e=>{const t=[];e.forEach(({detail:e})=>{const a=JSON.parse(e||"[]");a.forEach(({goodId:e,name:a,label:c,count:o})=>{const l=t.findIndex(t=>t.goodId===e);l>-1?t[l].count+=+o||0:t.push({goodId:e,name:a,label:c,count:+o||0})})});const a={};t.forEach(e=>{var t;const c=(null===(t=e.store)||void 0===t?void 0:t.split(",")[0])||"";a[c]?a[c].push(e):a[c]=[e]});const c={};b.value.good.forEach(e=>{c[e.id]=e.index});for(let o in a)a[o].sort((e,t)=>{var a,o;const l=null===(a=e.label)||void 0===a?void 0:a.split(",")[0],n=null===(o=t.label)||void 0===o?void 0:o.split(",")[0];return c[l]-c[n]});j.value=a}),(t,a)=>{const o=Object(c["resolveComponent"])("viEmpty"),b=Object(c["resolveComponent"])("viModal");return Object(c["openBlock"])(),Object(c["createBlock"])(b,{modelValue:m.value,"onUpdate:modelValue":a[0]||(a[0]=e=>m.value=e),title:`订单统计（${e.statOrders.length}）`,width:880},{default:Object(c["withCtx"])(()=>[Object(c["createElementVNode"])("div",l,[Object.keys(j.value).length?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createBlock"])(o,{key:0})),(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(j.value,(e,t)=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",{key:t,class:"card-group"},[Object(c["createElementVNode"])("p",n,Object(c["toDisplayString"])(Object(c["unref"])(s).translate("store",t)||"其他"),1),Object(c["createElementVNode"])("div",r,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(e,(e,t)=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",{key:t,class:Object(c["normalizeClass"])(["card",{mobile:O.value}])},[Object(c["createElementVNode"])("p",d,Object(c["toDisplayString"])(e.name),1),Object(c["createElementVNode"])("p",u,[Object(c["createTextVNode"])("X "),Object(c["createElementVNode"])("span",i,Object(c["toDisplayString"])(e.count),1)])],2))),128))])]))),128))])]),_:1},8,["modelValue","title"])}}},b=(a("b3c9"),a("6b0d")),O=a.n(b);const m=O()(s,[["__scopeId","data-v-8fb1bc94"]]);t["a"]=m},"267e":function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"c",(function(){return o})),a.d(t,"b",(function(){return l}));const c={1:"草稿",2:"已打印",3:"已作废"},o={1:"未注册",2:"待审核",3:"已验证"},l={1:"超管",2:"店长",3:"店员",9:"客户",99:"游客"}},"7e0a":function(e,t,a){"use strict";a.r(t);var c=a("8738"),o=(a("14d9"),a("7a23")),l=a("eeb9"),n=a("2af9"),r=a("267e"),d=a("6605"),u=a("192b");const i=e=>(Object(o["pushScopeId"])("data-v-75b53b2e"),e=e(),Object(o["popScopeId"])(),e),s=i(()=>Object(o["createElementVNode"])("br",null,null,-1)),b=["onClick"],O=["onClick"],m=["onClick"];var j={__name:"index",props:{curRow:{type:Object,default(){return{}}}},emits:["close"],setup(e,{emit:t}){const a=e,i=Object(d["d"])(),j=Object(o["inject"])("$Message",()=>{}),p=Object(o["inject"])("$Modal",()=>{}),v={shortcuts:[{text:"今天",value:()=>[new Date,new Date]},{text:"近2天",value:()=>[(new Date).subtract(1),new Date]},{text:"近3天",value:()=>[(new Date).subtract(2),new Date]},{text:"近一周",value:()=>[(new Date).subtract(7),new Date]}]},f=Object(o["ref"])();function V(){var e;null===(e=f.value)||void 0===e||e.changePage(1)}const h=Object(o["ref"])({}),w=Object(o["ref"])([]),N=Object(o["ref"])(!1),C=Object(o["ref"])({}),k=Object(o["computed"])(()=>[{title:"订单编号",minWidth:130,render:(e,{row:t})=>e("span",{class:"vi-link-pointer",onClick:()=>{C.value={...t,list:JSON.parse(t.detail||"[]"),total:t.total.toFixed(2)},N.value=!0}},t.orderId)},...a.curRow.userId?[]:[{title:"客户名称",key:"userName",minWidth:100}],{title:"订单状态",width:80,render:(e,{row:t})=>e("span",r["a"][t.status]||"-")},{title:"总金额",minWidth:90,render:(e,{row:t})=>e("span","￥"+t.total.toFixed(2))},{title:"修改时间",key:"updateTime",minWidth:90},{title:"修改人",key:"updateUserName",minWidth:60},{title:"创建人",key:"createUserName",minWidth:60},{title:"操作",slot:"operate",minWidth:100}]);function x(e){w.value=[];const{updateTime:t=[],createTime:c=[],...o}=h.value;return Object(l["v"])({...e,...o,updateTimeStart:t[0]&&new Date(t[0]).startOf("day").format("YYYY-MM-DD HH:mm:ss"),updateTimeEnd:t[1]&&new Date(t[1]).endOf("day").format("YYYY-MM-DD HH:mm:ss"),createTimeStart:c[0]&&new Date(c[0]).startOf("day").format("YYYY-MM-DD HH:mm:ss"),createTimeEnd:c[1]&&new Date(c[1]).endOf("day").format("YYYY-MM-DD HH:mm:ss"),userId:a.curRow.userId})}function y(e){N.value=!1,t("close"),i.push({name:"cashierMng",state:{params:{type:"change",userId:e.userId,userName:e.userName,detail:e.detail,orderId:e.orderId}}})}function g(e){N.value=!1,t("close"),i.push({name:"cashierMng",state:{params:{type:"copy",detail:e.detail}}})}function _(e=w.value){if(!e.length)return j.info("至少选中一项");p.confirm({title:"删除订单",content:"是否确认删除所选订单？",loading:!0,onOk:async()=>{try{const{returnCode:t,data:a}=await Object(l["i"])({orderIds:e.map(e=>e.orderId).join()})||{};0===t&&a&&(j.success("删除成功"),p.remove(),V(),window.$EventBus.$emit("saveOrder"))}catch(t){j.error("删除失败："+(t.message||t))}}})}const D=Object(o["ref"])(!1),B=Object(o["ref"])([]);function E(){const e=w.value;if(!e.length)return j.info("至少选中一项");B.value=e,D.value=!0}return Object(o["onActivated"])(()=>{V()}),(t,a)=>{const l=Object(o["resolveComponent"])("viInput"),d=Object(o["resolveComponent"])("FormItem"),i=Object(o["resolveComponent"])("Option"),j=Object(o["resolveComponent"])("viSelect"),p=Object(o["resolveComponent"])("Button"),I=Object(o["resolveComponent"])("viSearchForm"),T=Object(o["resolveComponent"])("viTablePage"),M=Object(o["resolveComponent"])("viModal"),S=Object(o["resolveComponent"])("viLayoutUpDown");return Object(o["openBlock"])(),Object(o["createBlock"])(S,null,{up:Object(o["withCtx"])(()=>[Object(o["createVNode"])(I,{modelValue:h.value,"onUpdate:modelValue":a[6]||(a[6]=e=>h.value=e),onSearch:V},{extral:Object(o["withCtx"])(()=>[Object(o["createVNode"])(p,{type:"error",onClick:a[5]||(a[5]=e=>_())},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("批量删除")]),_:1}),s,Object(o["createVNode"])(p,{type:"success",onClick:E},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("订单统计")]),_:1})]),default:Object(o["withCtx"])(()=>[e.curRow.userId?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createBlock"])(d,{key:0,label:"客户名称:",prop:"userName"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(l,{modelValue:h.value.userName,"onUpdate:modelValue":a[0]||(a[0]=e=>h.value.userName=e),class:"vi-width"},null,8,["modelValue"])]),_:1})),Object(o["createVNode"])(d,{label:"商品名称:",prop:"goodName"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(l,{modelValue:h.value.goodName,"onUpdate:modelValue":a[1]||(a[1]=e=>h.value.goodName=e),class:"vi-width"},null,8,["modelValue"])]),_:1}),Object(o["createVNode"])(d,{label:"订单状态:",prop:"status"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(j,{modelValue:h.value.status,"onUpdate:modelValue":a[2]||(a[2]=e=>h.value.status=e),class:"vi-width"},{default:Object(o["withCtx"])(()=>[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(Object(o["unref"])(r["a"]),(e,t)=>(Object(o["openBlock"])(),Object(o["createBlock"])(i,{key:t,value:t},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(o["createVNode"])(d,{label:"修改时间:",prop:"updateTime"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(Object(o["unref"])(c["a"]),{modelValue:h.value.updateTime,"onUpdate:modelValue":a[3]||(a[3]=e=>h.value.updateTime=e),type:"daterange",options:v,placeholder:"请选择",class:"vi-width"},null,8,["modelValue"])]),_:1}),Object(o["createVNode"])(d,{label:"创建时间:",prop:"createTime"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(Object(o["unref"])(c["a"]),{modelValue:h.value.createTime,"onUpdate:modelValue":a[4]||(a[4]=e=>h.value.createTime=e),type:"daterange",options:v,placeholder:"请选择",class:"vi-width"},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),down:Object(o["withCtx"])(()=>[Object(o["createVNode"])(T,{ref_key:"tableRef",ref:f,columns:k.value,getData:x,addSelect:"",addIndex:"",onOnSelectionChange:a[7]||(a[7]=e=>w.value=e)},{operate:Object(o["withCtx"])(({row:e})=>[Object(o["createElementVNode"])("a",{onClick:t=>y(e)},"修改",8,b),Object(o["createElementVNode"])("a",{onClick:t=>_([e]),class:"vi-red-pointer"},"删除",8,O),Object(o["createElementVNode"])("a",{onClick:t=>g(e),class:"vi-green-pointer"},"一键复制",8,m)]),_:1},8,["columns"]),Object(o["createVNode"])(M,{modelValue:N.value,"onUpdate:modelValue":a[12]||(a[12]=e=>N.value=e),title:"订单详情",width:880},{footer:Object(o["withCtx"])(()=>[Object(o["createVNode"])(p,{onClick:a[8]||(a[8]=e=>N.value=!1)},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("取消")]),_:1}),Object(o["createVNode"])(p,{type:"primary",onClick:a[9]||(a[9]=e=>y(C.value))},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("去修改")]),_:1}),Object(o["createVNode"])(p,{type:"primary",onClick:a[10]||(a[10]=e=>g(C.value))},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("一键复制")]),_:1}),Object(o["createVNode"])(p,{type:"error",onClick:a[11]||(a[11]=e=>_([C.value]))},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("删除")]),_:1})]),default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(Object(o["unref"])(n["m"]),{list:C.value.list,total:C.value.total,data:C.value,class:"order-detail"},null,8,["list","total","data"])]),_:1},8,["modelValue"]),Object(o["createVNode"])(Object(o["unref"])(u["a"]),{modelValue:D.value,"onUpdate:modelValue":a[13]||(a[13]=e=>D.value=e),statOrders:B.value},null,8,["modelValue","statOrders"])]),_:1})}}},p=(a("8ab5"),a("6b0d")),v=a.n(p);const f=v()(j,[["__scopeId","data-v-75b53b2e"]]);t["default"]=f},8685:function(e,t,a){},"8ab5":function(e,t,a){"use strict";a("8685")},b3c9:function(e,t,a){"use strict";a("ba3c")},ba3c:function(e,t,a){}}]);