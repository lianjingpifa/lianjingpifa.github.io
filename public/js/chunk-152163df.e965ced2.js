(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-152163df"],{"0ae8":function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var r=a("7a23"),i=a("fa7c"),n=a("6872"),o=a("e561");let l;const c={loop:!0,images:[],maxZoom:3,minZoom:1/3,onScale:void 0,onClose:void 0,onChange:void 0,vertical:!1,teleport:"body",className:"",showIndex:!0,closeable:!1,closeIcon:"clear",transition:void 0,beforeClose:void 0,doubleScale:!0,overlayStyle:void 0,overlayClass:void 0,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeOnClickOverlay:!0,closeIconPosition:"top-right"};function s(){({instance:l}=Object(n["a"])({setup(){const{state:e,toggle:t}=Object(n["b"])(),a=()=>{e.images=[]};return()=>Object(r["createVNode"])(o["a"],Object(r["mergeProps"])(e,{onClosed:a,"onUpdate:show":t}),null)}}))}const u=(e,t=0)=>{if(i["d"])return l||s(),e=Array.isArray(e)?{images:e,startPosition:t}:e,l.open(Object(i["a"])({},c,e)),l}},"4ad8":function(e,t,a){"use strict";a("e842")},7171:function(e,t,a){"use strict";a.r(t);var r=a("7a23"),i=a("23f9"),n=a("e5f6"),o=a("fa7c"),l=a("5aa0"),c=a("1fba");const[s,u,d]=Object(c["a"])("uploader");function f(e,t){return new Promise(a=>{if("file"===t)return void a();const r=new FileReader;r.onload=e=>{a(e.target.result)},"dataUrl"===t?r.readAsDataURL(e):"text"===t&&r.readAsText(e)})}function p(e,t){return Object(o["o"])(e).some(e=>!!e.file&&(Object(o["g"])(t)?t(e.file):e.file.size>+t))}function m(e,t){const a=[],r=[];return e.forEach(e=>{p(e,t)?r.push(e):a.push(e)}),{valid:a,invalid:r}}const b=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg|avif)/i,h=e=>b.test(e);function v(e){return!!e.isImage||(e.file&&e.file.type?0===e.file.type.indexOf("image"):e.url?h(e.url):"string"===typeof e.content&&0===e.content.indexOf("data:image"))}var g=a("450f"),w=a("efd9"),y=a("9a1c"),j=a("0ae8"),O=a("9b55"),U=a("aee2"),x=a("5913"),k=Object(r["defineComponent"])({props:{name:n["f"],item:Object(n["d"])(Object),index:Number,imageFit:String,lazyLoad:Boolean,deletable:Boolean,reupload:Boolean,previewSize:[Number,String,Array],beforeDelete:Function},emits:["delete","preview","reupload"],setup(e,{emit:t,slots:a}){const i=()=>{const{status:t,message:a}=e.item;if("uploading"===t||"failed"===t){const e="failed"===t?Object(r["createVNode"])(y["a"],{name:"close",class:u("mask-icon")},null):Object(r["createVNode"])(x["a"],{class:u("loading")},null),i=Object(o["f"])(a)&&""!==a;return Object(r["createVNode"])("div",{class:u("mask")},[e,i&&Object(r["createVNode"])("div",{class:u("mask-message")},[a])])}},n=a=>{const{name:r,item:i,index:n,beforeDelete:o}=e;a.stopPropagation(),Object(O["a"])(o,{args:[i,{name:r,index:n}],done:()=>t("delete")})},c=()=>t("preview"),s=()=>t("reupload"),f=()=>{if(e.deletable&&"uploading"!==e.item.status){const e=a["preview-delete"];return Object(r["createVNode"])("div",{role:"button",class:u("preview-delete",{shadow:!e}),tabindex:0,"aria-label":d("delete"),onClick:n},[e?e():Object(r["createVNode"])(y["a"],{name:"cross",class:u("preview-delete-icon")},null)])}},p=()=>{if(a["preview-cover"]){const{index:t,item:i}=e;return Object(r["createVNode"])("div",{class:u("preview-cover")},[a["preview-cover"](Object(o["a"])({index:t},i))])}},m=()=>{const{item:t,lazyLoad:a,imageFit:i,previewSize:n,reupload:o}=e;return v(t)?Object(r["createVNode"])(U["a"],{fit:i,src:t.objectUrl||t.content||t.url,class:u("preview-image"),width:Array.isArray(n)?n[0]:n,height:Array.isArray(n)?n[1]:n,lazyLoad:a,onClick:o?s:c},{default:p}):Object(r["createVNode"])("div",{class:u("file"),style:Object(l["f"])(e.previewSize)},[Object(r["createVNode"])(y["a"],{class:u("file-icon"),name:"description"},null),Object(r["createVNode"])("div",{class:[u("file-name"),"van-ellipsis"]},[t.file?t.file.name:t.url]),p()])};return()=>Object(r["createVNode"])("div",{class:u("preview")},[m(),i(),f()])}});const B={name:Object(n["c"])(""),accept:Object(n["e"])("image/*"),capture:String,multiple:Boolean,disabled:Boolean,readonly:Boolean,lazyLoad:Boolean,maxCount:Object(n["c"])(1/0),imageFit:Object(n["e"])("cover"),resultType:Object(n["e"])("dataUrl"),uploadIcon:Object(n["e"])("photograph"),uploadText:String,deletable:n["g"],reupload:Boolean,afterRead:Function,showUpload:n["g"],modelValue:Object(n["a"])(),beforeRead:Function,beforeDelete:Function,previewSize:[Number,String,Array],previewImage:n["g"],previewOptions:Object,previewFullImage:n["g"],maxSize:{type:[Number,String,Function],default:1/0}};var R=Object(r["defineComponent"])({name:s,props:B,emits:["delete","oversize","clickUpload","closePreview","clickPreview","clickReupload","update:modelValue"],setup(e,{emit:t,slots:a}){const i=Object(r["ref"])(),n=[],c=Object(r["ref"])(-1),s=Object(r["ref"])(!1),d=(t=e.modelValue.length)=>({name:e.name,index:t}),b=()=>{i.value&&(i.value.value="")},h=a=>{if(b(),p(a,e.maxSize)){if(!Array.isArray(a))return void t("oversize",a,d());{const r=m(a,e.maxSize);if(a=r.valid,t("oversize",r.invalid,d()),!a.length)return}}if(a=Object(r["reactive"])(a),c.value>-1){const r=[...e.modelValue];r.splice(c.value,1,a),t("update:modelValue",r),c.value=-1}else t("update:modelValue",[...e.modelValue,...Object(o["o"])(a)]);e.afterRead&&e.afterRead(a,d())},O=t=>{const{maxCount:a,modelValue:r,resultType:i}=e;if(Array.isArray(t)){const e=+a-r.length;t.length>e&&(t=t.slice(0,e)),Promise.all(t.map(e=>f(e,i))).then(e=>{const a=t.map((t,a)=>{const r={file:t,status:"",message:"",objectUrl:URL.createObjectURL(t)};return e[a]&&(r.content=e[a]),r});h(a)})}else f(t,i).then(e=>{const a={file:t,status:"",message:"",objectUrl:URL.createObjectURL(t)};e&&(a.content=e),h(a)})},U=t=>{const{files:a}=t.target;if(e.disabled||!a||!a.length)return;const r=1===a.length?a[0]:[].slice.call(a);if(e.beforeRead){const t=e.beforeRead(r,d());if(!t)return void b();if(Object(o["k"])(t))return void t.then(e=>{O(e||r)}).catch(b)}O(r)};let x;const B=()=>t("closePreview"),R=t=>{if(e.previewFullImage){const a=e.modelValue.filter(v),r=a.map(e=>(e.objectUrl&&!e.url&&"failed"!==e.status&&(e.url=e.objectUrl,n.push(e.url)),e.url)).filter(Boolean);x=Object(j["a"])(Object(o["a"])({images:r,startPosition:a.indexOf(t),onClose:B},e.previewOptions))}},V=()=>{x&&x.close()},A=(a,r)=>{const i=e.modelValue.slice(0);i.splice(r,1),t("update:modelValue",i),t("delete",a,d(r))},P=e=>{s.value=!0,c.value=e,Object(r["nextTick"])(()=>D())},C=()=>{s.value||(c.value=-1),s.value=!1},S=(i,n)=>{const l=["imageFit","deletable","reupload","previewSize","beforeDelete"],c=Object(o["a"])(Object(o["n"])(e,l),Object(o["n"])(i,l,!0));return Object(r["createVNode"])(k,Object(r["mergeProps"])({item:i,index:n,onClick:()=>t(e.reupload?"clickReupload":"clickPreview",i,d(n)),onDelete:()=>A(i,n),onPreview:()=>R(i),onReupload:()=>P(n)},Object(o["n"])(e,["name","lazyLoad"]),c),Object(o["n"])(a,["preview-cover","preview-delete"]))},T=()=>{if(e.previewImage)return e.modelValue.map(S)},z=e=>t("clickUpload",e),L=()=>{if(e.modelValue.length>=+e.maxCount&&!e.reupload)return;const t=e.modelValue.length>=+e.maxCount&&e.reupload,n=e.readonly?null:Object(r["createVNode"])("input",{ref:i,type:"file",class:u("input"),accept:e.accept,capture:e.capture,multiple:e.multiple&&-1===c.value,disabled:e.disabled,onChange:U,onClick:C},null);return a.default?Object(r["withDirectives"])(Object(r["createVNode"])("div",{class:u("input-wrapper"),onClick:z},[a.default(),n]),[[r["vShow"],!t]]):Object(r["withDirectives"])(Object(r["createVNode"])("div",{class:u("upload",{readonly:e.readonly}),style:Object(l["f"])(e.previewSize),onClick:z},[Object(r["createVNode"])(y["a"],{name:e.uploadIcon,class:u("upload-icon")},null),e.uploadText&&Object(r["createVNode"])("span",{class:u("upload-text")},[e.uploadText]),n]),[[r["vShow"],e.showUpload&&!t]])},D=()=>{i.value&&!e.disabled&&i.value.click()};return Object(r["onBeforeUnmount"])(()=>{n.forEach(e=>URL.revokeObjectURL(e))}),Object(w["a"])({chooseFile:D,closeImagePreview:V}),Object(g["useCustomFieldValue"])(()=>e.modelValue),()=>Object(r["createVNode"])("div",{class:u()},[Object(r["createVNode"])("div",{class:u("wrapper",{disabled:e.disabled})},[T(),L()])])}});const V=Object(i["a"])(R);var A=a("7c8d"),P=a.n(A),C=a("eeb9"),S={__name:"index",props:{modelValue:{type:String,default:""}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,i=Object(r["inject"])("$Message",()=>{}),n=sessionStorage.getItem("imagePrefix"),o=Object(r["ref"])([]);async function l(e){return new Promise((t,a)=>{new P.a(e,{quality:.8,success(e){const a=new File([e],e.name,{type:e.type});t(a)},error(e){a(e)}})})}async function c(e){try{e.status="uploading",e.message="上传中...";const t=await l(e.file),a=new FormData;a.append("file",t);const{returnCode:r,data:i}=await Object(C["R"])(a)||{};0===r&&(e.url=`${n}${i}`,e.originalUrl=i,e.status="",e.message="")}catch(t){e.status="failed",e.message="上传失败",i.error("网络超时")}}function s(e){"failed"===e.status&&c(e)}return Object(r["watch"])(()=>a.modelValue,e=>{o.value=e?e.split(",").map(e=>({originalUrl:e,url:`${n}${e}`})):[]},{immediate:!0}),Object(r["watch"])(()=>o.value,e=>{e.every(e=>e.originalUrl)&&t("update:modelValue",e.map(e=>e.originalUrl).join(","))},{deep:!0}),(e,t)=>(Object(r["openBlock"])(),Object(r["createBlock"])(Object(r["unref"])(V),{modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=e=>o.value=e),accept:"image/*","after-read":c,onClickPreview:s,class:"viUploadImg"},null,8,["modelValue"]))}},T=(a("4ad8"),a("6b0d")),z=a.n(T);const L=z()(S,[["__scopeId","data-v-653183dc"]]);t["default"]=L},"7c8d":function(e,t,a){
/*!
 * Compressor.js v1.2.1
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2023-02-28T14:09:41.732Z
 */
(function(t,a){e.exports=a()})(0,(function(){"use strict";function e(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function t(t){for(var a=1;a<arguments.length;a++){var r=null!=arguments[a]?arguments[a]:{};a%2?e(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function i(e,t,a){return t&&r(e.prototype,t),a&&r(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function n(e,t,a){return t=c(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},o.apply(this,arguments)}function l(e,t){if("object"!==typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function c(e){var t=l(e,"string");return"symbol"===typeof t?t:String(t)}var s={exports:{}};(function(e){"undefined"!==typeof window&&function(t){var a=t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype,r=t.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),i=r&&t.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),n=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,o=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,l=(r||n)&&t.atob&&t.ArrayBuffer&&t.Uint8Array&&function(e){var t,a,l,c,s,u,d,f,p;if(t=e.match(o),!t)throw new Error("invalid data URI");for(a=t[2]?t[1]:"text/plain"+(t[3]||";charset=US-ASCII"),l=!!t[4],c=e.slice(t[0].length),s=l?atob(c):decodeURIComponent(c),u=new ArrayBuffer(s.length),d=new Uint8Array(u),f=0;f<s.length;f+=1)d[f]=s.charCodeAt(f);return r?new Blob([i?d:u],{type:a}):(p=new n,p.append(u),p.getBlob(a))};t.HTMLCanvasElement&&!a.toBlob&&(a.mozGetAsFile?a.toBlob=function(e,t,r){var i=this;setTimeout((function(){r&&a.toDataURL&&l?e(l(i.toDataURL(t,r))):e(i.mozGetAsFile("blob",t))}))}:a.toDataURL&&l&&(a.msToBlob?a.toBlob=function(e,t,r){var i=this;setTimeout((function(){(t&&"image/png"!==t||r)&&a.toDataURL&&l?e(l(i.toDataURL(t,r))):e(i.msToBlob(t))}))}:a.toBlob=function(e,t,a){var r=this;setTimeout((function(){e(l(r.toDataURL(t,a)))}))})),e.exports?e.exports=l:t.dataURLtoBlob=l}(window)})(s);var u=s.exports,d=function(e){return"undefined"!==typeof Blob&&(e instanceof Blob||"[object Blob]"===Object.prototype.toString.call(e))},f={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},p="undefined"!==typeof window&&"undefined"!==typeof window.document,m=p?window:{},b=function(e){return e>0&&e<1/0},h=Array.prototype.slice;function v(e){return Array.from?Array.from(e):h.call(e)}var g=/^image\/.+$/;function w(e){return g.test(e)}function y(e){var t=w(e)?e.substr(6):"";return"jpeg"===t&&(t="jpg"),".".concat(t)}var j=String.fromCharCode;function O(e,t,a){var r,i="";for(a+=t,r=t;r<a;r+=1)i+=j(e.getUint8(r));return i}var U=m.btoa;function x(e,t){var a=[],r=8192,i=new Uint8Array(e);while(i.length>0)a.push(j.apply(null,v(i.subarray(0,r)))),i=i.subarray(r);return"data:".concat(t,";base64,").concat(U(a.join("")))}function k(e){var t,a=new DataView(e);try{var r,i,n;if(255===a.getUint8(0)&&216===a.getUint8(1)){var o=a.byteLength,l=2;while(l+1<o){if(255===a.getUint8(l)&&225===a.getUint8(l+1)){i=l;break}l+=1}}if(i){var c=i+4,s=i+10;if("Exif"===O(a,c,4)){var u=a.getUint16(s);if(r=18761===u,(r||19789===u)&&42===a.getUint16(s+2,r)){var d=a.getUint32(s+4,r);d>=8&&(n=s+d)}}}if(n){var f,p,m=a.getUint16(n,r);for(p=0;p<m;p+=1)if(f=n+12*p+2,274===a.getUint16(f,r)){f+=8,t=a.getUint16(f,r),a.setUint16(f,1,r);break}}}catch(b){t=1}return t}function B(e){var t=0,a=1,r=1;switch(e){case 2:a=-1;break;case 3:t=-180;break;case 4:r=-1;break;case 5:t=90,r=-1;break;case 6:t=90;break;case 7:t=90,a=-1;break;case 8:t=-90;break}return{rotate:t,scaleX:a,scaleY:r}}var R=/\.\d*(?:0|9){12}\d*$/;function V(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return R.test(e)?Math.round(e*t)/t:e}function A(e){var t=e.aspectRatio,a=e.height,r=e.width,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",n=b(r),o=b(a);if(n&&o){var l=a*t;("contain"===i||"none"===i)&&l>r||"cover"===i&&l<r?a=r/t:r=a*t}else n?a=r/t:o&&(r=a*t);return{width:r,height:a}}function P(e){var t=v(new Uint8Array(e)),a=t.length,r=[],i=0;while(i+3<a){var n=t[i],o=t[i+1];if(255===n&&218===o)break;if(255===n&&216===o)i+=2;else{var l=256*t[i+2]+t[i+3],c=i+l+2,s=t.slice(i,c);r.push(s),i=c}}return r.reduce((function(e,t){return 255===t[0]&&225===t[1]?e.concat(t):e}),[])}function C(e,t){var a=v(new Uint8Array(e));if(255!==a[2]||224!==a[3])return e;var r=256*a[4]+a[5],i=[255,216].concat(t,a.slice(4+r));return new Uint8Array(i)}var S=m.ArrayBuffer,T=m.FileReader,z=m.URL||m.webkitURL,L=/\.\w+$/,D=m.Compressor,F=function(){function e(r,i){a(this,e),this.file=r,this.exif=[],this.image=new Image,this.options=t(t({},f),i),this.aborted=!1,this.result=null,this.init()}return i(e,[{key:"init",value:function(){var e=this,t=this.file,a=this.options;if(d(t)){var r=t.type;if(w(r))if(z&&T){S||(a.checkOrientation=!1,a.retainExif=!1);var i="image/jpeg"===r,n=i&&a.checkOrientation,l=i&&a.retainExif;if(!z||n||l){var c=new T;this.reader=c,c.onload=function(a){var i=a.target,c=i.result,s={},u=1;n&&(u=k(c),u>1&&o(s,B(u))),l&&(e.exif=P(c)),s.url=n||l?!z||u>1?x(c,r):z.createObjectURL(t):c,e.load(s)},c.onabort=function(){e.fail(new Error("Aborted to read the image with FileReader."))},c.onerror=function(){e.fail(new Error("Failed to read the image with FileReader."))},c.onloadend=function(){e.reader=null},n||l?c.readAsArrayBuffer(t):c.readAsDataURL(t)}else this.load({url:z.createObjectURL(t)})}else this.fail(new Error("The current browser does not support image compression."));else this.fail(new Error("The first argument must be an image File or Blob object."))}else this.fail(new Error("The first argument must be a File or Blob object."))}},{key:"load",value:function(e){var a=this,r=this.file,i=this.image;i.onload=function(){a.draw(t(t({},e),{},{naturalWidth:i.naturalWidth,naturalHeight:i.naturalHeight}))},i.onabort=function(){a.fail(new Error("Aborted to load the image."))},i.onerror=function(){a.fail(new Error("Failed to load the image."))},m.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(m.navigator.userAgent)&&(i.crossOrigin="anonymous"),i.alt=r.name,i.src=e.url}},{key:"draw",value:function(e){var t=this,a=e.naturalWidth,r=e.naturalHeight,i=e.rotate,n=void 0===i?0:i,o=e.scaleX,l=void 0===o?1:o,c=e.scaleY,s=void 0===c?1:c,d=this.file,f=this.image,p=this.options,m=document.createElement("canvas"),h=m.getContext("2d"),v=Math.abs(n)%180===90,g=("contain"===p.resize||"cover"===p.resize)&&b(p.width)&&b(p.height),y=Math.max(p.maxWidth,0)||1/0,j=Math.max(p.maxHeight,0)||1/0,O=Math.max(p.minWidth,0)||0,U=Math.max(p.minHeight,0)||0,k=a/r,B=p.width,R=p.height;if(v){var P=[j,y];y=P[0],j=P[1];var S=[U,O];O=S[0],U=S[1];var z=[R,B];B=z[0],R=z[1]}g&&(k=B/R);var L=A({aspectRatio:k,width:y,height:j},"contain");y=L.width,j=L.height;var D=A({aspectRatio:k,width:O,height:U},"cover");if(O=D.width,U=D.height,g){var F=A({aspectRatio:k,width:B,height:R},p.resize);B=F.width,R=F.height}else{var E=A({aspectRatio:k,width:B,height:R}),N=E.width;B=void 0===N?a:N;var I=E.height;R=void 0===I?r:I}B=Math.floor(V(Math.min(Math.max(B,O),y))),R=Math.floor(V(Math.min(Math.max(R,U),j)));var M=-B/2,H=-R/2,W=B,$=R,q=[];if(g){var _=0,G=0,J=a,K=r,X=A({aspectRatio:k,width:a,height:r},{contain:"cover",cover:"contain"}[p.resize]);J=X.width,K=X.height,_=(a-J)/2,G=(r-K)/2,q.push(_,G,J,K)}if(q.push(M,H,W,$),v){var Y=[R,B];B=Y[0],R=Y[1]}m.width=B,m.height=R,w(p.mimeType)||(p.mimeType=d.type);var Z="transparent";d.size>p.convertSize&&p.convertTypes.indexOf(p.mimeType)>=0&&(p.mimeType="image/jpeg");var Q="image/jpeg"===p.mimeType;if(Q&&(Z="#fff"),h.fillStyle=Z,h.fillRect(0,0,B,R),p.beforeDraw&&p.beforeDraw.call(this,h,m),!this.aborted&&(h.save(),h.translate(B/2,R/2),h.rotate(n*Math.PI/180),h.scale(l,s),h.drawImage.apply(h,[f].concat(q)),h.restore(),p.drew&&p.drew.call(this,h,m),!this.aborted)){var ee=function(e){if(!t.aborted){var i=function(e){return t.done({naturalWidth:a,naturalHeight:r,result:e})};if(e&&Q&&p.retainExif&&t.exif&&t.exif.length>0){var n=function(e){return i(u(x(C(e,t.exif),p.mimeType)))};if(e.arrayBuffer)e.arrayBuffer().then(n).catch((function(){t.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))}));else{var o=new T;t.reader=o,o.onload=function(e){var t=e.target;n(t.result)},o.onabort=function(){t.fail(new Error("Aborted to read the compressed image with FileReader."))},o.onerror=function(){t.fail(new Error("Failed to read the compressed image with FileReader."))},o.onloadend=function(){t.reader=null},o.readAsArrayBuffer(e)}}else i(e)}};m.toBlob?m.toBlob(ee,p.mimeType,p.quality):ee(u(m.toDataURL(p.mimeType,p.quality)))}}},{key:"done",value:function(e){var t=e.naturalWidth,a=e.naturalHeight,r=e.result,i=this.file,n=this.image,o=this.options;if(z&&0===n.src.indexOf("blob:")&&z.revokeObjectURL(n.src),r)if(o.strict&&!o.retainExif&&r.size>i.size&&o.mimeType===i.type&&!(o.width>t||o.height>a||o.minWidth>t||o.minHeight>a||o.maxWidth<t||o.maxHeight<a))r=i;else{var l=new Date;r.lastModified=l.getTime(),r.lastModifiedDate=l,r.name=i.name,r.name&&r.type!==i.type&&(r.name=r.name.replace(L,y(r.type)))}else r=i;this.result=r,o.success&&o.success.call(this,r)}},{key:"fail",value:function(e){var t=this.options;if(!t.error)throw e;t.error.call(this,e)}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=D,e}},{key:"setDefaults",value:function(e){o(f,e)}}]),e}();return F}))},e842:function(e,t,a){}}]);