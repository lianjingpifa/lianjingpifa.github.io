(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a54c676e"],{"16f7":function(e,t,c){"use strict";c.r(t);var o=c("7a23"),a=c("eeb9");const l={class:"mb-10"},n=["onClick"],r={key:1,class:"flex-cc"},u=["onClick"];var d={__name:"index",props:{curRow:{type:Object,default(){return{}}}},setup(e){const t=e,c=Object(o["inject"])("$Message",()=>{}),d=Object(o["inject"])("$Modal",()=>{}),i=Object(o["computed"])(()=>[...t.curRow.userId?[]:[{title:"客户名称",key:"userName"}],...t.curRow.goodId?[]:[{title:"商品名称",key:"goodName"}],{title:"原价",render:(e,{row:t})=>e("span","￥"+(t.originPrice||0))},{title:"特价（点击修改）",slot:"special",width:240},{title:"修改时间",key:"updateTime",width:160},{title:"修改人",key:"updateUserName"},{title:"操作",slot:"operate",width:100}]),s=Object(o["ref"])({}),b=Object(o["ref"])([]),j=Object(o["ref"])(-1),O=Object(o["ref"])(0),p=Object(o["ref"])();function m(){var e;null===(e=p.value)||void 0===e||e.changePage(1)}function v(e){return b.value=[],j.value=-1,Object(a["w"])({...e,...s.value,...t.curRow})}async function V(e){try{const{returnCode:t,data:o}=await Object(a["N"])({list:e})||{};0===t&&o&&(c.success("保存成功"),m())}catch(t){c.error("保存失败："+(t.message||t))}}function w(){if(!b.value.length)return c.info("至少勾选一条数据");V(b.value.map(e=>(e.specialPrice+=O.value,e)))}function k(e=b.value){if(!e.length)return c.info("至少选中一项");d.confirm({title:"删除特价",content:"是否确认删除所选特价？",loading:!0,onOk:async()=>{try{const{returnCode:t,data:o}=await Object(a["j"])({list:e.map(e=>({userId:e.userId,goodId:e.goodId}))})||{};0===t&&o&&(c.success("删除成功"),d.remove(),m())}catch(t){c.error("删除失败："+(t.message||t))}}})}return Object(o["onActivated"])(()=>{m()}),(t,c)=>{const a=Object(o["resolveComponent"])("viInput"),d=Object(o["resolveComponent"])("FormItem"),C=Object(o["resolveComponent"])("viInputNumber"),f=Object(o["resolveComponent"])("Button"),N=Object(o["resolveComponent"])("viSearchForm"),h=Object(o["resolveComponent"])("viTablePage"),x=Object(o["resolveComponent"])("viLayoutUpDown");return Object(o["openBlock"])(),Object(o["createBlock"])(x,null,{up:Object(o["withCtx"])(()=>[Object(o["createVNode"])(N,{modelValue:s.value,"onUpdate:modelValue":c[4]||(c[4]=e=>s.value=e),onSearch:m},{extral:Object(o["withCtx"])(()=>[Object(o["createVNode"])(f,{type:"error",onClick:c[3]||(c[3]=e=>k())},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("批量删除")]),_:1})]),default:Object(o["withCtx"])(()=>[e.curRow.userId?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createBlock"])(d,{key:0,label:"客户名称:",prop:"userName"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(a,{modelValue:s.value.userName,"onUpdate:modelValue":c[0]||(c[0]=e=>s.value.userName=e)},null,8,["modelValue"])]),_:1})),e.curRow.goodId?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createBlock"])(d,{key:1,label:"商品名称:",prop:"goodName"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(a,{modelValue:s.value.goodName,"onUpdate:modelValue":c[1]||(c[1]=e=>s.value.goodName=e)},null,8,["modelValue"])]),_:1})),Object(o["createElementVNode"])("div",l,[Object(o["createTextVNode"])(" 勾选数据批量调整： "),Object(o["createVNode"])(C,{modelValue:O.value,"onUpdate:modelValue":c[2]||(c[2]=e=>O.value=e),step:.5,onOnEnter:w,class:"step-input"},null,8,["modelValue"]),Object(o["createVNode"])(f,{type:"primary",onClick:w,class:"ml-10"},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("确认")]),_:1})])]),_:1},8,["modelValue"])]),down:Object(o["withCtx"])(()=>[Object(o["createVNode"])(h,{ref_key:"tableRef",ref:p,columns:i.value,getData:v,addSelect:"",addIndex:"",onOnSelectionChange:c[6]||(c[6]=e=>b.value=e)},{special:Object(o["withCtx"])(({row:e,index:t})=>[j.value!=t?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",{key:0,class:"vi-link-pointer",onClick:e=>j.value=t}," ￥ "+Object(o["toDisplayString"])(e.specialPrice&&e.specialPrice.toFixed(2)),9,n)):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",r,[Object(o["createTextVNode"])(" ￥ "),Object(o["createVNode"])(C,{modelValue:e.specialPrice,"onUpdate:modelValue":t=>e.specialPrice=t,step:.5},null,8,["modelValue","onUpdate:modelValue"]),Object(o["createVNode"])(f,{onClick:c[5]||(c[5]=e=>j.value=-1),class:"ml-10"},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("取消")]),_:1}),Object(o["createVNode"])(f,{type:"primary",onClick:t=>V([e])},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("确认")]),_:2},1032,["onClick"])]))]),operate:Object(o["withCtx"])(({row:e})=>[Object(o["createElementVNode"])("a",{onClick:t=>k([e]),class:"vi-red-pointer"},"删除",8,u)]),_:1},8,["columns"])]),_:1})}}},i=(c("5ac2"),c("6b0d")),s=c.n(i);const b=s()(d,[["__scopeId","data-v-3d004416"]]);t["default"]=b},"5ac2":function(e,t,c){"use strict";c("b245")},b245:function(e,t,c){}}]);