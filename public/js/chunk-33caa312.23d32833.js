(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-33caa312","chunk-7b62ec32","chunk-6bc03998"],{"16f7":function(e,t,o){"use strict";o.r(t);var a=o("7a23"),n=o("eeb9");const c={class:"mb-10"},l=["onClick"],r={key:1,class:"flex-cc"},i=["onClick"];var u={__name:"index",props:{curRow:{type:Object,default(){return{}}}},setup(e){const t=e,o=Object(a["inject"])("$Message",()=>{}),u=Object(a["inject"])("$Modal",()=>{}),s=Object(a["computed"])(()=>[...t.curRow.userId?[]:[{title:"客户名称",key:"userName"}],...t.curRow.goodId?[]:[{title:"商品名称",key:"goodName"}],{title:"特价（点击修改）",slot:"special",width:300},{title:"修改时间",key:"updateTime",width:160},{title:"修改人",key:"updateUserName",width:100},{title:"操作",slot:"operate",width:150}]),d=Object(a["ref"])({}),b=Object(a["ref"])([]),p=Object(a["ref"])(-1),O=Object(a["ref"])(0),j=Object(a["ref"])();function f(){var e;null===(e=j.value)||void 0===e||e.changePage(1)}function m(e){return b.value=[],p.value=-1,Object(n["w"])({...e,...d.value,...t.curRow})}async function v(e){try{const{returnCode:t,data:a}=await Object(n["M"])({list:e})||{};0===t&&a&&(o.success("保存成功"),f())}catch(t){o.error("保存失败："+(t.message||t))}}function h(){if(!b.value.length)return o.info("至少勾选一条数据");v(b.value.map(e=>(e.specialPrice+=O.value,e)))}function g(e=b.value){if(!e.length)return o.info("至少选中一项");u.confirm({title:"删除特价",content:"是否确认删除所选特价？",loading:!0,onOk:async()=>{try{const{returnCode:t,data:a}=await Object(n["j"])({list:e.map(e=>({userId:e.userId,goodId:e.goodId}))})||{};0===t&&a&&(o.success("删除成功"),u.remove(),f())}catch(t){o.error("删除失败："+(t.message||t))}}})}return Object(a["onActivated"])(()=>{f()}),(t,o)=>{const n=Object(a["resolveComponent"])("viInput"),u=Object(a["resolveComponent"])("FormItem"),V=Object(a["resolveComponent"])("viInputNumber"),y=Object(a["resolveComponent"])("Button"),w=Object(a["resolveComponent"])("viSearchForm"),C=Object(a["resolveComponent"])("viTablePage"),k=Object(a["resolveComponent"])("viLayoutUpDown");return Object(a["openBlock"])(),Object(a["createBlock"])(k,null,{up:Object(a["withCtx"])(()=>[Object(a["createVNode"])(w,{modelValue:d.value,"onUpdate:modelValue":o[4]||(o[4]=e=>d.value=e),onSearch:f},{extral:Object(a["withCtx"])(()=>[Object(a["createVNode"])(y,{type:"error",onClick:o[3]||(o[3]=e=>g())},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("批量删除")]),_:1})]),default:Object(a["withCtx"])(()=>[e.curRow.userId?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createBlock"])(u,{key:0,label:"客户名称:",prop:"userName"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(n,{modelValue:d.value.userName,"onUpdate:modelValue":o[0]||(o[0]=e=>d.value.userName=e)},null,8,["modelValue"])]),_:1})),e.curRow.goodId?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createBlock"])(u,{key:1,label:"商品名称:",prop:"goodName"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(n,{modelValue:d.value.goodName,"onUpdate:modelValue":o[1]||(o[1]=e=>d.value.goodName=e)},null,8,["modelValue"])]),_:1})),Object(a["createElementVNode"])("div",c,[Object(a["createTextVNode"])(" 勾选数据批量调整： "),Object(a["createVNode"])(V,{modelValue:O.value,"onUpdate:modelValue":o[2]||(o[2]=e=>O.value=e),step:.5,onOnEnter:h,class:"step-input"},null,8,["modelValue"]),Object(a["createVNode"])(y,{type:"primary",onClick:h,class:"ml-10"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("确认")]),_:1})])]),_:1},8,["modelValue"])]),down:Object(a["withCtx"])(()=>[Object(a["createVNode"])(C,{ref_key:"tableRef",ref:j,columns:s.value,getData:m,addSelect:"",addIndex:"",onOnSelectionChange:o[6]||(o[6]=e=>b.value=e)},{special:Object(a["withCtx"])(({row:e,index:t})=>[p.value!=t?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",{key:0,class:"vi-link-pointer",onClick:e=>p.value=t}," ￥ "+Object(a["toDisplayString"])(e.specialPrice&&e.specialPrice.toFixed(2)),9,l)):(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",r,[Object(a["createTextVNode"])(" ￥ "),Object(a["createVNode"])(V,{modelValue:e.specialPrice,"onUpdate:modelValue":t=>e.specialPrice=t,step:.5},null,8,["modelValue","onUpdate:modelValue"]),Object(a["createVNode"])(y,{onClick:o[5]||(o[5]=e=>p.value=-1),class:"ml-10"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("取消")]),_:1}),Object(a["createVNode"])(y,{type:"primary",onClick:t=>v([e])},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("确认")]),_:2},1032,["onClick"])]))]),operate:Object(a["withCtx"])(({row:e})=>[Object(a["createElementVNode"])("a",{onClick:t=>g([e]),class:"vi-red-pointer"},"删除",8,i)]),_:1},8,["columns"])]),_:1})}}},s=(o("8c5e"),o("6b0d")),d=o.n(s);const b=d()(u,[["__scopeId","data-v-2756fc82"]]);t["default"]=b},"192b":function(e,t,o){"use strict";o("14d9");var a=o("7a23"),n=o("4360");const c={class:"detail-container"},l={class:"group-title"},r={class:"card-list"},i={class:"title"},u={class:"count"},s={class:"f-20"};var d={__name:"orderStatModal",props:{modelValue:{type:Boolean,default:!1},statOrders:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,d=Object(n["a"])(),b=Object(a["computed"])(()=>d.dictMap),p=Object(a["ref"])(window.isMobile),O=Object(a["computed"])({get(){return o.modelValue},set(e){t("update:modelValue",e)}}),j=Object(a["ref"])({});return Object(a["watch"])(()=>o.statOrders,e=>{const t=[];e.forEach(({detail:e})=>{const o=JSON.parse(e||"[]");o.forEach(({goodId:e,name:o,count:a})=>{const n=t.findIndex(t=>t.goodId===e);n>-1?t[n].count+=+a||0:t.push({goodId:e,name:o,count:+a||0})})});const o={};t.forEach(e=>{var t;const a=(null===(t=e.store)||void 0===t?void 0:t.split(",")[0])||"";o[a]?o[a].push(e):o[a]=[e]}),j.value=o}),(t,o)=>{const n=Object(a["resolveComponent"])("viEmpty"),d=Object(a["resolveComponent"])("viModal");return Object(a["openBlock"])(),Object(a["createBlock"])(d,{modelValue:O.value,"onUpdate:modelValue":o[0]||(o[0]=e=>O.value=e),title:`订单统计（${e.statOrders.length}）`,width:880},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("div",c,[Object.keys(j.value).length?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createBlock"])(n,{key:0})),(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(j.value,(e,t)=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{key:t,class:"card-group"},[Object(a["createElementVNode"])("p",l,Object(a["toDisplayString"])(b.value.store[t]||"其他"),1),Object(a["createElementVNode"])("div",r,[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e,(e,t)=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{key:t,class:Object(a["normalizeClass"])(["card",{mobile:p.value}])},[Object(a["createElementVNode"])("p",i,Object(a["toDisplayString"])(e.name),1),Object(a["createElementVNode"])("p",u,[Object(a["createTextVNode"])("X "),Object(a["createElementVNode"])("span",s,Object(a["toDisplayString"])(e.count),1)])],2))),128))])]))),128))])]),_:1},8,["modelValue","title"])}}},b=(o("9b53"),o("6b0d")),p=o.n(b);const O=p()(d,[["__scopeId","data-v-5b00737f"]]);t["a"]=O},2410:function(e,t,o){(function(t){var o=function(){"use strict";function e(e,t){return null!=t&&e instanceof t}var o,a,n;try{o=Map}catch(d){o=function(){}}try{a=Set}catch(d){a=function(){}}try{n=Promise}catch(d){n=function(){}}function c(l,r,i,u,d){"object"===typeof r&&(i=r.depth,u=r.prototype,d=r.includeNonEnumerable,r=r.circular);var b=[],p=[],O="undefined"!=typeof t;function j(l,i){if(null===l)return null;if(0===i)return l;var f,m;if("object"!=typeof l)return l;if(e(l,o))f=new o;else if(e(l,a))f=new a;else if(e(l,n))f=new n((function(e,t){l.then((function(t){e(j(t,i-1))}),(function(e){t(j(e,i-1))}))}));else if(c.__isArray(l))f=[];else if(c.__isRegExp(l))f=new RegExp(l.source,s(l)),l.lastIndex&&(f.lastIndex=l.lastIndex);else if(c.__isDate(l))f=new Date(l.getTime());else{if(O&&t.isBuffer(l))return f=t.allocUnsafe?t.allocUnsafe(l.length):new t(l.length),l.copy(f),f;e(l,Error)?f=Object.create(l):"undefined"==typeof u?(m=Object.getPrototypeOf(l),f=Object.create(m)):(f=Object.create(u),m=u)}if(r){var v=b.indexOf(l);if(-1!=v)return p[v];b.push(l),p.push(f)}for(var h in e(l,o)&&l.forEach((function(e,t){var o=j(t,i-1),a=j(e,i-1);f.set(o,a)})),e(l,a)&&l.forEach((function(e){var t=j(e,i-1);f.add(t)})),l){var g;m&&(g=Object.getOwnPropertyDescriptor(m,h)),g&&null==g.set||(f[h]=j(l[h],i-1))}if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(l);for(h=0;h<V.length;h++){var y=V[h],w=Object.getOwnPropertyDescriptor(l,y);(!w||w.enumerable||d)&&(f[y]=j(l[y],i-1),w.enumerable||Object.defineProperty(f,y,{enumerable:!1}))}}if(d){var C=Object.getOwnPropertyNames(l);for(h=0;h<C.length;h++){var k=C[h];w=Object.getOwnPropertyDescriptor(l,k);w&&w.enumerable||(f[k]=j(l[k],i-1),Object.defineProperty(f,k,{enumerable:!1}))}}return f}return"undefined"==typeof r&&(r=!0),"undefined"==typeof i&&(i=1/0),j(l,i)}function l(e){return Object.prototype.toString.call(e)}function r(e){return"object"===typeof e&&"[object Date]"===l(e)}function i(e){return"object"===typeof e&&"[object Array]"===l(e)}function u(e){return"object"===typeof e&&"[object RegExp]"===l(e)}function s(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return c.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},c.__objToStr=l,c.__isDate=r,c.__isArray=i,c.__isRegExp=u,c.__getRegExpFlags=s,c}();e.exports&&(e.exports=o)}).call(this,o("b639").Buffer)},"24ec":function(e,t,o){},"267e":function(e,t,o){"use strict";o.d(t,"a",(function(){return a})),o.d(t,"c",(function(){return n})),o.d(t,"b",(function(){return c}));const a={1:"草稿",2:"已打印",3:"已作废"},n={1:"未注册",2:"待审核",3:"已验证"},c={1:"超管",2:"店长",3:"店员",9:"客户",99:"游客"}},"31fd":function(e,t,o){"use strict";var a=o("7a23"),n=o("3e6b"),c=o("01d4"),l=o("4cdf"),r=o("f403"),i=o("5831"),u=o("a568"),s=o("92fa"),d=o("0af5"),b=o("1300"),p=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!==typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function a(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(a.prototype=o.prototype,new a)}}(),O=function(e){function t(t){var o=e.call(this,{attributions:t.attributions,wrapX:t.wrapX})||this;return o.resolution=void 0,o.distance=void 0!==t.distance?t.distance:20,o.minDistance=t.minDistance||0,o.interpolationRatio=0,o.features=[],o.geometryFunction=t.geometryFunction||function(e){var t=e.getGeometry();return Object(s["a"])("Point"==t.getType(),10),t},o.createCustomCluster_=t.createCluster,o.source=null,o.boundRefresh_=o.refresh.bind(o),o.updateDistance(o.distance,o.minDistance),o.setSource(t.source||null),o}return p(t,e),t.prototype.clear=function(t){this.features.length=0,e.prototype.clear.call(this,t)},t.prototype.getDistance=function(){return this.distance},t.prototype.getSource=function(){return this.source},t.prototype.loadFeatures=function(e,t,o){this.source.loadFeatures(e,t,o),t!==this.resolution&&(this.resolution=t,this.refresh())},t.prototype.setDistance=function(e){this.updateDistance(e,this.minDistance)},t.prototype.setMinDistance=function(e){this.updateDistance(this.distance,e)},t.prototype.getMinDistance=function(){return this.minDistance},t.prototype.setSource=function(e){this.source&&this.source.removeEventListener(c["a"].CHANGE,this.boundRefresh_),this.source=e,e&&e.addEventListener(c["a"].CHANGE,this.boundRefresh_),this.refresh()},t.prototype.refresh=function(){this.clear(),this.cluster(),this.addFeatures(this.features)},t.prototype.updateDistance=function(e,t){var o=0===e?0:Math.min(t,e)/e,a=e!==this.distance||this.interpolationRatio!==o;this.distance=e,this.minDistance=t,this.interpolationRatio=o,a&&this.refresh()},t.prototype.cluster=function(){if(void 0!==this.resolution&&this.source)for(var e=Object(d["j"])(),t=this.distance*this.resolution,o=this.source.getFeatures(),a={},n=0,c=o.length;n<c;n++){var l=o[n];if(!(Object(b["c"])(l)in a)){var r=this.geometryFunction(l);if(r){var i=r.getCoordinates();Object(d["m"])(i,e),Object(d["c"])(e,t,e);var u=this.source.getFeaturesInExtent(e).filter((function(e){var t=Object(b["c"])(e);return!(t in a)&&(a[t]=!0,!0)}));this.features.push(this.createCluster(u,e))}}}},t.prototype.createCluster=function(e,t){for(var o=[0,0],a=e.length-1;a>=0;--a){var n=this.geometryFunction(e[a]);n?Object(u["a"])(o,n.getCoordinates()):e.splice(a,1)}Object(u["e"])(o,1/e.length);var c=Object(d["w"])(t),i=this.interpolationRatio,s=new r["a"]([o[0]*(1-i)+c[0]*i,o[1]*(1-i)+c[1]*i]);return this.createCustomCluster_?this.createCustomCluster_(s,e):new l["a"]({geometry:s,features:e})},t}(i["a"]),j=O,f=o("e269"),m=o("592d"),v=o("cd7e"),h=o("1e8d"),g=o("0999"),V=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!==typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function a(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(a.prototype=o.prototype,new a)}}(),y={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"},w=function(e){function t(t){var o=e.call(this)||this;o.on,o.once,o.un,o.options=t,o.id=t.id,o.insertFirst=void 0===t.insertFirst||t.insertFirst,o.stopEvent=void 0===t.stopEvent||t.stopEvent,o.element=document.createElement("div"),o.element.className=void 0!==t.className?t.className:"ol-overlay-container "+v["d"],o.element.style.position="absolute",o.element.style.pointerEvents="auto";var a=t.autoPan;return a&&"object"!==typeof a&&(a={animation:t.autoPanAnimation,margin:t.autoPanMargin}),o.autoPan=a||!1,o.rendered={transform_:"",visible:!0},o.mapPostrenderListenerKey=null,o.addChangeListener(y.ELEMENT,o.handleElementChanged),o.addChangeListener(y.MAP,o.handleMapChanged),o.addChangeListener(y.OFFSET,o.handleOffsetChanged),o.addChangeListener(y.POSITION,o.handlePositionChanged),o.addChangeListener(y.POSITIONING,o.handlePositioningChanged),void 0!==t.element&&o.setElement(t.element),o.setOffset(void 0!==t.offset?t.offset:[0,0]),o.setPositioning(t.positioning||"top-left"),void 0!==t.position&&o.setPosition(t.position),o}return V(t,e),t.prototype.getElement=function(){return this.get(y.ELEMENT)},t.prototype.getId=function(){return this.id},t.prototype.getMap=function(){return this.get(y.MAP)||null},t.prototype.getOffset=function(){return this.get(y.OFFSET)},t.prototype.getPosition=function(){return this.get(y.POSITION)},t.prototype.getPositioning=function(){return this.get(y.POSITIONING)},t.prototype.handleElementChanged=function(){Object(g["e"])(this.element);var e=this.getElement();e&&this.element.appendChild(e)},t.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&(Object(g["f"])(this.element),Object(h["c"])(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var e=this.getMap();if(e){this.mapPostrenderListenerKey=Object(h["a"])(e,m["a"].POSTRENDER,this.render,this),this.updatePixelPosition();var t=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?t.insertBefore(this.element,t.childNodes[0]||null):t.appendChild(this.element),this.performAutoPan()}},t.prototype.render=function(){this.updatePixelPosition()},t.prototype.handleOffsetChanged=function(){this.updatePixelPosition()},t.prototype.handlePositionChanged=function(){this.updatePixelPosition(),this.performAutoPan()},t.prototype.handlePositioningChanged=function(){this.updatePixelPosition()},t.prototype.setElement=function(e){this.set(y.ELEMENT,e)},t.prototype.setMap=function(e){this.set(y.MAP,e)},t.prototype.setOffset=function(e){this.set(y.OFFSET,e)},t.prototype.setPosition=function(e){this.set(y.POSITION,e)},t.prototype.performAutoPan=function(){this.autoPan&&this.panIntoView(this.autoPan)},t.prototype.panIntoView=function(e){var t=this.getMap();if(t&&t.getTargetElement()&&this.get(y.POSITION)){var o=this.getRect(t.getTargetElement(),t.getSize()),a=this.getElement(),n=this.getRect(a,[Object(g["c"])(a),Object(g["b"])(a)]),c=e||{},l=void 0===c.margin?20:c.margin;if(!Object(d["g"])(o,n)){var r=n[0]-o[0],i=o[2]-n[2],u=n[1]-o[1],s=o[3]-n[3],b=[0,0];if(r<0?b[0]=r-l:i<0&&(b[0]=Math.abs(i)+l),u<0?b[1]=u-l:s<0&&(b[1]=Math.abs(s)+l),0!==b[0]||0!==b[1]){var p=t.getView().getCenterInternal(),O=t.getPixelFromCoordinateInternal(p);if(!O)return;var j=[O[0]+b[0],O[1]+b[1]],f=c.animation||{};t.getView().animateInternal({center:t.getCoordinateFromPixelInternal(j),duration:f.duration,easing:f.easing})}}}},t.prototype.getRect=function(e,t){var o=e.getBoundingClientRect(),a=o.left+window.pageXOffset,n=o.top+window.pageYOffset;return[a,n,a+t[0],n+t[1]]},t.prototype.setPositioning=function(e){this.set(y.POSITIONING,e)},t.prototype.setVisible=function(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)},t.prototype.updatePixelPosition=function(){var e=this.getMap(),t=this.getPosition();if(e&&e.isRendered()&&t){var o=e.getPixelFromCoordinate(t),a=e.getSize();this.updateRenderedPosition(o,a)}else this.setVisible(!1)},t.prototype.updateRenderedPosition=function(e,t){var o=this.element.style,a=this.getOffset(),n=this.getPositioning();this.setVisible(!0);var c=Math.round(e[0]+a[0])+"px",l=Math.round(e[1]+a[1])+"px",r="0%",i="0%";"bottom-right"==n||"center-right"==n||"top-right"==n?r="-100%":"bottom-center"!=n&&"center-center"!=n&&"top-center"!=n||(r="-50%"),"bottom-left"==n||"bottom-center"==n||"bottom-right"==n?i="-100%":"center-left"!=n&&"center-center"!=n&&"center-right"!=n||(i="-50%");var u="translate(".concat(r,", ").concat(i,") translate(").concat(c,", ").concat(l,")");this.rendered.transform_!=u&&(this.rendered.transform_=u,o.transform=u,o.msTransform=u)},t.prototype.getOptions=function(){return this.options},t}(f["a"]),C=w,k=o("6c77"),N=o("6cbf"),x=o("ce2c"),_=o("8682"),B=o("83a6"),E=o("8295"),P=o("d051"),S=o("e300"),I=o("e47c"),D=o.n(I),T=o("eeb9"),A=o("2af9"),F=o("ed08");const M=e=>(Object(a["pushScopeId"])("data-v-2528e2e5"),e=e(),Object(a["popScopeId"])(),e),R={class:"popup"},U={class:"popup-header"},L={class:"title"},Y={class:"popup-content"},W={class:"mb-10"},H=M(()=>Object(a["createElementVNode"])("div",{class:"mt-10"},null,-1)),K=M(()=>Object(a["createElementVNode"])("div",{class:"mt-10"},null,-1)),X={class:"popup"},z={class:"popup-header"},J=M(()=>Object(a["createElementVNode"])("span",{class:"title"},"聚合点位",-1)),G={class:"popup-content"},Q=["onClick"],$={class:"popup"},q={class:"popup-content tc"};var Z={__name:"allUsersMap",emits:["changeUser","deleteUser","openSpecialMng","openHistoryOrder","close"],setup(e,{expose:t,emit:o}){const c=Object(a["inject"])("$Message",()=>{}),u=Object(a["ref"])(window.isMobile),s=Object(a["ref"])([]);let d=null,b=null,p=null,O=null,f=null;const m=Object(a["ref"])({}),v=Object(a["ref"])([]),h=Object(a["ref"])(!1),g=Object(a["ref"])("");function V(e){const t=e.get("features").length;return 1==t?new k["b"]({image:new N["a"]({src:D.a,anchor:[.5,1]})}):new k["b"]({image:new x["a"]({radius:16,stroke:new _["a"]({color:"#fff",width:1}),fill:new B["a"]({color:"#6086FF"})}),text:new E["a"]({text:t.toString(),font:"12px sans-serif",fill:new B["a"]({color:"#FFFFFF"})}),zIndex:t})}function y(){if(!d)return;b&&(b.getSource().getSource().clear(),d.removeLayer(b),b=null);const e=s.value.filter(e=>e.longitude&&e.latitude).map(e=>new l["a"]({geometry:new r["a"]([e.longitude,e.latitude]),data:e})),t=new j({distance:20,source:new i["a"]({features:e})});b=new n["a"]({source:t,style:e=>V(e)}),d.addLayer(b)}async function w(){p&&p.setPosition(void 0),f&&f.setPosition(void 0);try{const{returnCode:e,data:t}=await Object(T["p"])()||{};0===e&&(s.value=t||[],y())}catch(e){c.error("获取客户列表失败："+(e.message||e))}}Object(a["watch"])(()=>g.value,e=>{const t=s.value.find(t=>t.userId===e);if(p.setPosition(void 0),t&&t.longitude&&t.latitude){m.value=t;const e=[t.longitude,t.latitude];d.getView().animate({center:e}),p.setPosition(e)}else t?(m.value=t,c.info("该用户未设置定位<br>点击地图进行定位")):m.value={longitude:m.value.longitude,latitude:m.value.latitude}});let I=null,M=null;function Z(){b&&(b.getSource().getSource().clear(),d.removeLayer(b),b=null),p.setPosition(void 0);const e=new l["a"]({geometry:new r["a"]([m.value.longitude,m.value.latitude])}),t=new i["a"]({features:[e]});M=new n["a"]({source:t,style:new k["b"]({image:new N["a"]({src:D.a,anchor:[.5,1]})})}),d.addLayer(M);const o=new S["a"]([e]);I=new P["a"]({features:o}),d.addInteraction(I),I.on("translatestart",()=>{h.value=!0,f.setPosition(void 0)}),I.on("translateend",e=>{const t=e.features.array_[0].getGeometry().flatCoordinates;f.setPosition(t),m.value={...m.value,longitude:+t[0].toFixed(6),latitude:+t[1].toFixed(6)}})}function ee(){f.setPosition(void 0),M&&(d.removeLayer(M),M=null,d.removeInteraction(I),I=null),h.value&&(h.value=!1,y())}async function te(){try{const{data:e}=await Object(T["N"])(m.value)||{};e&&(c.success("校准成功"),ee(),w())}catch(e){c.error("校准失败："+(e.message||e))}}function oe(){const e=Object(F["g"])(m.value);if(!e)return c.error("未找到定位");window.open(e,"_self")}function ae(e){m.value={...e},O.setPosition(void 0),p.setPosition([e.longitude,e.latitude])}function ne(e){const t=d.forEachFeatureAtPixel(e.pixel,e=>e.get("features")),o=t&&t.length||0,a=p.getPosition()||O.getPosition()||f.getPosition();if(p.setPosition(void 0),O.setPosition(void 0),f.setPosition(void 0),o)1===o?(m.value=t[0].get("data"),p.setPosition(e.coordinate)):(v.value=t.map(e=>e.get("data")),O.setPosition(e.coordinate));else{if(a)return;m.value={...g.value?m.value:{},longitude:+e.coordinate[0].toFixed(6),latitude:+e.coordinate[1].toFixed(6)},f.setPosition(e.coordinate)}}const ce=Object(a["ref"])(),le=Object(a["ref"])(),re=Object(a["ref"])();function ie(e){d=e,p=new C({element:ce.value,positioning:"top-left",offset:[15,-20],autoPan:!0}),d.addOverlay(p),O=new C({element:le.value,positioning:"top-left",offset:[10,-20],autoPan:!0}),d.addOverlay(O),f=new C({element:re.value,positioning:"top-left",offset:[10,-20],autoPan:!0}),d.addOverlay(f),d.on("singleclick",ne),y()}return t({getUsersList:w}),Object(a["onMounted"])(()=>{w()}),Object(a["onBeforeUnmount"])(()=>{d.un("singleclick",ne)}),(e,t)=>{const n=Object(a["resolveComponent"])("Button"),c=Object(a["resolveComponent"])("Option"),l=Object(a["resolveComponent"])("viSelect");return Object(a["openBlock"])(),Object(a["createBlock"])(Object(a["unref"])(A["j"]),{onOnMount:ie,class:"h100"},{default:Object(a["withCtx"])(()=>[u.value?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createBlock"])(n,{key:0,type:"success",onClick:t[0]||(t[0]=e=>o("close")),class:"list-mode"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("列表模式")]),_:1})),Object(a["createVNode"])(l,{modelValue:g.value,"onUpdate:modelValue":t[1]||(t[1]=e=>g.value=e),filterable:"",class:"select-user"},{default:Object(a["withCtx"])(()=>[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(s.value,e=>(Object(a["openBlock"])(),Object(a["createBlock"])(c,{key:e.userId,value:e.userId},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),Object(a["createElementVNode"])("div",{ref_key:"userPopup",ref:ce},[Object(a["createElementVNode"])("div",R,[Object(a["createElementVNode"])("div",U,[Object(a["createElementVNode"])("span",L,Object(a["toDisplayString"])(m.value.name),1),Object(a["createElementVNode"])("span",{class:"close",onClick:t[2]||(t[2]=e=>Object(a["unref"])(p).setPosition(void 0))}," X ")]),Object(a["createElementVNode"])("div",Y,[Object(a["createElementVNode"])("p",null,"电话："+Object(a["toDisplayString"])(m.value.phone||"-"),1),Object(a["createElementVNode"])("p",W,"备注："+Object(a["toDisplayString"])(m.value.remarks||"-"),1),Object(a["createVNode"])(n,{type:"primary",onClick:t[3]||(t[3]=e=>o("changeUser",m.value)),size:"small"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("修改")]),_:1}),Object(a["createVNode"])(n,{type:"error",onClick:t[4]||(t[4]=e=>o("deleteUser",m.value)),size:"small"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("删除")]),_:1}),H,Object(a["createVNode"])(n,{type:"success",onClick:t[5]||(t[5]=e=>o("openSpecialMng",m.value)),size:"small"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("特价")]),_:1}),Object(a["createVNode"])(n,{type:"primary",onClick:t[6]||(t[6]=e=>o("openHistoryOrder",m.value)),size:"small"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("历史订单")]),_:1}),K,Object(a["createVNode"])(n,{type:"primary",onClick:oe,size:"small"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("导航")]),_:1}),Object(a["createVNode"])(n,{onClick:Z,size:"small"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("校准")]),_:1})])])],512),Object(a["createElementVNode"])("div",{ref_key:"clusterPopup",ref:le},[Object(a["createElementVNode"])("div",X,[Object(a["createElementVNode"])("div",z,[J,Object(a["createElementVNode"])("span",{class:"close",onClick:t[7]||(t[7]=e=>Object(a["unref"])(O).setPosition(void 0))}," X ")]),Object(a["createElementVNode"])("div",G,[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(v.value,(e,t)=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("p",{key:t,onClick:t=>ae(e),class:"pointer"},Object(a["toDisplayString"])(t+1)+"、"+Object(a["toDisplayString"])(e.name),9,Q))),128))])])],512),Object(a["createElementVNode"])("div",{ref_key:"emptyPopup",ref:re},[Object(a["createElementVNode"])("div",$,[Object(a["createElementVNode"])("div",q,[h.value?(Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],{key:1},[Object(a["createVNode"])(n,{onClick:ee,size:"small"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("取消")]),_:1}),Object(a["createVNode"])(n,{type:"success",onClick:te,size:"small"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("确认")]),_:1})],64)):(Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],{key:0},[Object(a["createVNode"])(n,{type:"success",onClick:t[8]||(t[8]=e=>o("changeUser",m.value)),size:"small"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(Object(a["toDisplayString"])(g.value?"定位":"新增"),1)]),_:1}),Object(a["createVNode"])(n,{type:"primary",onClick:oe,size:"small"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("导航")]),_:1})],64)),Object(a["createElementVNode"])("span",{onClick:ee,class:"ml-10 pointer"}," X ")])])],512)]),_:1})}}},ee=(o("b8e7"),o("6b0d")),te=o.n(ee);const oe=te()(Z,[["__scopeId","data-v-2528e2e5"]]);t["a"]=oe},"592d":function(e,t,o){"use strict";t["a"]={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"}},"65e2":function(e,t,o){"use strict";o("e317")},"7e0a":function(e,t,o){"use strict";o.r(t);var a=o("8738"),n=(o("14d9"),o("7a23")),c=o("eeb9"),l=o("2af9"),r=o("267e"),i=o("6605"),u=o("192b");const s=e=>(Object(n["pushScopeId"])("data-v-75b53b2e"),e=e(),Object(n["popScopeId"])(),e),d=s(()=>Object(n["createElementVNode"])("br",null,null,-1)),b=["onClick"],p=["onClick"],O=["onClick"];var j={__name:"index",props:{curRow:{type:Object,default(){return{}}}},emits:["close"],setup(e,{emit:t}){const o=e,s=Object(i["d"])(),j=Object(n["inject"])("$Message",()=>{}),f=Object(n["inject"])("$Modal",()=>{}),m={shortcuts:[{text:"今天",value:()=>[new Date,new Date]},{text:"近2天",value:()=>[(new Date).subtract(1),new Date]},{text:"近3天",value:()=>[(new Date).subtract(2),new Date]},{text:"近一周",value:()=>[(new Date).subtract(7),new Date]}]},v=Object(n["ref"])();function h(){var e;null===(e=v.value)||void 0===e||e.changePage(1)}const g=Object(n["ref"])({}),V=Object(n["ref"])([]),y=Object(n["ref"])(!1),w=Object(n["ref"])({}),C=Object(n["computed"])(()=>[{title:"订单编号",minWidth:130,render:(e,{row:t})=>e("span",{class:"vi-link-pointer",onClick:()=>{w.value={...t,list:JSON.parse(t.detail||"[]"),total:t.total.toFixed(2)},y.value=!0}},t.orderId)},...o.curRow.userId?[]:[{title:"客户名称",key:"userName",minWidth:100}],{title:"订单状态",width:80,render:(e,{row:t})=>e("span",r["a"][t.status]||"-")},{title:"总金额",minWidth:90,render:(e,{row:t})=>e("span","￥"+t.total.toFixed(2))},{title:"修改时间",key:"updateTime",minWidth:90},{title:"修改人",key:"updateUserName",minWidth:60},{title:"创建人",key:"createUserName",minWidth:60},{title:"操作",slot:"operate",minWidth:100}]);function k(e){V.value=[];const{updateTime:t=[],createTime:a=[],...n}=g.value;return Object(c["v"])({...e,...n,updateTimeStart:t[0]&&new Date(t[0]).startOf("day").format("YYYY-MM-DD HH:mm:ss"),updateTimeEnd:t[1]&&new Date(t[1]).endOf("day").format("YYYY-MM-DD HH:mm:ss"),createTimeStart:a[0]&&new Date(a[0]).startOf("day").format("YYYY-MM-DD HH:mm:ss"),createTimeEnd:a[1]&&new Date(a[1]).endOf("day").format("YYYY-MM-DD HH:mm:ss"),userId:o.curRow.userId})}function N(e){y.value=!1,t("close"),s.push({name:"cashierMng",state:{params:{type:"change",userId:e.userId,userName:e.userName,detail:e.detail,orderId:e.orderId}}})}function x(e){y.value=!1,t("close"),s.push({name:"cashierMng",state:{params:{type:"copy",detail:e.detail}}})}function _(e=V.value){if(!e.length)return j.info("至少选中一项");f.confirm({title:"删除订单",content:"是否确认删除所选订单？",loading:!0,onOk:async()=>{try{const{returnCode:t,data:o}=await Object(c["i"])({orderIds:e.map(e=>e.orderId).join()})||{};0===t&&o&&(j.success("删除成功"),f.remove(),h(),window.$EventBus.$emit("saveOrder"))}catch(t){j.error("删除失败："+(t.message||t))}}})}const B=Object(n["ref"])(!1),E=Object(n["ref"])([]);function P(){const e=V.value;if(!e.length)return j.info("至少选中一项");E.value=e,B.value=!0}return Object(n["onActivated"])(()=>{h()}),(t,o)=>{const c=Object(n["resolveComponent"])("viInput"),i=Object(n["resolveComponent"])("FormItem"),s=Object(n["resolveComponent"])("Option"),j=Object(n["resolveComponent"])("viSelect"),f=Object(n["resolveComponent"])("Button"),S=Object(n["resolveComponent"])("viSearchForm"),I=Object(n["resolveComponent"])("viTablePage"),D=Object(n["resolveComponent"])("viModal"),T=Object(n["resolveComponent"])("viLayoutUpDown");return Object(n["openBlock"])(),Object(n["createBlock"])(T,null,{up:Object(n["withCtx"])(()=>[Object(n["createVNode"])(S,{modelValue:g.value,"onUpdate:modelValue":o[6]||(o[6]=e=>g.value=e),onSearch:h},{extral:Object(n["withCtx"])(()=>[Object(n["createVNode"])(f,{type:"error",onClick:o[5]||(o[5]=e=>_())},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("批量删除")]),_:1}),d,Object(n["createVNode"])(f,{type:"success",onClick:P},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("订单统计")]),_:1})]),default:Object(n["withCtx"])(()=>[e.curRow.userId?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createBlock"])(i,{key:0,label:"客户名称:",prop:"userName"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(c,{modelValue:g.value.userName,"onUpdate:modelValue":o[0]||(o[0]=e=>g.value.userName=e),class:"vi-width"},null,8,["modelValue"])]),_:1})),Object(n["createVNode"])(i,{label:"商品名称:",prop:"goodName"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(c,{modelValue:g.value.goodName,"onUpdate:modelValue":o[1]||(o[1]=e=>g.value.goodName=e),class:"vi-width"},null,8,["modelValue"])]),_:1}),Object(n["createVNode"])(i,{label:"订单状态:",prop:"status"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(j,{modelValue:g.value.status,"onUpdate:modelValue":o[2]||(o[2]=e=>g.value.status=e),class:"vi-width"},{default:Object(n["withCtx"])(()=>[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(Object(n["unref"])(r["a"]),(e,t)=>(Object(n["openBlock"])(),Object(n["createBlock"])(s,{key:t,value:t},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(n["createVNode"])(i,{label:"修改时间:",prop:"updateTime"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(Object(n["unref"])(a["a"]),{modelValue:g.value.updateTime,"onUpdate:modelValue":o[3]||(o[3]=e=>g.value.updateTime=e),type:"daterange",options:m,placeholder:"请选择",class:"vi-width"},null,8,["modelValue"])]),_:1}),Object(n["createVNode"])(i,{label:"创建时间:",prop:"createTime"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(Object(n["unref"])(a["a"]),{modelValue:g.value.createTime,"onUpdate:modelValue":o[4]||(o[4]=e=>g.value.createTime=e),type:"daterange",options:m,placeholder:"请选择",class:"vi-width"},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),down:Object(n["withCtx"])(()=>[Object(n["createVNode"])(I,{ref_key:"tableRef",ref:v,columns:C.value,getData:k,addSelect:"",addIndex:"",onOnSelectionChange:o[7]||(o[7]=e=>V.value=e)},{operate:Object(n["withCtx"])(({row:e})=>[Object(n["createElementVNode"])("a",{onClick:t=>N(e)},"修改",8,b),Object(n["createElementVNode"])("a",{onClick:t=>_([e]),class:"vi-red-pointer"},"删除",8,p),Object(n["createElementVNode"])("a",{onClick:t=>x(e),class:"vi-green-pointer"},"一键复制",8,O)]),_:1},8,["columns"]),Object(n["createVNode"])(D,{modelValue:y.value,"onUpdate:modelValue":o[12]||(o[12]=e=>y.value=e),title:"订单详情",width:880},{footer:Object(n["withCtx"])(()=>[Object(n["createVNode"])(f,{onClick:o[8]||(o[8]=e=>y.value=!1)},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("取消")]),_:1}),Object(n["createVNode"])(f,{type:"primary",onClick:o[9]||(o[9]=e=>N(w.value))},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("去修改")]),_:1}),Object(n["createVNode"])(f,{type:"primary",onClick:o[10]||(o[10]=e=>x(w.value))},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("一键复制")]),_:1}),Object(n["createVNode"])(f,{type:"error",onClick:o[11]||(o[11]=e=>_([w.value]))},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("删除")]),_:1})]),default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(Object(n["unref"])(l["m"]),{list:w.value.list,total:w.value.total,data:w.value,class:"order-detail"},null,8,["list","total","data"])]),_:1},8,["modelValue"]),Object(n["createVNode"])(Object(n["unref"])(u["a"]),{modelValue:B.value,"onUpdate:modelValue":o[13]||(o[13]=e=>B.value=e),statOrders:E.value},null,8,["modelValue","statOrders"])]),_:1})}}},f=(o("8ab5"),o("6b0d")),m=o.n(f);const v=m()(j,[["__scopeId","data-v-75b53b2e"]]);t["default"]=v},8295:function(e,t,o){"use strict";var a=o("83a6"),n=o("29f6"),c=o("345d"),l="#333",r=function(){function e(e){var t=e||{};this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=Object(c["c"])(void 0!==t.scale?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.textBaseline_=t.textBaseline,this.fill_=void 0!==t.fill?t.fill:new a["a"]({color:l}),this.maxAngle_=void 0!==t.maxAngle?t.maxAngle:Math.PI/4,this.placement_=void 0!==t.placement?t.placement:n["a"].POINT,this.overflow_=!!t.overflow,this.stroke_=void 0!==t.stroke?t.stroke:null,this.offsetX_=void 0!==t.offsetX?t.offsetX:0,this.offsetY_=void 0!==t.offsetY?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=void 0===t.padding?null:t.padding}return e.prototype.clone=function(){var t=this.getScale();return new e({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})},e.prototype.getOverflow=function(){return this.overflow_},e.prototype.getFont=function(){return this.font_},e.prototype.getMaxAngle=function(){return this.maxAngle_},e.prototype.getPlacement=function(){return this.placement_},e.prototype.getOffsetX=function(){return this.offsetX_},e.prototype.getOffsetY=function(){return this.offsetY_},e.prototype.getFill=function(){return this.fill_},e.prototype.getRotateWithView=function(){return this.rotateWithView_},e.prototype.getRotation=function(){return this.rotation_},e.prototype.getScale=function(){return this.scale_},e.prototype.getScaleArray=function(){return this.scaleArray_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.getText=function(){return this.text_},e.prototype.getTextAlign=function(){return this.textAlign_},e.prototype.getJustify=function(){return this.justify_},e.prototype.getTextBaseline=function(){return this.textBaseline_},e.prototype.getBackgroundFill=function(){return this.backgroundFill_},e.prototype.getBackgroundStroke=function(){return this.backgroundStroke_},e.prototype.getPadding=function(){return this.padding_},e.prototype.setOverflow=function(e){this.overflow_=e},e.prototype.setFont=function(e){this.font_=e},e.prototype.setMaxAngle=function(e){this.maxAngle_=e},e.prototype.setOffsetX=function(e){this.offsetX_=e},e.prototype.setOffsetY=function(e){this.offsetY_=e},e.prototype.setPlacement=function(e){this.placement_=e},e.prototype.setRotateWithView=function(e){this.rotateWithView_=e},e.prototype.setFill=function(e){this.fill_=e},e.prototype.setRotation=function(e){this.rotation_=e},e.prototype.setScale=function(e){this.scale_=e,this.scaleArray_=Object(c["c"])(void 0!==e?e:1)},e.prototype.setStroke=function(e){this.stroke_=e},e.prototype.setText=function(e){this.text_=e},e.prototype.setTextAlign=function(e){this.textAlign_=e},e.prototype.setJustify=function(e){this.justify_=e},e.prototype.setTextBaseline=function(e){this.textBaseline_=e},e.prototype.setBackgroundFill=function(e){this.backgroundFill_=e},e.prototype.setBackgroundStroke=function(e){this.backgroundStroke_=e},e.prototype.setPadding=function(e){this.padding_=e},e}();t["a"]=r},8685:function(e,t,o){},"8ab5":function(e,t,o){"use strict";o("8685")},"8c5e":function(e,t,o){"use strict";o("24ec")},"8c7f":function(e,t,o){},"9a92":function(e,t,o){},"9b53":function(e,t,o){"use strict";o("9e18")},"9e18":function(e,t,o){},b116:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACyElEQVRYR82WP2gUQRTGv7eHvYLcxWi82SAkCDaSJhHRFMbGxEotVMTGUhS1MLebXLxNLIxoWisRA6KNXmz8AwmCSSFoI5KA5vaMhJuNYArb7JM1OZHNzs7uBYnbznvv++2bN98MYZM/Squ/fdjdn2HuAVEf+2ghwi5mfCMDC2AurxC9/F4Q75PWTQyQG6keg48LAPfqi9MEDNyT/fnnuthEAFmn8phAJ3TFwusMfuJZ5sm4PC1AznE5rXA4XlpCqRML0DTsjjLjykYBiHC7VhBXo+ooAVb3nCc2Kv4n36DeqJlQAzjVcrKBS4pIE9LK94WjIwGyI24n+ZhOUHqcmT8T0R4Ap3XxbKDL6xczf8dFAuRK1REQX4+dXubumm1O1WOaSpXDTDQZC8F0U9r5fj3AsDsNRqeqWIb99kW7dS683lyab1shY1YJQZiRBdGlBciW3IXA4aIK6c52nGcEjunZokULEHf2mXnIs82i6i+zpUqRiAZV62FPiB5Cx50loE1RZFxa4oxKIOe4D1UDycCcZ4l2fQdKlWfBZaMQWZaW2BYD8APA1sh15rK0zeN6AKd6B+BLKhEmKnqF/FB4Xdd+gO5KK39ZD5DEBYkWmf23YHwCYS+RcQDMzbHHMMIN/08nDP5i0++CAKLJcW8xEHmL6Ww3tM+jNUtci8pJ8B6ovgC4J41gKPa1tMQRVb4e4MbCPhgrr4JdaQBiyfdxdGlAfGgYIEjMOvNnCcaDtABEfL5WMO/H5Wk7UE9OPQ/MY9I2lV5Sr5sY4PfJcBLPw5S0RHeSjqUCWIVwa5p5WAYZB2Vh98d/ArDD+dLhI/NOadO+f84baE08L6k7sNqFykWAxtZDrPd6XRcaAliDeATQqboAg994lnlIJxhebxhgDeIrQMEL52eGt3Qs2jvXPdN0QBsCWBvKSWYe82zzqU6sIStupGianF/sHQ4wqSJAzQAAAABJRU5ErkJggg=="},b8e7:function(e,t,o){"use strict";o("9a92")},c209:function(e,t,o){"use strict";o("8c7f")},c64b:function(e,t,o){"use strict";o("d9e2");var a=o("7a23"),n=o("b116"),c=o.n(n),l=o("eeb9"),r=o("2410"),i=o.n(r),u=o("b046"),s=o("267e"),d=o("4360");const b={class:"flex-ac"},p={key:0};var O={__name:"addUserModal",props:{modelValue:{type:Boolean,default:!1},detailData:{type:Object,default(){return{}}}},emits:["update:modelValue","save","close"],setup(e,{emit:t}){const o=e,n=Object(d["a"])(),r=Object(a["computed"])(()=>n.dictMap),O=Object(a["inject"])("$Message",()=>{}),j=Object(a["inject"])("$Auth",()=>!1),f=Object(a["computed"])({get(){return o.modelValue},set(e){t("update:modelValue",e),e||t("close")}}),m=Object(a["computed"])(()=>(o.detailData.userId?"编辑":"新增")+"客户"),v=Object(a["ref"])({}),h=Object(a["ref"])();async function g(e,t,a){if(t&&o.detailData.name!==v.value.name){const{data:e}=await Object(l["T"])({name:t})||{};if(e)return a(new Error("该客户名称已存在"))}a()}const V={name:[{required:!0,message:"请输入客户名称"},{validator:g,trigger:"blur"}]};Object(a["watch"])(()=>o.detailData,()=>{var e;null===(e=h.value)||void 0===e||e.resetFields(),v.value=i()(o.detailData)},{deep:!0});const y=Object(a["ref"])(!1);function w(){y.value=!0,h.value.validate(async e=>{if(!e)return O.error("数据校验不通过"),void(y.value=!1);try{const{_index:e,_rowKey:o,...a}=v.value,{data:n}=await Object(l["N"])(a)||{};n&&(O.success(m.value+"成功"),t("save",{...v.value}),h.value.resetFields(),f.value=!1)}catch(o){O.error("请求失败："+(o.message||o))}finally{y.value=!1}})}const C=Object(a["ref"])(!1);function k([e,t]){v.value={...v.value,longitude:e,latitude:t},C.value=!1}return(e,t)=>{const o=Object(a["resolveComponent"])("viInput"),n=Object(a["resolveComponent"])("FormItem"),l=Object(a["resolveComponent"])("Option"),i=Object(a["resolveComponent"])("viSelect"),d=Object(a["resolveComponent"])("Form"),O=Object(a["resolveComponent"])("Button"),g=Object(a["resolveComponent"])("viModal");return Object(a["openBlock"])(),Object(a["createBlock"])(g,{modelValue:f.value,"onUpdate:modelValue":t[7]||(t[7]=e=>f.value=e),title:m.value},{footer:Object(a["withCtx"])(()=>[Object(a["createVNode"])(O,{onClick:t[6]||(t[6]=e=>f.value=!1)},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("取消")]),_:1}),Object(a["createVNode"])(O,{type:"primary",onClick:w,loading:y.value},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("确定")]),_:1},8,["loading"])]),default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(d,{ref_key:"formRef",ref:h,model:v.value,rules:V,"label-width":90,onKeydown:Object(a["withKeys"])(w,["enter"]),class:"vi-modal-content"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(n,{label:"客户名称:",prop:"name"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(o,{modelValue:v.value.name,"onUpdate:modelValue":t[0]||(t[0]=e=>v.value.name=e)},null,8,["modelValue"])]),_:1}),Object(a["unref"])(j)(2)?(Object(a["openBlock"])(),Object(a["createBlock"])(n,{key:0,label:"用户权限:",prop:"power"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(i,{modelValue:v.value.power,"onUpdate:modelValue":t[1]||(t[1]=e=>v.value.power=e)},{default:Object(a["withCtx"])(()=>[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(Object(a["unref"])(s["b"]),(e,t)=>(Object(a["openBlock"])(),Object(a["createBlock"])(l,{key:t,value:t},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})):Object(a["createCommentVNode"])("",!0),Object(a["createVNode"])(n,{label:"标签:",prop:"label"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(i,{modelValue:v.value.label,"onUpdate:modelValue":t[2]||(t[2]=e=>v.value.label=e),multiple:""},{default:Object(a["withCtx"])(()=>[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(r.value.user,(e,t)=>(Object(a["openBlock"])(),Object(a["createBlock"])(l,{key:t,value:e.id},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(a["createVNode"])(n,{label:"联系电话:",prop:"phone"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(o,{modelValue:v.value.phone,"onUpdate:modelValue":t[3]||(t[3]=e=>v.value.phone=e)},null,8,["modelValue"])]),_:1}),Object(a["createVNode"])(n,{label:"定位:"},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("div",b,[Object(a["createElementVNode"])("img",{src:c.a,onClick:t[4]||(t[4]=e=>C.value=!0),class:"pointer mr-10"}),v.value.longitude&&v.value.latitude?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",p,Object(a["toDisplayString"])(v.value.longitude)+","+Object(a["toDisplayString"])(v.value.latitude),1)):Object(a["createCommentVNode"])("",!0)])]),_:1})]),_:1},8,["model","onKeydown"]),Object(a["createVNode"])(Object(a["unref"])(u["a"]),{modelValue:C.value,"onUpdate:modelValue":t[5]||(t[5]=e=>C.value=e),curRow:v.value,isEdit:"",onConfirm:k},null,8,["modelValue","curRow"])]),_:1},8,["modelValue","title"])}}};const j=O;t["a"]=j},d09b:function(e,t,o){"use strict";o("fd53")},e317:function(e,t,o){},e903:function(e,t,o){"use strict";var a=o("7a23"),n=o("16f7");const c={class:"specialMng"};var l={__name:"modal",props:{modelValue:{type:Boolean,default:!1},curRow:{type:Object,default(){return{}}}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,l=Object(a["computed"])({get(){return o.modelValue},set(e){t("update:modelValue",e)}});return(t,o)=>{const r=Object(a["resolveComponent"])("viModal");return Object(a["openBlock"])(),Object(a["createBlock"])(r,{modelValue:l.value,"onUpdate:modelValue":o[1]||(o[1]=e=>l.value=e),title:e.curRow.name+"-特价",width:"800"},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("div",c,[Object(a["createVNode"])(Object(a["unref"])(n["default"]),{curRow:e.curRow,onClose:o[0]||(o[0]=e=>l.value=!1)},null,8,["curRow"])])]),_:1},8,["modelValue","title"])}}},r=(o("c209"),o("6b0d")),i=o.n(r);const u=i()(l,[["__scopeId","data-v-7641819a"]]);t["a"]=u},f642:function(e,t,o){"use strict";o.r(t);var a=o("7a23"),n=o("b116"),c=o.n(n),l=o("eeb9"),r=o("c64b"),i=o("7e0a");const u={class:"orderMng"};var s={__name:"modal",props:{modelValue:{type:Boolean,default:!1},curRow:{type:Object,default(){return{}}}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,n=Object(a["computed"])({get(){return o.modelValue},set(e){t("update:modelValue",e)}});return(t,o)=>{const c=Object(a["resolveComponent"])("viModal");return Object(a["openBlock"])(),Object(a["createBlock"])(c,{modelValue:n.value,"onUpdate:modelValue":o[1]||(o[1]=e=>n.value=e),title:e.curRow.name+"-历史订单",width:"1050"},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("div",u,[Object(a["createVNode"])(Object(a["unref"])(i["default"]),{curRow:e.curRow,onClose:o[0]||(o[0]=e=>n.value=!1)},null,8,["curRow"])])]),_:1},8,["modelValue","title"])}}},d=(o("d09b"),o("6b0d")),b=o.n(d);const p=b()(s,[["__scopeId","data-v-52e5c7d0"]]);var O=p,j=o("e903"),f=o("b046"),m=o("31fd"),v=o("ff79"),h=o("2af9"),g=o("267e"),V=o("4360");const y=e=>(Object(a["pushScopeId"])("data-v-1c7c677a"),e=e(),Object(a["popScopeId"])(),e),w=y(()=>Object(a["createElementVNode"])("br",null,null,-1)),C=["onClick"],k={key:1},N=["onClick"],x=["onClick"],_=["onClick"],B=["onClick"],E=["onClick"],P=["onClick"],S={key:1,class:"users-map"};var I={__name:"index",setup(e){const t=Object(V["a"])(),o=Object(a["computed"])(()=>t.dictMap),n=Object(a["inject"])("$Message",()=>{}),i=Object(a["inject"])("$Modal",()=>{}),u=Object(a["inject"])("$Auth",()=>!1),s=[{title:"客户名称",minWidth:100,key:"name",render:(e,{row:t})=>e("span","2"==t.status?t.nickName:t.name)},{title:"标签",minWidth:90,render:(e,{row:o})=>e("span",t.translate("user",o.label))},{title:"注册状态",width:80,render:(e,{row:t})=>e("span",g["c"][t.status]||"-")},{title:"用户权限",width:80,render:(e,{row:t})=>e("span",g["b"][t.power]||"-")},{title:"联系电话",key:"phone",minWidth:90},{title:"定位",slot:"point",width:60},{title:"修改时间",key:"updateTime",minWidth:90},{title:"修改人",key:"updateUserName",minWidth:60},{title:"操作",slot:"operate",minWidth:100}],d=Object(a["ref"])(!1),b=Object(a["ref"])(),p=Object(a["ref"])();function y(){var e;d.value?b.value.getUsersList():null===(e=p.value)||void 0===e||e.changePage(1)}const I=Object(a["ref"])({}),D=Object(a["ref"])([]);function T(e){D.value=[];const t={...e,...I.value};return Object(l["B"])(t)}function A(e=D.value){if(!e.length)return n.info("至少选中一项");i.confirm({title:"删除客户",content:"是否确认删除所选客户（将会删除该用户所有数据）？",loading:!0,onOk:async()=>{try{const{returnCode:t,data:o}=await Object(l["k"])({userIds:e.map(e=>e.userId).join()})||{};0===t&&o&&(n.success("删除成功"),i.remove(),window.$EventBus.$emit("saveUser"),y())}catch(t){n.error("删除失败："+(t.message||t))}}})}const F=Object(a["ref"])(!1);function M(){F.value=!0,Object(l["n"])({...I.value,userIds:D.value.map(e=>e.userId).join()},`客户${(new Date).format("YYYYMMDDHHmmss")}.xlsx`).finally(()=>{F.value=!1})}const R=Object(a["ref"])(!1),U=Object(a["ref"])({}),L=Object(a["ref"])(!1);function Y(e){U.value={...e},L.value=!0}const W=Object(a["ref"])(!1);function H(e){U.value={...e},W.value=!0}const K=Object(a["ref"])(!1);function X(e){U.value={...e},K.value=!0}const z=Object(a["ref"])(!1);function J(e){U.value={...e},z.value=!0}const G=Object(a["ref"])(!1);function Q(e){U.value={...e,name:e.nickName},G.value=!0}function $(e){i.confirm({title:"重置密码",content:"是否确认重置该客户密码？",loading:!0,onOk:async()=>{try{const{returnCode:t,data:o}=await Object(l["H"])({userId:e.userId})||{};0===t&&o&&(i.remove(),setTimeout(()=>{i.success({title:"重置密码成功",content:`重置后的密码为：<h2 style="display: inline-block;">${o}</h2>`,loading:!1})},300))}catch(t){n.error("重置失败："+(t.message||t))}}})}return Object(a["onActivated"])(()=>{y()}),(e,t)=>{const n=Object(a["resolveComponent"])("viInput"),i=Object(a["resolveComponent"])("FormItem"),V=Object(a["resolveComponent"])("Option"),q=Object(a["resolveComponent"])("viSelect"),Z=Object(a["resolveComponent"])("Button"),ee=Object(a["resolveComponent"])("viSearchForm"),te=Object(a["resolveComponent"])("viTablePage"),oe=Object(a["resolveComponent"])("viLayoutUpDown");return Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],null,[d.value?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",S,[Object(a["createVNode"])(Object(a["unref"])(m["a"]),{ref_key:"userMapRef",ref:b,onChangeUser:Y,onDeleteUser:t[10]||(t[10]=e=>A([e])),onOpenHistoryOrder:H,onOpenSpecialMng:X,onClose:t[11]||(t[11]=e=>d.value=!1)},null,512)])):(Object(a["openBlock"])(),Object(a["createBlock"])(oe,{key:0},{up:Object(a["withCtx"])(()=>[Object(a["createVNode"])(ee,{modelValue:I.value,"onUpdate:modelValue":t[8]||(t[8]=e=>I.value=e),onSearch:y},{extral:Object(a["withCtx"])(()=>[Object(a["createVNode"])(Z,{type:"success",onClick:t[4]||(t[4]=e=>Y())},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("新增")]),_:1}),Object(a["createVNode"])(Z,{type:"error",onClick:t[5]||(t[5]=e=>A())},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("批量删除")]),_:1}),w,Object(a["createVNode"])(Z,{onClick:M,loading:F.value},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("导出")]),_:1},8,["loading"]),Object(a["createVNode"])(Z,{type:"primary",onClick:t[6]||(t[6]=e=>R.value=!0)},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("批量导入")]),_:1}),Object(a["createVNode"])(Z,{type:"success",onClick:t[7]||(t[7]=e=>d.value=!0)},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("地图模式")]),_:1})]),default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(i,{label:"客户名称:",prop:"name"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(n,{modelValue:I.value.name,"onUpdate:modelValue":t[0]||(t[0]=e=>I.value.name=e),class:"vi-width"},null,8,["modelValue"])]),_:1}),Object(a["createVNode"])(i,{label:"注册状态:",prop:"status"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(q,{modelValue:I.value.status,"onUpdate:modelValue":t[1]||(t[1]=e=>I.value.status=e),class:"vi-width"},{default:Object(a["withCtx"])(()=>[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(Object(a["unref"])(g["c"]),(e,t)=>(Object(a["openBlock"])(),Object(a["createBlock"])(V,{key:t,value:t},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(a["createVNode"])(i,{label:"用户权限:",prop:"power"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(q,{modelValue:I.value.power,"onUpdate:modelValue":t[2]||(t[2]=e=>I.value.power=e),class:"vi-width"},{default:Object(a["withCtx"])(()=>[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(Object(a["unref"])(g["b"]),(e,t)=>(Object(a["openBlock"])(),Object(a["createBlock"])(V,{key:t,value:t},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(a["createVNode"])(i,{label:"用户标签:",prop:"label"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(q,{modelValue:I.value.label,"onUpdate:modelValue":t[3]||(t[3]=e=>I.value.label=e),class:"vi-width"},{default:Object(a["withCtx"])(()=>[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(o.value.user,(e,t)=>(Object(a["openBlock"])(),Object(a["createBlock"])(V,{key:t,value:e.id},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.name),1)]),_:2},1032,["value"]))),128)),Object(a["createVNode"])(V,{value:"其他"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("其他")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),down:Object(a["withCtx"])(()=>[Object(a["createVNode"])(te,{ref_key:"tableRef",ref:p,columns:s,getData:T,addSelect:"",addIndex:"",onOnSelectionChange:t[9]||(t[9]=e=>D.value=e)},{point:Object(a["withCtx"])(({row:e})=>[e.longitude&&e.latitude?(Object(a["openBlock"])(),Object(a["createElementBlock"])("img",{key:0,src:c.a,onClick:t=>J(e),class:"pointer"},null,8,C)):(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",k,"-"))]),operate:Object(a["withCtx"])(({row:e})=>["2"==e.status?(Object(a["openBlock"])(),Object(a["createElementBlock"])("a",{key:0,onClick:t=>Q(e),class:"vi-green-pointer"},"审批",8,N)):(Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],{key:1},[Object(a["createElementVNode"])("a",{onClick:t=>H(e)},"历史订单",8,x),Object(a["createElementVNode"])("a",{onClick:t=>X(e),class:"vi-green-pointer"},"特价",8,_),Object(a["createElementVNode"])("a",{onClick:t=>Y(e)},"修改",8,B)],64)),Object(a["createElementVNode"])("a",{onClick:t=>A([e]),class:"vi-red-pointer"},"删除",8,E),Object(a["unref"])(u)(3)&&e.wxid?(Object(a["openBlock"])(),Object(a["createElementBlock"])("a",{key:2,onClick:t=>$(e),class:"vi-red-pointer"},"重置密码",8,P)):Object(a["createCommentVNode"])("",!0)]),_:1},512)]),_:1})),Object(a["createVNode"])(Object(a["unref"])(r["a"]),{modelValue:L.value,"onUpdate:modelValue":t[12]||(t[12]=e=>L.value=e),detailData:U.value,onSave:y},null,8,["modelValue","detailData"]),Object(a["createVNode"])(Object(a["unref"])(O),{modelValue:W.value,"onUpdate:modelValue":t[13]||(t[13]=e=>W.value=e),curRow:U.value},null,8,["modelValue","curRow"]),Object(a["createVNode"])(Object(a["unref"])(j["a"]),{modelValue:K.value,"onUpdate:modelValue":t[14]||(t[14]=e=>K.value=e),curRow:U.value},null,8,["modelValue","curRow"]),Object(a["createVNode"])(Object(a["unref"])(f["a"]),{modelValue:z.value,"onUpdate:modelValue":t[15]||(t[15]=e=>z.value=e),curRow:U.value},null,8,["modelValue","curRow"]),Object(a["createVNode"])(Object(a["unref"])(v["a"]),{modelValue:G.value,"onUpdate:modelValue":t[16]||(t[16]=e=>G.value=e),detailData:U.value,onSave:y},null,8,["modelValue","detailData"]),Object(a["createVNode"])(Object(a["unref"])(h["r"]),{modelValue:R.value,"onUpdate:modelValue":t[17]||(t[17]=e=>R.value=e),type:"batchImportUsers",label:"客户",exportHttp:e=>Object(a["unref"])(l["n"])({userIds:"下载模板"},e),importHttp:Object(a["unref"])(l["D"]),onSave:y},null,8,["modelValue","exportHttp","importHttp"])],64)}}};o("65e2");const D=b()(I,[["__scopeId","data-v-1c7c677a"]]);t["default"]=D},fd53:function(e,t,o){},ff79:function(e,t,o){"use strict";o("d9e2");var a=o("7a23"),n=o("b116"),c=o.n(n),l=o("2410"),r=o.n(l),i=o("b046"),u=o("2af9"),s=o("267e"),d=o("eeb9"),b=o("4360");const p={class:"flex-ac"},O={key:0};var j={__name:"auditUserModal",props:{modelValue:{type:Boolean,default:!1},detailData:{type:Object,default(){return{}}}},emits:["update:modelValue","close","save"],setup(e,{emit:t}){const o=e,n=Object(b["a"])(),l=Object(a["computed"])(()=>n.dictMap),j=Object(a["inject"])("$Message",()=>{}),f=Object(a["computed"])({get(){return o.modelValue},set(e){t("update:modelValue",e),e||t("close")}}),m=Object(a["ref"])({}),v=Object(a["ref"])();async function h(e,t,a){if(t&&o.detailData.name!==m.value.name){const{data:e}=await Object(d["T"])({name:t})||{};if(e)return a(new Error("该客户名称已存在"))}a()}const g={name:[{required:!0,message:"请输入客户名称"},{validator:h,trigger:"blur"}]},V=Object(a["ref"])("1"),y=Object(a["ref"])("");Object(a["watch"])(()=>o.detailData,()=>{var e;null===(e=v.value)||void 0===e||e.resetFields(),V.value="1",y.value="",m.value=r()(o.detailData)},{deep:!0});const w=Object(a["ref"])(!1);function C(){w.value=!0,v.value.validate(async e=>{if(!e)return j.error("数据校验不通过"),void(w.value=!1);try{const{_index:e,_rowKey:o,...a}=m.value,{data:n}=await Object(d["b"])({...a,userVerify:V.value,updateUserId:y.value})||{};n&&(j.success("操作成功"),window.$EventBus.$emit("saveUser"),t("save",{...m.value}),f.value=!1,v.value.resetFields())}catch(o){j.error("请求失败："+(o.message||o))}finally{w.value=!1}})}function k(e,t){e&&(m.value={...m.value,name:t.name,longitude:t.longitude,latitude:t.latitude,power:t.power,label:t.label,phone:t.phone})}const N=Object(a["ref"])(!1);function x([e,t]){m.value={...m.value,longitude:e,latitude:t},N.value=!1}return(e,t)=>{const o=Object(a["resolveComponent"])("Radio"),n=Object(a["resolveComponent"])("RadioGroup"),r=Object(a["resolveComponent"])("FormItem"),b=Object(a["resolveComponent"])("viInput"),j=Object(a["resolveComponent"])("Option"),h=Object(a["resolveComponent"])("viSelect"),_=Object(a["resolveComponent"])("Form"),B=Object(a["resolveComponent"])("Button"),E=Object(a["resolveComponent"])("viModal");return Object(a["openBlock"])(),Object(a["createBlock"])(E,{modelValue:f.value,"onUpdate:modelValue":t[9]||(t[9]=e=>f.value=e),title:"用户审批"},{footer:Object(a["withCtx"])(()=>[Object(a["createVNode"])(B,{onClick:t[8]||(t[8]=e=>f.value=!1)},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("取消")]),_:1}),Object(a["createVNode"])(B,{type:"primary",onClick:C,loading:w.value},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("确定")]),_:1},8,["loading"])]),default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(_,{ref_key:"formRef",ref:v,model:m.value,rules:g,"label-width":90,onKeydown:Object(a["withKeys"])(C,["enter"]),class:"vi-modal-content"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(r,{label:"用户验证:"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(n,{modelValue:V.value,"onUpdate:modelValue":t[0]||(t[0]=e=>V.value=e)},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(o,{label:"1"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("新建用户")]),_:1}),Object(a["createVNode"])(o,{label:"2"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("选择已有用户")]),_:1})]),_:1},8,["modelValue"])]),_:1}),"1"===V.value?(Object(a["openBlock"])(),Object(a["createBlock"])(r,{key:0,label:"客户名称:",prop:"name"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(b,{modelValue:m.value.name,"onUpdate:modelValue":t[1]||(t[1]=e=>m.value.name=e)},null,8,["modelValue"])]),_:1})):(Object(a["openBlock"])(),Object(a["createBlock"])(r,{key:1,label:"选择客户:"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(Object(a["unref"])(u["d"]),{modelValue:y.value,"onUpdate:modelValue":t[2]||(t[2]=e=>y.value=e),getData:Object(a["unref"])(d["B"]),valueKey:"userId",filterable:"",params:{status:"1"},onOnChange:k},null,8,["modelValue","getData"])]),_:1})),Object(a["createVNode"])(r,{label:"用户权限:",prop:"power"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(h,{modelValue:m.value.power,"onUpdate:modelValue":t[3]||(t[3]=e=>m.value.power=e)},{default:Object(a["withCtx"])(()=>[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(Object(a["unref"])(s["b"]),(e,t)=>(Object(a["openBlock"])(),Object(a["createBlock"])(j,{key:t,value:t},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(a["createVNode"])(r,{label:"标签:",prop:"label"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(h,{modelValue:m.value.label,"onUpdate:modelValue":t[4]||(t[4]=e=>m.value.label=e),multiple:""},{default:Object(a["withCtx"])(()=>[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(l.value.user,(e,t)=>(Object(a["openBlock"])(),Object(a["createBlock"])(j,{key:t,value:e.id},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(a["createVNode"])(r,{label:"联系电话:",prop:"phone"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(b,{modelValue:m.value.phone,"onUpdate:modelValue":t[5]||(t[5]=e=>m.value.phone=e)},null,8,["modelValue"])]),_:1}),Object(a["createVNode"])(r,{label:"定位:"},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("div",p,[Object(a["createElementVNode"])("img",{src:c.a,onClick:t[6]||(t[6]=e=>N.value=!0),class:"pointer mr-10"}),m.value.longitude&&m.value.latitude?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",O,Object(a["toDisplayString"])(m.value.longitude)+","+Object(a["toDisplayString"])(m.value.latitude),1)):Object(a["createCommentVNode"])("",!0)])]),_:1})]),_:1},8,["model","onKeydown"]),Object(a["createVNode"])(Object(a["unref"])(i["a"]),{modelValue:N.value,"onUpdate:modelValue":t[7]||(t[7]=e=>N.value=e),curRow:m.value,isEdit:"",onConfirm:x},null,8,["modelValue","curRow"])]),_:1},8,["modelValue"])}}};const f=j;t["a"]=f}}]);