(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-76d2f8f8"],{"1b20":function(e,t,o){"use strict";o.r(t);o("14d9");var n=o("7a23"),a=o("aad9"),c=o("3e47"),r=o("df7b"),l=o("b351"),i=o("eeb9"),s=o("2af9"),u=o("c64b"),d=o("b046"),p=o("31fd"),b=o("ff79"),f=o("4360"),O=o("6605");const j={class:"container"},m=["onClick"],v={class:"card-top"},h={class:"remarks"},g={key:0,class:"remarks"},y={key:1},V={key:0},w={key:2,class:"h100"};var k={__name:"mobile",props:{draftCount:{type:Number,default:void 0}},emits:["total"],setup(e,{emit:t}){const o=e,k=Object(f["a"])(),C=Object(n["computed"])(()=>k.dictMap),N=Object(O["d"])(),_=Object(n["inject"])("$Message",()=>{}),x=Object(n["inject"])("$Modal",()=>{}),E=Object(n["inject"])("$Auth",()=>!1),P=Object(n["ref"])(),B=Object(n["ref"])(),S=Object(n["ref"])(!1);function A(){var e;S.value?P.value.getUsersList():null===(e=B.value)||void 0===e||e.reSearch()}Object(n["watch"])(()=>o.draftCount,()=>A());const D=Object(n["ref"])({}),F=Object(n["computed"])(()=>{const e=[];return E(2)&&D.value.wxid&&e.push({name:"重置密码",type:"resetPassword",color:"#f66161"}),E(2)&&e.push({name:"删除",type:"delete",color:"#f66161"}),E(2)&&"2"==D.value.status&&e.push({name:"审批",type:"audit",color:"#07c160"}),"2"!=D.value.status&&e.push({name:"特价",type:"special",color:"#07c160"},{name:"历史订单",type:"order",color:"#2d8cf0"},...D.value.longitude&&D.value.latitude?[{name:"定位",type:"location",color:"#07c160"}]:[]),E(2)&&e.push({name:"修改",type:"change"}),e}),I=Object(n["ref"])("2"),T=Object(n["ref"])(0),M=Object(n["ref"])("");function R(e){const t=C.value.user||[],o=["",...t.map(e=>e.id),"其他"];return Object(i["B"])({...e,name:M.value,status:I.value,label:o[T.value]})}function U({userId:e,name:t}){x.confirm({title:"删除客户",content:`是否确认删除${t}？`,loading:!0,onOk:async()=>{try{const{returnCode:t,data:o}=await Object(i["k"])({userIds:""+e})||{};0===t&&o&&(_.success("删除成功"),x.remove(),window.$EventBus.$emit("saveUser"),A())}catch(t){_.error("删除失败："+(t.message||t))}}})}function L(e){x.confirm({title:"重置密码",content:"是否确认重置该客户密码？",loading:!0,onOk:async()=>{try{const{returnCode:t,data:o}=await Object(i["H"])({userId:e.userId})||{};0===t&&o&&(x.remove(),setTimeout(()=>{x.success({title:"重置密码成功",content:`重置后的密码为：<h2 style="display: inline-block;">${o}</h2>`,loading:!1})},300))}catch(t){_.error("重置失败："+(t.message||t))}}})}const K=Object(n["ref"])(!1);function W(e){D.value={...e},K.value=!0}const X=Object(n["ref"])(!1),z=Object(n["ref"])(!1),Y=Object(n["ref"])(!1);function G(e,t=D.value){"change"===e?(D.value={...t},X.value=!0):"special"===e?N.push({name:"mobileSpecial",state:{params:{userId:t.userId,name:t.name}}}):"order"===e?N.push({name:"mobileOrder",state:{params:{userId:t.userId,name:t.name}}}):"delete"===e?U(t):"location"===e?z.value=!0:"audit"===e?Y.value=!0:"resetPassword"===e&&L(t)}return(o,i)=>{const f=Object(n["resolveComponent"])("Icon"),O=Object(n["resolveComponent"])("van-search"),k=Object(n["resolveComponent"])("van-action-sheet");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",null,[Object(n["createVNode"])(f,{type:S.value?"ios-list":"ios-pin-outline",size:"32",onClick:i[0]||(i[0]=e=>S.value=!S.value),class:"vi-header-icon left"},null,8,["type"]),Object(n["unref"])(E)(2)?(Object(n["openBlock"])(),Object(n["createBlock"])(f,{key:0,type:"ios-person-add-outline",size:"34",onClick:i[1]||(i[1]=e=>G("change",{})),class:"vi-header-icon right"})):Object(n["createCommentVNode"])("",!0),S.value?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",w,[Object(n["createVNode"])(Object(n["unref"])(p["a"]),{ref_key:"userMapRef",ref:P,onChangeUser:i[6]||(i[6]=e=>G("change",e)),onDeleteUser:i[7]||(i[7]=e=>G("delete",e)),onOpenHistoryOrder:i[8]||(i[8]=e=>G("order",e)),onOpenSpecialMng:i[9]||(i[9]=e=>G("special",e)),onClose:i[10]||(i[10]=e=>S.value=!1)},null,512)])):(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:1},[Object(n["createVNode"])(Object(n["unref"])(a["a"]),{active:I.value,"onUpdate:active":i[2]||(i[2]=e=>I.value=e),onChange:A},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(Object(n["unref"])(c["a"]),{title:"用户审批",name:"2",badge:e.draftCount||void 0},null,8,["badge"]),Object(n["createVNode"])(Object(n["unref"])(c["a"]),{title:"用户管理",name:"1,3"})]),_:1},8,["active"]),Object(n["createVNode"])(O,{modelValue:M.value,"onUpdate:modelValue":i[3]||(i[3]=e=>M.value=e),shape:"round",placeholder:"请输入客户名称搜索",onClear:A,onSearch:A,class:"search-input"},null,8,["modelValue"]),Object(n["createElementVNode"])("div",j,["2"!=I.value?(Object(n["openBlock"])(),Object(n["createBlock"])(Object(n["unref"])(r["a"]),{key:0,modelValue:T.value,"onUpdate:modelValue":i[4]||(i[4]=e=>T.value=e),onChange:A,class:"sidebar"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(Object(n["unref"])(l["a"]),{title:"全部",key:"all"}),(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(C.value.user,(e,t)=>(Object(n["openBlock"])(),Object(n["createBlock"])(Object(n["unref"])(l["a"]),{key:t,title:e.name},null,8,["title"]))),128)),Object(n["createVNode"])(Object(n["unref"])(l["a"]),{title:"其他",key:"other"})]),_:1},8,["modelValue"])):Object(n["createCommentVNode"])("",!0),Object(n["createVNode"])(Object(n["unref"])(s["i"]),{ref_key:"listRef",ref:B,getData:R,onOnUpdate:i[5]||(i[5]=e=>t("total",e.total)),class:"flex-1 h100"},{default:Object(n["withCtx"])(({item:e})=>[Object(n["createElementVNode"])("div",{class:"card",onClick:t=>W(e)},[Object(n["createElementVNode"])("p",v,Object(n["toDisplayString"])("2"==e.status?e.nickName:e.name),1),Object(n["createElementVNode"])("p",h,"联系电话："+Object(n["toDisplayString"])(e.phone||"无"),1),"2"==I.value?(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",g,"备注："+Object(n["toDisplayString"])(e.remarks||"无"),1)):Object(n["createCommentVNode"])("",!0),e.createUserName?(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",y,"创 建 人："+Object(n["toDisplayString"])(e.createUserName),1)):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("p",null,[Object(n["createTextVNode"])("最后修改："),e.updateUserName?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",V,Object(n["toDisplayString"])(e.updateUserName),1)):Object(n["createCommentVNode"])("",!0),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.updateTime),1)])],8,m)]),_:1},512)])],64)),Object(n["createVNode"])(Object(n["unref"])(u["a"]),{modelValue:X.value,"onUpdate:modelValue":i[11]||(i[11]=e=>X.value=e),detailData:D.value,onSave:A},null,8,["modelValue","detailData"]),Object(n["createVNode"])(Object(n["unref"])(d["a"]),{modelValue:z.value,"onUpdate:modelValue":i[12]||(i[12]=e=>z.value=e),curRow:D.value},null,8,["modelValue","curRow"]),Object(n["createVNode"])(Object(n["unref"])(b["a"]),{modelValue:Y.value,"onUpdate:modelValue":i[13]||(i[13]=e=>Y.value=e),detailData:D.value,onSave:A},null,8,["modelValue","detailData"]),Object(n["createVNode"])(k,{show:K.value,"onUpdate:show":i[14]||(i[14]=e=>K.value=e),title:D.value.name,actions:F.value,"cancel-text":"取消","close-on-click-action":"",onSelect:i[15]||(i[15]=e=>G(e.type))},null,8,["show","title","actions"])])}}},C=(o("de61"),o("6b0d")),N=o.n(C);const _=N()(k,[["__scopeId","data-v-5268ecc3"]]);t["default"]=_},2410:function(e,t,o){(function(t){var o=function(){"use strict";function e(e,t){return null!=t&&e instanceof t}var o,n,a;try{o=Map}catch(d){o=function(){}}try{n=Set}catch(d){n=function(){}}try{a=Promise}catch(d){a=function(){}}function c(r,l,i,s,d){"object"===typeof l&&(i=l.depth,s=l.prototype,d=l.includeNonEnumerable,l=l.circular);var p=[],b=[],f="undefined"!=typeof t;function O(r,i){if(null===r)return null;if(0===i)return r;var j,m;if("object"!=typeof r)return r;if(e(r,o))j=new o;else if(e(r,n))j=new n;else if(e(r,a))j=new a((function(e,t){r.then((function(t){e(O(t,i-1))}),(function(e){t(O(e,i-1))}))}));else if(c.__isArray(r))j=[];else if(c.__isRegExp(r))j=new RegExp(r.source,u(r)),r.lastIndex&&(j.lastIndex=r.lastIndex);else if(c.__isDate(r))j=new Date(r.getTime());else{if(f&&t.isBuffer(r))return j=t.allocUnsafe?t.allocUnsafe(r.length):new t(r.length),r.copy(j),j;e(r,Error)?j=Object.create(r):"undefined"==typeof s?(m=Object.getPrototypeOf(r),j=Object.create(m)):(j=Object.create(s),m=s)}if(l){var v=p.indexOf(r);if(-1!=v)return b[v];p.push(r),b.push(j)}for(var h in e(r,o)&&r.forEach((function(e,t){var o=O(t,i-1),n=O(e,i-1);j.set(o,n)})),e(r,n)&&r.forEach((function(e){var t=O(e,i-1);j.add(t)})),r){var g;m&&(g=Object.getOwnPropertyDescriptor(m,h)),g&&null==g.set||(j[h]=O(r[h],i-1))}if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(r);for(h=0;h<y.length;h++){var V=y[h],w=Object.getOwnPropertyDescriptor(r,V);(!w||w.enumerable||d)&&(j[V]=O(r[V],i-1),w.enumerable||Object.defineProperty(j,V,{enumerable:!1}))}}if(d){var k=Object.getOwnPropertyNames(r);for(h=0;h<k.length;h++){var C=k[h];w=Object.getOwnPropertyDescriptor(r,C);w&&w.enumerable||(j[C]=O(r[C],i-1),Object.defineProperty(j,C,{enumerable:!1}))}}return j}return"undefined"==typeof l&&(l=!0),"undefined"==typeof i&&(i=1/0),O(r,i)}function r(e){return Object.prototype.toString.call(e)}function l(e){return"object"===typeof e&&"[object Date]"===r(e)}function i(e){return"object"===typeof e&&"[object Array]"===r(e)}function s(e){return"object"===typeof e&&"[object RegExp]"===r(e)}function u(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return c.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},c.__objToStr=r,c.__isDate=l,c.__isArray=i,c.__isRegExp=s,c.__getRegExpFlags=u,c}();e.exports&&(e.exports=o)}).call(this,o("b639").Buffer)},"267e":function(e,t,o){"use strict";o.d(t,"a",(function(){return n})),o.d(t,"c",(function(){return a})),o.d(t,"b",(function(){return c}));const n={1:"草稿",2:"已打印",3:"已作废"},a={1:"未注册",2:"待审核",3:"已验证"},c={1:"超管",2:"店长",3:"店员",9:"客户",99:"游客"}},"31fd":function(e,t,o){"use strict";var n=o("7a23"),a=o("3e6b"),c=o("01d4"),r=o("4cdf"),l=o("f403"),i=o("5831"),s=o("a568"),u=o("92fa"),d=o("0af5"),p=o("1300"),b=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!==typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),f=function(e){function t(t){var o=e.call(this,{attributions:t.attributions,wrapX:t.wrapX})||this;return o.resolution=void 0,o.distance=void 0!==t.distance?t.distance:20,o.minDistance=t.minDistance||0,o.interpolationRatio=0,o.features=[],o.geometryFunction=t.geometryFunction||function(e){var t=e.getGeometry();return Object(u["a"])("Point"==t.getType(),10),t},o.createCustomCluster_=t.createCluster,o.source=null,o.boundRefresh_=o.refresh.bind(o),o.updateDistance(o.distance,o.minDistance),o.setSource(t.source||null),o}return b(t,e),t.prototype.clear=function(t){this.features.length=0,e.prototype.clear.call(this,t)},t.prototype.getDistance=function(){return this.distance},t.prototype.getSource=function(){return this.source},t.prototype.loadFeatures=function(e,t,o){this.source.loadFeatures(e,t,o),t!==this.resolution&&(this.resolution=t,this.refresh())},t.prototype.setDistance=function(e){this.updateDistance(e,this.minDistance)},t.prototype.setMinDistance=function(e){this.updateDistance(this.distance,e)},t.prototype.getMinDistance=function(){return this.minDistance},t.prototype.setSource=function(e){this.source&&this.source.removeEventListener(c["a"].CHANGE,this.boundRefresh_),this.source=e,e&&e.addEventListener(c["a"].CHANGE,this.boundRefresh_),this.refresh()},t.prototype.refresh=function(){this.clear(),this.cluster(),this.addFeatures(this.features)},t.prototype.updateDistance=function(e,t){var o=0===e?0:Math.min(t,e)/e,n=e!==this.distance||this.interpolationRatio!==o;this.distance=e,this.minDistance=t,this.interpolationRatio=o,n&&this.refresh()},t.prototype.cluster=function(){if(void 0!==this.resolution&&this.source)for(var e=Object(d["j"])(),t=this.distance*this.resolution,o=this.source.getFeatures(),n={},a=0,c=o.length;a<c;a++){var r=o[a];if(!(Object(p["c"])(r)in n)){var l=this.geometryFunction(r);if(l){var i=l.getCoordinates();Object(d["m"])(i,e),Object(d["c"])(e,t,e);var s=this.source.getFeaturesInExtent(e).filter((function(e){var t=Object(p["c"])(e);return!(t in n)&&(n[t]=!0,!0)}));this.features.push(this.createCluster(s,e))}}}},t.prototype.createCluster=function(e,t){for(var o=[0,0],n=e.length-1;n>=0;--n){var a=this.geometryFunction(e[n]);a?Object(s["a"])(o,a.getCoordinates()):e.splice(n,1)}Object(s["e"])(o,1/e.length);var c=Object(d["w"])(t),i=this.interpolationRatio,u=new l["a"]([o[0]*(1-i)+c[0]*i,o[1]*(1-i)+c[1]*i]);return this.createCustomCluster_?this.createCustomCluster_(u,e):new r["a"]({geometry:u,features:e})},t}(i["a"]),O=f,j=o("e269"),m=o("592d"),v=o("cd7e"),h=o("1e8d"),g=o("0999"),y=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!==typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),V={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"},w=function(e){function t(t){var o=e.call(this)||this;o.on,o.once,o.un,o.options=t,o.id=t.id,o.insertFirst=void 0===t.insertFirst||t.insertFirst,o.stopEvent=void 0===t.stopEvent||t.stopEvent,o.element=document.createElement("div"),o.element.className=void 0!==t.className?t.className:"ol-overlay-container "+v["d"],o.element.style.position="absolute",o.element.style.pointerEvents="auto";var n=t.autoPan;return n&&"object"!==typeof n&&(n={animation:t.autoPanAnimation,margin:t.autoPanMargin}),o.autoPan=n||!1,o.rendered={transform_:"",visible:!0},o.mapPostrenderListenerKey=null,o.addChangeListener(V.ELEMENT,o.handleElementChanged),o.addChangeListener(V.MAP,o.handleMapChanged),o.addChangeListener(V.OFFSET,o.handleOffsetChanged),o.addChangeListener(V.POSITION,o.handlePositionChanged),o.addChangeListener(V.POSITIONING,o.handlePositioningChanged),void 0!==t.element&&o.setElement(t.element),o.setOffset(void 0!==t.offset?t.offset:[0,0]),o.setPositioning(t.positioning||"top-left"),void 0!==t.position&&o.setPosition(t.position),o}return y(t,e),t.prototype.getElement=function(){return this.get(V.ELEMENT)},t.prototype.getId=function(){return this.id},t.prototype.getMap=function(){return this.get(V.MAP)||null},t.prototype.getOffset=function(){return this.get(V.OFFSET)},t.prototype.getPosition=function(){return this.get(V.POSITION)},t.prototype.getPositioning=function(){return this.get(V.POSITIONING)},t.prototype.handleElementChanged=function(){Object(g["e"])(this.element);var e=this.getElement();e&&this.element.appendChild(e)},t.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&(Object(g["f"])(this.element),Object(h["c"])(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var e=this.getMap();if(e){this.mapPostrenderListenerKey=Object(h["a"])(e,m["a"].POSTRENDER,this.render,this),this.updatePixelPosition();var t=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?t.insertBefore(this.element,t.childNodes[0]||null):t.appendChild(this.element),this.performAutoPan()}},t.prototype.render=function(){this.updatePixelPosition()},t.prototype.handleOffsetChanged=function(){this.updatePixelPosition()},t.prototype.handlePositionChanged=function(){this.updatePixelPosition(),this.performAutoPan()},t.prototype.handlePositioningChanged=function(){this.updatePixelPosition()},t.prototype.setElement=function(e){this.set(V.ELEMENT,e)},t.prototype.setMap=function(e){this.set(V.MAP,e)},t.prototype.setOffset=function(e){this.set(V.OFFSET,e)},t.prototype.setPosition=function(e){this.set(V.POSITION,e)},t.prototype.performAutoPan=function(){this.autoPan&&this.panIntoView(this.autoPan)},t.prototype.panIntoView=function(e){var t=this.getMap();if(t&&t.getTargetElement()&&this.get(V.POSITION)){var o=this.getRect(t.getTargetElement(),t.getSize()),n=this.getElement(),a=this.getRect(n,[Object(g["c"])(n),Object(g["b"])(n)]),c=e||{},r=void 0===c.margin?20:c.margin;if(!Object(d["g"])(o,a)){var l=a[0]-o[0],i=o[2]-a[2],s=a[1]-o[1],u=o[3]-a[3],p=[0,0];if(l<0?p[0]=l-r:i<0&&(p[0]=Math.abs(i)+r),s<0?p[1]=s-r:u<0&&(p[1]=Math.abs(u)+r),0!==p[0]||0!==p[1]){var b=t.getView().getCenterInternal(),f=t.getPixelFromCoordinateInternal(b);if(!f)return;var O=[f[0]+p[0],f[1]+p[1]],j=c.animation||{};t.getView().animateInternal({center:t.getCoordinateFromPixelInternal(O),duration:j.duration,easing:j.easing})}}}},t.prototype.getRect=function(e,t){var o=e.getBoundingClientRect(),n=o.left+window.pageXOffset,a=o.top+window.pageYOffset;return[n,a,n+t[0],a+t[1]]},t.prototype.setPositioning=function(e){this.set(V.POSITIONING,e)},t.prototype.setVisible=function(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)},t.prototype.updatePixelPosition=function(){var e=this.getMap(),t=this.getPosition();if(e&&e.isRendered()&&t){var o=e.getPixelFromCoordinate(t),n=e.getSize();this.updateRenderedPosition(o,n)}else this.setVisible(!1)},t.prototype.updateRenderedPosition=function(e,t){var o=this.element.style,n=this.getOffset(),a=this.getPositioning();this.setVisible(!0);var c=Math.round(e[0]+n[0])+"px",r=Math.round(e[1]+n[1])+"px",l="0%",i="0%";"bottom-right"==a||"center-right"==a||"top-right"==a?l="-100%":"bottom-center"!=a&&"center-center"!=a&&"top-center"!=a||(l="-50%"),"bottom-left"==a||"bottom-center"==a||"bottom-right"==a?i="-100%":"center-left"!=a&&"center-center"!=a&&"center-right"!=a||(i="-50%");var s="translate(".concat(l,", ").concat(i,") translate(").concat(c,", ").concat(r,")");this.rendered.transform_!=s&&(this.rendered.transform_=s,o.transform=s,o.msTransform=s)},t.prototype.getOptions=function(){return this.options},t}(j["a"]),k=w,C=o("6c77"),N=o("6cbf"),_=o("ce2c"),x=o("8682"),E=o("83a6"),P=o("8295"),B=o("d051"),S=o("e300"),A=o("e47c"),D=o.n(A),F=o("eeb9"),I=o("2af9"),T=o("ed08");const M=e=>(Object(n["pushScopeId"])("data-v-2528e2e5"),e=e(),Object(n["popScopeId"])(),e),R={class:"popup"},U={class:"popup-header"},L={class:"title"},K={class:"popup-content"},W={class:"mb-10"},X=M(()=>Object(n["createElementVNode"])("div",{class:"mt-10"},null,-1)),z=M(()=>Object(n["createElementVNode"])("div",{class:"mt-10"},null,-1)),Y={class:"popup"},G={class:"popup-header"},J=M(()=>Object(n["createElementVNode"])("span",{class:"title"},"聚合点位",-1)),Q={class:"popup-content"},H=["onClick"],q={class:"popup"},Z={class:"popup-content tc"};var $={__name:"allUsersMap",emits:["changeUser","deleteUser","openSpecialMng","openHistoryOrder","close"],setup(e,{expose:t,emit:o}){const c=Object(n["inject"])("$Message",()=>{}),s=Object(n["ref"])(window.isMobile),u=Object(n["ref"])([]);let d=null,p=null,b=null,f=null,j=null;const m=Object(n["ref"])({}),v=Object(n["ref"])([]),h=Object(n["ref"])(!1),g=Object(n["ref"])("");function y(e){const t=e.get("features").length;return 1==t?new C["b"]({image:new N["a"]({src:D.a,anchor:[.5,1]})}):new C["b"]({image:new _["a"]({radius:16,stroke:new x["a"]({color:"#fff",width:1}),fill:new E["a"]({color:"#6086FF"})}),text:new P["a"]({text:t.toString(),font:"12px sans-serif",fill:new E["a"]({color:"#FFFFFF"})}),zIndex:t})}function V(){if(!d)return;p&&(p.getSource().getSource().clear(),d.removeLayer(p),p=null);const e=u.value.filter(e=>e.longitude&&e.latitude).map(e=>new r["a"]({geometry:new l["a"]([e.longitude,e.latitude]),data:e})),t=new O({distance:20,source:new i["a"]({features:e})});p=new a["a"]({source:t,style:e=>y(e)}),d.addLayer(p)}async function w(){b&&b.setPosition(void 0),j&&j.setPosition(void 0);try{const{returnCode:e,data:t}=await Object(F["p"])()||{};0===e&&(u.value=t||[],V())}catch(e){c.error("获取客户列表失败："+(e.message||e))}}Object(n["watch"])(()=>g.value,e=>{const t=u.value.find(t=>t.userId===e);if(b.setPosition(void 0),t&&t.longitude&&t.latitude){m.value=t;const e=[t.longitude,t.latitude];d.getView().animate({center:e}),b.setPosition(e)}else t?(m.value=t,c.info("该用户未设置定位<br>点击地图进行定位")):m.value={longitude:m.value.longitude,latitude:m.value.latitude}});let A=null,M=null;function $(){p&&(p.getSource().getSource().clear(),d.removeLayer(p),p=null),b.setPosition(void 0);const e=new r["a"]({geometry:new l["a"]([m.value.longitude,m.value.latitude])}),t=new i["a"]({features:[e]});M=new a["a"]({source:t,style:new C["b"]({image:new N["a"]({src:D.a,anchor:[.5,1]})})}),d.addLayer(M);const o=new S["a"]([e]);A=new B["a"]({features:o}),d.addInteraction(A),A.on("translatestart",()=>{h.value=!0,j.setPosition(void 0)}),A.on("translateend",e=>{const t=e.features.array_[0].getGeometry().flatCoordinates;j.setPosition(t),m.value={...m.value,longitude:+t[0].toFixed(6),latitude:+t[1].toFixed(6)}})}function ee(){j.setPosition(void 0),M&&(d.removeLayer(M),M=null,d.removeInteraction(A),A=null),h.value&&(h.value=!1,V())}async function te(){try{const{data:e}=await Object(F["N"])(m.value)||{};e&&(c.success("校准成功"),ee(),w())}catch(e){c.error("校准失败："+(e.message||e))}}function oe(){const e=Object(T["g"])(m.value);if(!e)return c.error("未找到定位");window.open(e,"_self")}function ne(e){m.value={...e},f.setPosition(void 0),b.setPosition([e.longitude,e.latitude])}function ae(e){const t=d.forEachFeatureAtPixel(e.pixel,e=>e.get("features")),o=t&&t.length||0,n=b.getPosition()||f.getPosition()||j.getPosition();if(b.setPosition(void 0),f.setPosition(void 0),j.setPosition(void 0),o)1===o?(m.value=t[0].get("data"),b.setPosition(e.coordinate)):(v.value=t.map(e=>e.get("data")),f.setPosition(e.coordinate));else{if(n)return;m.value={...g.value?m.value:{},longitude:+e.coordinate[0].toFixed(6),latitude:+e.coordinate[1].toFixed(6)},j.setPosition(e.coordinate)}}const ce=Object(n["ref"])(),re=Object(n["ref"])(),le=Object(n["ref"])();function ie(e){d=e,b=new k({element:ce.value,positioning:"top-left",offset:[15,-20],autoPan:!0}),d.addOverlay(b),f=new k({element:re.value,positioning:"top-left",offset:[10,-20],autoPan:!0}),d.addOverlay(f),j=new k({element:le.value,positioning:"top-left",offset:[10,-20],autoPan:!0}),d.addOverlay(j),d.on("singleclick",ae),V()}return t({getUsersList:w}),Object(n["onMounted"])(()=>{w()}),Object(n["onBeforeUnmount"])(()=>{d.un("singleclick",ae)}),(e,t)=>{const a=Object(n["resolveComponent"])("Button"),c=Object(n["resolveComponent"])("Option"),r=Object(n["resolveComponent"])("viSelect");return Object(n["openBlock"])(),Object(n["createBlock"])(Object(n["unref"])(I["j"]),{onOnMount:ie,class:"h100"},{default:Object(n["withCtx"])(()=>[s.value?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createBlock"])(a,{key:0,type:"success",onClick:t[0]||(t[0]=e=>o("close")),class:"list-mode"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("列表模式")]),_:1})),Object(n["createVNode"])(r,{modelValue:g.value,"onUpdate:modelValue":t[1]||(t[1]=e=>g.value=e),filterable:"",class:"select-user"},{default:Object(n["withCtx"])(()=>[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(u.value,e=>(Object(n["openBlock"])(),Object(n["createBlock"])(c,{key:e.userId,value:e.userId},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),Object(n["createElementVNode"])("div",{ref_key:"userPopup",ref:ce},[Object(n["createElementVNode"])("div",R,[Object(n["createElementVNode"])("div",U,[Object(n["createElementVNode"])("span",L,Object(n["toDisplayString"])(m.value.name),1),Object(n["createElementVNode"])("span",{class:"close",onClick:t[2]||(t[2]=e=>Object(n["unref"])(b).setPosition(void 0))}," X ")]),Object(n["createElementVNode"])("div",K,[Object(n["createElementVNode"])("p",null,"电话："+Object(n["toDisplayString"])(m.value.phone||"-"),1),Object(n["createElementVNode"])("p",W,"备注："+Object(n["toDisplayString"])(m.value.remarks||"-"),1),Object(n["createVNode"])(a,{type:"primary",onClick:t[3]||(t[3]=e=>o("changeUser",m.value)),size:"small"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("修改")]),_:1}),Object(n["createVNode"])(a,{type:"error",onClick:t[4]||(t[4]=e=>o("deleteUser",m.value)),size:"small"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("删除")]),_:1}),X,Object(n["createVNode"])(a,{type:"success",onClick:t[5]||(t[5]=e=>o("openSpecialMng",m.value)),size:"small"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("特价")]),_:1}),Object(n["createVNode"])(a,{type:"primary",onClick:t[6]||(t[6]=e=>o("openHistoryOrder",m.value)),size:"small"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("历史订单")]),_:1}),z,Object(n["createVNode"])(a,{type:"primary",onClick:oe,size:"small"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("导航")]),_:1}),Object(n["createVNode"])(a,{onClick:$,size:"small"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("校准")]),_:1})])])],512),Object(n["createElementVNode"])("div",{ref_key:"clusterPopup",ref:re},[Object(n["createElementVNode"])("div",Y,[Object(n["createElementVNode"])("div",G,[J,Object(n["createElementVNode"])("span",{class:"close",onClick:t[7]||(t[7]=e=>Object(n["unref"])(f).setPosition(void 0))}," X ")]),Object(n["createElementVNode"])("div",Q,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(v.value,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",{key:t,onClick:t=>ne(e),class:"pointer"},Object(n["toDisplayString"])(t+1)+"、"+Object(n["toDisplayString"])(e.name),9,H))),128))])])],512),Object(n["createElementVNode"])("div",{ref_key:"emptyPopup",ref:le},[Object(n["createElementVNode"])("div",q,[Object(n["createElementVNode"])("div",Z,[h.value?(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:1},[Object(n["createVNode"])(a,{onClick:ee,size:"small"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("取消")]),_:1}),Object(n["createVNode"])(a,{type:"success",onClick:te,size:"small"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("确认")]),_:1})],64)):(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:0},[Object(n["createVNode"])(a,{type:"success",onClick:t[8]||(t[8]=e=>o("changeUser",m.value)),size:"small"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(g.value?"定位":"新增"),1)]),_:1}),Object(n["createVNode"])(a,{type:"primary",onClick:oe,size:"small"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("导航")]),_:1})],64)),Object(n["createElementVNode"])("span",{onClick:ee,class:"ml-10 pointer"}," X ")])])],512)]),_:1})}}},ee=(o("b8e7"),o("6b0d")),te=o.n(ee);const oe=te()($,[["__scopeId","data-v-2528e2e5"]]);t["a"]=oe},"592d":function(e,t,o){"use strict";t["a"]={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"}},"5de6":function(e,t,o){},8295:function(e,t,o){"use strict";var n=o("83a6"),a=o("29f6"),c=o("345d"),r="#333",l=function(){function e(e){var t=e||{};this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=Object(c["c"])(void 0!==t.scale?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.textBaseline_=t.textBaseline,this.fill_=void 0!==t.fill?t.fill:new n["a"]({color:r}),this.maxAngle_=void 0!==t.maxAngle?t.maxAngle:Math.PI/4,this.placement_=void 0!==t.placement?t.placement:a["a"].POINT,this.overflow_=!!t.overflow,this.stroke_=void 0!==t.stroke?t.stroke:null,this.offsetX_=void 0!==t.offsetX?t.offsetX:0,this.offsetY_=void 0!==t.offsetY?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=void 0===t.padding?null:t.padding}return e.prototype.clone=function(){var t=this.getScale();return new e({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})},e.prototype.getOverflow=function(){return this.overflow_},e.prototype.getFont=function(){return this.font_},e.prototype.getMaxAngle=function(){return this.maxAngle_},e.prototype.getPlacement=function(){return this.placement_},e.prototype.getOffsetX=function(){return this.offsetX_},e.prototype.getOffsetY=function(){return this.offsetY_},e.prototype.getFill=function(){return this.fill_},e.prototype.getRotateWithView=function(){return this.rotateWithView_},e.prototype.getRotation=function(){return this.rotation_},e.prototype.getScale=function(){return this.scale_},e.prototype.getScaleArray=function(){return this.scaleArray_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.getText=function(){return this.text_},e.prototype.getTextAlign=function(){return this.textAlign_},e.prototype.getJustify=function(){return this.justify_},e.prototype.getTextBaseline=function(){return this.textBaseline_},e.prototype.getBackgroundFill=function(){return this.backgroundFill_},e.prototype.getBackgroundStroke=function(){return this.backgroundStroke_},e.prototype.getPadding=function(){return this.padding_},e.prototype.setOverflow=function(e){this.overflow_=e},e.prototype.setFont=function(e){this.font_=e},e.prototype.setMaxAngle=function(e){this.maxAngle_=e},e.prototype.setOffsetX=function(e){this.offsetX_=e},e.prototype.setOffsetY=function(e){this.offsetY_=e},e.prototype.setPlacement=function(e){this.placement_=e},e.prototype.setRotateWithView=function(e){this.rotateWithView_=e},e.prototype.setFill=function(e){this.fill_=e},e.prototype.setRotation=function(e){this.rotation_=e},e.prototype.setScale=function(e){this.scale_=e,this.scaleArray_=Object(c["c"])(void 0!==e?e:1)},e.prototype.setStroke=function(e){this.stroke_=e},e.prototype.setText=function(e){this.text_=e},e.prototype.setTextAlign=function(e){this.textAlign_=e},e.prototype.setJustify=function(e){this.justify_=e},e.prototype.setTextBaseline=function(e){this.textBaseline_=e},e.prototype.setBackgroundFill=function(e){this.backgroundFill_=e},e.prototype.setBackgroundStroke=function(e){this.backgroundStroke_=e},e.prototype.setPadding=function(e){this.padding_=e},e}();t["a"]=l},"9a92":function(e,t,o){},a68d:function(e,t,o){"use strict";o.d(t,"a",(function(){return s})),o.d(t,"b",(function(){return d}));var n=o("7a23"),a=o("1fba"),c=o("e5f6"),r=o("450f");const[l,i]=Object(a["a"])("sidebar"),s=Symbol(l),u={modelValue:Object(c["c"])(0)};var d=Object(n["defineComponent"])({name:l,props:u,emits:["change","update:modelValue"],setup(e,{emit:t,slots:o}){const{linkChildren:a}=Object(r["useChildren"])(s),c=()=>+e.modelValue,l=e=>{e!==c()&&(t("update:modelValue",e),t("change",e))};return a({getActive:c,setActive:l}),()=>{var e;return Object(n["createVNode"])("div",{role:"tablist",class:i()},[null==(e=o.default)?void 0:e.call(o)])}}})},b116:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACyElEQVRYR82WP2gUQRTGv7eHvYLcxWi82SAkCDaSJhHRFMbGxEotVMTGUhS1MLebXLxNLIxoWisRA6KNXmz8AwmCSSFoI5KA5vaMhJuNYArb7JM1OZHNzs7uBYnbznvv++2bN98MYZM/Squ/fdjdn2HuAVEf+2ghwi5mfCMDC2AurxC9/F4Q75PWTQyQG6keg48LAPfqi9MEDNyT/fnnuthEAFmn8phAJ3TFwusMfuJZ5sm4PC1AznE5rXA4XlpCqRML0DTsjjLjykYBiHC7VhBXo+ooAVb3nCc2Kv4n36DeqJlQAzjVcrKBS4pIE9LK94WjIwGyI24n+ZhOUHqcmT8T0R4Ap3XxbKDL6xczf8dFAuRK1REQX4+dXubumm1O1WOaSpXDTDQZC8F0U9r5fj3AsDsNRqeqWIb99kW7dS683lyab1shY1YJQZiRBdGlBciW3IXA4aIK6c52nGcEjunZokULEHf2mXnIs82i6i+zpUqRiAZV62FPiB5Cx50loE1RZFxa4oxKIOe4D1UDycCcZ4l2fQdKlWfBZaMQWZaW2BYD8APA1sh15rK0zeN6AKd6B+BLKhEmKnqF/FB4Xdd+gO5KK39ZD5DEBYkWmf23YHwCYS+RcQDMzbHHMMIN/08nDP5i0++CAKLJcW8xEHmL6Ww3tM+jNUtci8pJ8B6ovgC4J41gKPa1tMQRVb4e4MbCPhgrr4JdaQBiyfdxdGlAfGgYIEjMOvNnCcaDtABEfL5WMO/H5Wk7UE9OPQ/MY9I2lV5Sr5sY4PfJcBLPw5S0RHeSjqUCWIVwa5p5WAYZB2Vh98d/ArDD+dLhI/NOadO+f84baE08L6k7sNqFykWAxtZDrPd6XRcaAliDeATQqboAg994lnlIJxhebxhgDeIrQMEL52eGt3Qs2jvXPdN0QBsCWBvKSWYe82zzqU6sIStupGianF/sHQ4wqSJAzQAAAABJRU5ErkJggg=="},b351:function(e,t,o){"use strict";o.d(t,"a",(function(){return j}));var n=o("23f9"),a=o("7a23"),c=o("1fba"),r=o("fa7c"),l=o("e5f6"),i=o("a68d"),s=o("450f"),u=o("4e5e"),d=o("8be7");const[p,b]=Object(c["a"])("sidebar-item"),f=Object(r["a"])({},u["b"],{dot:Boolean,title:String,badge:l["f"],disabled:Boolean,badgeProps:Object});var O=Object(a["defineComponent"])({name:p,props:f,emits:["click"],setup(e,{emit:t,slots:o}){const n=Object(u["c"])(),{parent:c,index:r}=Object(s["useParent"])(i["a"]);if(!c)return void 0;const l=()=>{e.disabled||(t("click",r.value),c.setActive(r.value),n())};return()=>{const{dot:t,badge:n,title:i,disabled:s}=e,u=r.value===c.getActive();return Object(a["createVNode"])("div",{role:"tab",class:b({select:u,disabled:s}),tabindex:s?void 0:0,"aria-selected":u,onClick:l},[Object(a["createVNode"])(d["a"],Object(a["mergeProps"])({dot:t,class:b("text"),content:n},e.badgeProps),{default:()=>[o.title?o.title():i]})])}}});const j=Object(n["a"])(O)},b8e7:function(e,t,o){"use strict";o("9a92")},c64b:function(e,t,o){"use strict";o("d9e2");var n=o("7a23"),a=o("b116"),c=o.n(a),r=o("eeb9"),l=o("2410"),i=o.n(l),s=o("b046"),u=o("267e"),d=o("4360");const p={class:"flex-ac"},b={key:0};var f={__name:"addUserModal",props:{modelValue:{type:Boolean,default:!1},detailData:{type:Object,default(){return{}}}},emits:["update:modelValue","save","close"],setup(e,{emit:t}){const o=e,a=Object(d["a"])(),l=Object(n["computed"])(()=>a.dictMap),f=Object(n["inject"])("$Message",()=>{}),O=Object(n["inject"])("$Auth",()=>!1),j=Object(n["computed"])({get(){return o.modelValue},set(e){t("update:modelValue",e),e||t("close")}}),m=Object(n["computed"])(()=>(o.detailData.userId?"编辑":"新增")+"客户"),v=Object(n["ref"])({}),h=Object(n["ref"])();async function g(e,t,n){if(t&&o.detailData.name!==v.value.name){const{data:e}=await Object(r["T"])({name:t})||{};if(e)return n(new Error("该客户名称已存在"))}n()}const y={name:[{required:!0,message:"请输入客户名称"},{validator:g,trigger:"blur"}]};Object(n["watch"])(()=>o.detailData,()=>{var e;null===(e=h.value)||void 0===e||e.resetFields(),v.value=i()(o.detailData)},{deep:!0});const V=Object(n["ref"])(!1);function w(){V.value=!0,h.value.validate(async e=>{if(!e)return f.error("数据校验不通过"),void(V.value=!1);try{const{_index:e,_rowKey:o,...n}=v.value,{data:a}=await Object(r["N"])(n)||{};a&&(f.success(m.value+"成功"),t("save",{...v.value}),h.value.resetFields(),j.value=!1)}catch(o){f.error("请求失败："+(o.message||o))}finally{V.value=!1}})}const k=Object(n["ref"])(!1);function C([e,t]){v.value={...v.value,longitude:e,latitude:t},k.value=!1}return(e,t)=>{const o=Object(n["resolveComponent"])("viInput"),a=Object(n["resolveComponent"])("FormItem"),r=Object(n["resolveComponent"])("Option"),i=Object(n["resolveComponent"])("viSelect"),d=Object(n["resolveComponent"])("Form"),f=Object(n["resolveComponent"])("Button"),g=Object(n["resolveComponent"])("viModal");return Object(n["openBlock"])(),Object(n["createBlock"])(g,{modelValue:j.value,"onUpdate:modelValue":t[7]||(t[7]=e=>j.value=e),title:m.value},{footer:Object(n["withCtx"])(()=>[Object(n["createVNode"])(f,{onClick:t[6]||(t[6]=e=>j.value=!1)},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("取消")]),_:1}),Object(n["createVNode"])(f,{type:"primary",onClick:w,loading:V.value},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("确定")]),_:1},8,["loading"])]),default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(d,{ref_key:"formRef",ref:h,model:v.value,rules:y,"label-width":90,onKeydown:Object(n["withKeys"])(w,["enter"]),class:"vi-modal-content"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(a,{label:"客户名称:",prop:"name"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(o,{modelValue:v.value.name,"onUpdate:modelValue":t[0]||(t[0]=e=>v.value.name=e)},null,8,["modelValue"])]),_:1}),Object(n["unref"])(O)(2)?(Object(n["openBlock"])(),Object(n["createBlock"])(a,{key:0,label:"用户权限:",prop:"power"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(i,{modelValue:v.value.power,"onUpdate:modelValue":t[1]||(t[1]=e=>v.value.power=e)},{default:Object(n["withCtx"])(()=>[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(Object(n["unref"])(u["b"]),(e,t)=>(Object(n["openBlock"])(),Object(n["createBlock"])(r,{key:t,value:t},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})):Object(n["createCommentVNode"])("",!0),Object(n["createVNode"])(a,{label:"标签:",prop:"label"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(i,{modelValue:v.value.label,"onUpdate:modelValue":t[2]||(t[2]=e=>v.value.label=e),multiple:""},{default:Object(n["withCtx"])(()=>[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(l.value.user,(e,t)=>(Object(n["openBlock"])(),Object(n["createBlock"])(r,{key:t,value:e.id},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(n["createVNode"])(a,{label:"联系电话:",prop:"phone"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(o,{modelValue:v.value.phone,"onUpdate:modelValue":t[3]||(t[3]=e=>v.value.phone=e)},null,8,["modelValue"])]),_:1}),Object(n["createVNode"])(a,{label:"定位:"},{default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",p,[Object(n["createElementVNode"])("img",{src:c.a,onClick:t[4]||(t[4]=e=>k.value=!0),class:"pointer mr-10"}),v.value.longitude&&v.value.latitude?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",b,Object(n["toDisplayString"])(v.value.longitude)+","+Object(n["toDisplayString"])(v.value.latitude),1)):Object(n["createCommentVNode"])("",!0)])]),_:1})]),_:1},8,["model","onKeydown"]),Object(n["createVNode"])(Object(n["unref"])(s["a"]),{modelValue:k.value,"onUpdate:modelValue":t[5]||(t[5]=e=>k.value=e),curRow:v.value,isEdit:"",onConfirm:C},null,8,["modelValue","curRow"])]),_:1},8,["modelValue","title"])}}};const O=f;t["a"]=O},de61:function(e,t,o){"use strict";o("5de6")},df7b:function(e,t,o){"use strict";o.d(t,"a",(function(){return c}));var n=o("23f9"),a=o("a68d");const c=Object(n["a"])(a["b"])},ff79:function(e,t,o){"use strict";o("d9e2");var n=o("7a23"),a=o("b116"),c=o.n(a),r=o("2410"),l=o.n(r),i=o("b046"),s=o("2af9"),u=o("267e"),d=o("eeb9"),p=o("4360");const b={class:"flex-ac"},f={key:0};var O={__name:"auditUserModal",props:{modelValue:{type:Boolean,default:!1},detailData:{type:Object,default(){return{}}}},emits:["update:modelValue","close","save"],setup(e,{emit:t}){const o=e,a=Object(p["a"])(),r=Object(n["computed"])(()=>a.dictMap),O=Object(n["inject"])("$Message",()=>{}),j=Object(n["computed"])({get(){return o.modelValue},set(e){t("update:modelValue",e),e||t("close")}}),m=Object(n["ref"])({}),v=Object(n["ref"])();async function h(e,t,n){if(t&&o.detailData.name!==m.value.name){const{data:e}=await Object(d["T"])({name:t})||{};if(e)return n(new Error("该客户名称已存在"))}n()}const g={name:[{required:!0,message:"请输入客户名称"},{validator:h,trigger:"blur"}]},y=Object(n["ref"])("1"),V=Object(n["ref"])("");Object(n["watch"])(()=>o.detailData,()=>{var e;null===(e=v.value)||void 0===e||e.resetFields(),y.value="1",V.value="",m.value=l()(o.detailData)},{deep:!0});const w=Object(n["ref"])(!1);function k(){w.value=!0,v.value.validate(async e=>{if(!e)return O.error("数据校验不通过"),void(w.value=!1);try{const{_index:e,_rowKey:o,...n}=m.value,{data:a}=await Object(d["b"])({...n,userVerify:y.value,updateUserId:V.value})||{};a&&(O.success("操作成功"),window.$EventBus.$emit("saveUser"),t("save",{...m.value}),j.value=!1,v.value.resetFields())}catch(o){O.error("请求失败："+(o.message||o))}finally{w.value=!1}})}function C(e,t){e&&(m.value={...m.value,name:t.name,longitude:t.longitude,latitude:t.latitude,power:t.power,label:t.label,phone:t.phone})}const N=Object(n["ref"])(!1);function _([e,t]){m.value={...m.value,longitude:e,latitude:t},N.value=!1}return(e,t)=>{const o=Object(n["resolveComponent"])("Radio"),a=Object(n["resolveComponent"])("RadioGroup"),l=Object(n["resolveComponent"])("FormItem"),p=Object(n["resolveComponent"])("viInput"),O=Object(n["resolveComponent"])("Option"),h=Object(n["resolveComponent"])("viSelect"),x=Object(n["resolveComponent"])("Form"),E=Object(n["resolveComponent"])("Button"),P=Object(n["resolveComponent"])("viModal");return Object(n["openBlock"])(),Object(n["createBlock"])(P,{modelValue:j.value,"onUpdate:modelValue":t[9]||(t[9]=e=>j.value=e),title:"用户审批"},{footer:Object(n["withCtx"])(()=>[Object(n["createVNode"])(E,{onClick:t[8]||(t[8]=e=>j.value=!1)},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("取消")]),_:1}),Object(n["createVNode"])(E,{type:"primary",onClick:k,loading:w.value},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("确定")]),_:1},8,["loading"])]),default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(x,{ref_key:"formRef",ref:v,model:m.value,rules:g,"label-width":90,onKeydown:Object(n["withKeys"])(k,["enter"]),class:"vi-modal-content"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(l,{label:"用户验证:"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(a,{modelValue:y.value,"onUpdate:modelValue":t[0]||(t[0]=e=>y.value=e)},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(o,{label:"1"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("新建用户")]),_:1}),Object(n["createVNode"])(o,{label:"2"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("选择已有用户")]),_:1})]),_:1},8,["modelValue"])]),_:1}),"1"===y.value?(Object(n["openBlock"])(),Object(n["createBlock"])(l,{key:0,label:"客户名称:",prop:"name"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(p,{modelValue:m.value.name,"onUpdate:modelValue":t[1]||(t[1]=e=>m.value.name=e)},null,8,["modelValue"])]),_:1})):(Object(n["openBlock"])(),Object(n["createBlock"])(l,{key:1,label:"选择客户:"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(Object(n["unref"])(s["d"]),{modelValue:V.value,"onUpdate:modelValue":t[2]||(t[2]=e=>V.value=e),getData:Object(n["unref"])(d["B"]),valueKey:"userId",filterable:"",params:{status:"1"},onOnChange:C},null,8,["modelValue","getData"])]),_:1})),Object(n["createVNode"])(l,{label:"用户权限:",prop:"power"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(h,{modelValue:m.value.power,"onUpdate:modelValue":t[3]||(t[3]=e=>m.value.power=e)},{default:Object(n["withCtx"])(()=>[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(Object(n["unref"])(u["b"]),(e,t)=>(Object(n["openBlock"])(),Object(n["createBlock"])(O,{key:t,value:t},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(n["createVNode"])(l,{label:"标签:",prop:"label"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(h,{modelValue:m.value.label,"onUpdate:modelValue":t[4]||(t[4]=e=>m.value.label=e),multiple:""},{default:Object(n["withCtx"])(()=>[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(r.value.user,(e,t)=>(Object(n["openBlock"])(),Object(n["createBlock"])(O,{key:t,value:e.id},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Object(n["createVNode"])(l,{label:"联系电话:",prop:"phone"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(p,{modelValue:m.value.phone,"onUpdate:modelValue":t[5]||(t[5]=e=>m.value.phone=e)},null,8,["modelValue"])]),_:1}),Object(n["createVNode"])(l,{label:"定位:"},{default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",b,[Object(n["createElementVNode"])("img",{src:c.a,onClick:t[6]||(t[6]=e=>N.value=!0),class:"pointer mr-10"}),m.value.longitude&&m.value.latitude?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",f,Object(n["toDisplayString"])(m.value.longitude)+","+Object(n["toDisplayString"])(m.value.latitude),1)):Object(n["createCommentVNode"])("",!0)])]),_:1})]),_:1},8,["model","onKeydown"]),Object(n["createVNode"])(Object(n["unref"])(i["a"]),{modelValue:N.value,"onUpdate:modelValue":t[7]||(t[7]=e=>N.value=e),curRow:m.value,isEdit:"",onConfirm:_},null,8,["modelValue","curRow"])]),_:1},8,["modelValue"])}}};const j=O;t["a"]=j}}]);